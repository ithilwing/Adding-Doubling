(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    142761,       3020]
NotebookOptionsPosition[    131498,       2838]
NotebookOutlinePosition[    131896,       2854]
CellTagsIndexPosition[    131853,       2851]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "NumericalDifferentialEquationAnalysis`"}]}], "Input",
 CellChangeTimes->{{3.7881646138386116`*^9, 3.788164622824499*^9}, {
  3.7881699458659935`*^9, 3.7881699749222755`*^9}, {3.7922254219387026`*^9, 
  3.7922254227057076`*^9}, {3.7923771204424467`*^9, 3.792377120862288*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"6f5f2aaf-849f-40b4-9801-882f21fbcc21"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Optical properties", "Subsection"]], "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7882492235523186`*^9, 3.788249230040389*^9}, 
   3.7882494315821295`*^9},ExpressionUUID->"92b0c50e-816d-486f-8598-\
a2281b8bfd94"],

Cell["Matrix size", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788249272833284*^9, 3.7882492804487057`*^9}, 
   3.788249431583129*^9},ExpressionUUID->"feb54112-28b2-4372-a4d7-\
567b2b73faca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", "128"}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7882492974266653`*^9, 3.7882493114299326`*^9}, 
   3.7882494315881195`*^9, {3.7882507672942066`*^9, 3.7882507677631674`*^9}, {
   3.7882509407364583`*^9, 3.788250940835305*^9}, {3.79161628446688*^9, 
   3.7916162867169547`*^9}, {3.791616388200457*^9, 3.7916163886692066`*^9}, {
   3.7916164978717804`*^9, 3.7916164981687217`*^9}, {3.791616637822033*^9, 
   3.791616638165818*^9}, {3.791778451047606*^9, 3.791778451614038*^9}, {
   3.791778521530567*^9, 3.7917785224763684`*^9}, 3.792217232294221*^9, 
   3.792218131763231*^9, {3.792218486410858*^9, 3.7922184866019974`*^9}, 
   3.792219503655507*^9, {3.792221840139164*^9, 3.792221852672881*^9}, {
   3.7922221921047773`*^9, 3.7922221922598877`*^9}, {3.7922238765457106`*^9, 
   3.7922238790809326`*^9}, 3.7922242117875347`*^9, {3.7922248556250424`*^9, 
   3.7922248556951027`*^9}, {3.792225237380481*^9, 3.7922252374225035`*^9}, {
   3.7922253636886444`*^9, 3.792225406569166*^9}, {3.792225647461534*^9, 
   3.7922256681235847`*^9}, {3.792225859916937*^9, 3.792225859966972*^9}, {
   3.792225978582167*^9, 3.792225984585209*^9}, {3.7922272796021996`*^9, 
   3.7922272796490736`*^9}, {3.7922273589370527`*^9, 3.792227359043871*^9}, {
   3.7922273943826723`*^9, 3.7922273944451733`*^9}, 3.792227428974539*^9, 
   3.7922274602286077`*^9, {3.79222766510894*^9, 3.7922276665962996`*^9}, {
   3.7922283241271434`*^9, 3.792228324240224*^9}, {3.7922284458576365`*^9, 
   3.7922284468916626`*^9}, {3.792229019666634*^9, 3.7922290197135105`*^9}, {
   3.792376398570703*^9, 3.792376399414261*^9}, {3.7923767793758593`*^9, 
   3.792376780606015*^9}, {3.792378720675173*^9, 3.792378721489737*^9}, {
   3.7923795235982127`*^9, 3.7923795256878366`*^9}, {3.7923810109408817`*^9, 
   3.7923810124616275`*^9}, {3.7923818580914097`*^9, 3.792381859652986*^9}, {
   3.7923819427735558`*^9, 3.7923819439042683`*^9}, {3.792385997472746*^9, 
   3.7923859986924877`*^9}, {3.7923881018146257`*^9, 3.792388102142754*^9}, {
   3.7925070742991123`*^9, 3.792507075611354*^9}, {3.7925152639267426`*^9, 
   3.792515264648087*^9}, {3.7925158585159616`*^9, 3.792515859534878*^9}, {
   3.792516569341157*^9, 3.7925165708429227`*^9}, {3.7925180838847976`*^9, 
   3.7925180851732597`*^9}, 3.792519320388919*^9, 3.792520015305013*^9, {
   3.7925200490877714`*^9, 3.792520051724842*^9}, {3.7925203772194166`*^9, 
   3.7925203791025257`*^9}, {3.7928093895262985`*^9, 3.7928093897763*^9}, {
   3.7928096531335473`*^9, 3.7928096599773903`*^9}, {3.79281290030449*^9, 
   3.7928129004763813`*^9}, {3.7928129998683825`*^9, 
   3.7928130000871353`*^9}, {3.792813078512721*^9, 3.7928130789346004`*^9}, {
   3.792813344475713*^9, 3.7928133445694747`*^9}, {3.7928139811440215`*^9, 
   3.7928139813940396`*^9}, {3.7928140637419825`*^9, 
   3.7928140638044844`*^9}, {3.7928154656570807`*^9, 3.792815486126114*^9}, {
   3.7928156221153746`*^9, 3.7928156246310215`*^9}, {3.792816049735512*^9, 
   3.7928160497823887`*^9}, {3.7928171895544186`*^9, 3.792817189835673*^9}, {
   3.7928272450947514`*^9, 3.7928272451885033`*^9}, {3.793344760714686*^9, 
   3.793344761854398*^9}, {3.7934318937445097`*^9, 3.793431895074724*^9}, {
   3.7934333989257812`*^9, 3.7934333993477736`*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"766192cc-a24a-4b14-950c-339d1788d7d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Absorption&scattering coefficients", "Subsubsection",
 CellChangeTimes->{{3.7934530336867*^9, 
  3.7934530458469877`*^9}},ExpressionUUID->"b703fb77-9cc4-495f-94d8-\
ced251e1e637"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Mu]s", "=", "9000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]a", "=", "1000"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7934530497898693`*^9, 3.793453085637705*^9}, {
   3.7935012980363035`*^9, 3.7935013014392767`*^9}, {3.793501359888174*^9, 
   3.7935013601694393`*^9}, {3.793501487059438*^9, 3.7935014905960407`*^9}, {
   3.793501618466874*^9, 3.7935016187482853`*^9}, {3.7935016766536956`*^9, 
   3.793501682947589*^9}, {3.7935017511367736`*^9, 3.7935017538945055`*^9}, 
   3.7935019586047335`*^9, {3.793502019542663*^9, 3.793502020339576*^9}, {
   3.7935021416480775`*^9, 3.7935021424763575`*^9}, {3.793502196242066*^9, 
   3.7935021976953626`*^9}, {3.79350229423442*^9, 3.7935022988966246`*^9}, {
   3.7935023442411723`*^9, 3.7935023482463875`*^9}, 3.793502394880751*^9, {
   3.7935024427694488`*^9, 3.793502443238367*^9}, {3.7935024871512265`*^9, 
   3.7935024874521103`*^9}, {3.793503064753111*^9, 3.793503065065809*^9}, {
   3.793503101921436*^9, 3.793503103003826*^9}, 3.7935031462570124`*^9, {
   3.793509596902172*^9, 3.793509597511711*^9}, {3.7935096806469927`*^9, 
   3.7935096821939464`*^9}, {3.7935098049353385`*^9, 
   3.7935098085030975`*^9}, {3.7935102413944044`*^9, 3.793510241642144*^9}, {
   3.7935103456584506`*^9, 3.793510346081425*^9}, {3.793510835794563*^9, 
   3.7935108360915833`*^9}, {3.7935109487780256`*^9, 
   3.7935109491031513`*^9}, {3.7935110072148485`*^9, 
   3.7935110075117607`*^9}, {3.7935421614418173`*^9, 3.793542163751627*^9}, {
   3.793542417180128*^9, 3.793542426280593*^9}, {3.7935448327357535`*^9, 
   3.7935448373534484`*^9}, {3.7935449271584034`*^9, 3.793544934890832*^9}, {
   3.7935449875055933`*^9, 3.793544987810906*^9}, {3.7935450320040627`*^9, 
   3.7935450323359346`*^9}, {3.793545080442893*^9, 3.7935450848199415`*^9}, {
   3.793545133288879*^9, 3.793545134204542*^9}, {3.8391289604713492`*^9, 
   3.839128968749812*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"cd30718f-4cb3-4623-89d6-500c212f7d10"],

Cell[CellGroupData[{

Cell["Albedo", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7882493158362083`*^9, 3.788249320887768*^9}, 
   3.788249431589119*^9, 3.7922195354679766`*^9, 
   3.792815490673053*^9},ExpressionUUID->"43238c5a-a463-482a-8b00-\
25b88dc62d3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "=", 
   FractionBox["\[Mu]s", 
    RowBox[{"\[Mu]s", "+", "\[Mu]a"}]]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7882493237764597`*^9, 3.788249326489238*^9}, 
   3.78824943159611*^9, {3.79126596003623*^9, 3.7912659603391027`*^9}, {
   3.791268549928115*^9, 3.791268550312147*^9}, {3.7912698296705055`*^9, 
   3.791269829939379*^9}, {3.791270944557312*^9, 3.7912709449573536`*^9}, {
   3.791388525354162*^9, 3.7913885259828215`*^9}, {3.79177761457381*^9, 
   3.7917776148037868`*^9}, {3.793256382758154*^9, 3.793256385289385*^9}, 
   3.7933409421493416`*^9, {3.7933435713198743`*^9, 3.7933435731478972`*^9}, {
   3.7934317058327703`*^9, 3.793431706319973*^9}, {3.7934340048028483`*^9, 
   3.793434007984474*^9}, {3.7934340931279345`*^9, 3.793434093284521*^9}, {
   3.7934345354564724`*^9, 3.793434536706482*^9}, {3.793442069497984*^9, 
   3.7934420698578587`*^9}, {3.793442119308386*^9, 3.7934421196362696`*^9}, {
   3.7934425417332225`*^9, 3.7934425427675066`*^9}, {3.7934429128562403`*^9, 
   3.793442921755415*^9}, 3.793451159438949*^9, {3.7934512215784683`*^9, 
   3.7934512226722603`*^9}, 3.7934517654233923`*^9, {3.7934530915131607`*^9, 
   3.7934531328922386`*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"18a9c909-f4b2-417b-90ba-e68a9585b420"],

Cell["Optical thickness", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7882493292392197`*^9, 3.7882493589429708`*^9}, 
   3.788249431597108*^9},ExpressionUUID->"5ab51fc1-f1bc-4ed2-9722-\
b1d959bc8847"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"0.1", "\[Times]", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]", "=", 
   RowBox[{"d", "\[Times]", 
    RowBox[{"(", 
     RowBox[{"\[Mu]s", "+", "\[Mu]a"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.793453138184415*^9, 3.7934532282738943`*^9}, {
  3.7934546813492403`*^9, 3.7934546832867336`*^9}, {3.793501408325042*^9, 
  3.7935014089500313`*^9}, {3.7935404788062544`*^9, 3.7935404802073307`*^9}, {
  3.7935421797615786`*^9, 3.7935421823820033`*^9}, {3.7935452153004446`*^9, 
  3.7935452178676667`*^9}, {3.7935452704284024`*^9, 3.7935452719517*^9}, {
  3.793545412413742*^9, 3.793545414890646*^9}, {3.793545510459527*^9, 
  3.7935455130816164`*^9}, {3.8391289743588915`*^9, 3.839128978847371*^9}, {
  3.8391290255430937`*^9, 3.839129027495765*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"b4471cdf-4442-4d8e-bb6d-aa865a4f3c4a"],

Cell[CellGroupData[{

Cell["Anisotropy", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788249371279792*^9, 3.788249376697728*^9}, 
   3.7882494316030984`*^9},ExpressionUUID->"76dfc411-73c8-4c53-91c3-\
9d685f7b9750"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "=", "0.9"}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788249379239214*^9, 3.788249384177027*^9}, 
   3.788249431609087*^9, {3.791263580478447*^9, 3.7912635813373423`*^9}, {
   3.7912657805109777`*^9, 3.7912657808911085`*^9}, {3.791265912069148*^9, 
   3.7912659144652195`*^9}, {3.791268502372403*^9, 3.791268502605404*^9}, {
   3.7912685847991076`*^9, 3.791268584899171*^9}, {3.7913885303420506`*^9, 
   3.7913885313861856`*^9}, {3.7932563491127872`*^9, 3.79325634940948*^9}, {
   3.793340948119585*^9, 3.7933409484478717`*^9}, {3.7933435761548367`*^9, 
   3.7933435765141954`*^9}, {3.7934420433898077`*^9, 3.793442045737564*^9}, {
   3.7934423695195007`*^9, 3.793442370038247*^9}, {3.793442890416551*^9, 
   3.793442891307171*^9}, 3.7935012340700383`*^9, 3.7935014936620636`*^9, {
   3.7935018107634044`*^9, 3.7935018122319317`*^9}, {3.7935018562174315`*^9, 
   3.7935018567334676`*^9}, {3.793501902785559*^9, 3.7935019031451316`*^9}, {
   3.793502103487547*^9, 3.7935021038312874`*^9}, {3.7935031874291954`*^9, 
   3.793503188230733*^9}, {3.793503297946826*^9, 3.7935032982124896`*^9}, 
   3.793509886385063*^9, {3.7935108828790913`*^9, 3.7935108831989136`*^9}, {
   3.7935421509124374`*^9, 3.7935421537610226`*^9}, {3.79354508846682*^9, 
   3.7935450887605457`*^9}, {3.793545128128809*^9, 3.793545128482259*^9}, {
   3.7935457715689774`*^9, 3.793545771926075*^9}, {3.7935458386374497`*^9, 
   3.7935458389641623`*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"da4a993b-c97d-43fc-858f-15fa3f3e9395"],

Cell["Refractive index", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788249387614379*^9, 3.788249399438468*^9}, 
   3.7882494316100883`*^9},ExpressionUUID->"6fd6839e-762e-4b32-8b6f-\
0ab55ea54ef3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "1.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nglass", "=", "1.5"}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.78824941739543*^9, 3.788249431616077*^9}, {
   3.791263157971749*^9, 3.791263158673581*^9}, {3.791263691639995*^9, 
   3.7912636927291136`*^9}, {3.791264418767206*^9, 3.7912644448252068`*^9}, {
   3.791266436734633*^9, 3.791266437072504*^9}, {3.7912665411163874`*^9, 
   3.7912665414962296`*^9}, {3.7912675326778107`*^9, 3.791267560884816*^9}, {
   3.791268524546917*^9, 3.7912685264571395`*^9}, {3.791270605536208*^9, 
   3.7912706059764833`*^9}, {3.7912707157300014`*^9, 3.79127071606889*^9}, {
   3.7912709828889313`*^9, 3.791270983268548*^9}, {3.7912711003362985`*^9, 
   3.7912711016530533`*^9}, {3.7913884081267023`*^9, 
   3.7913884103634295`*^9}, {3.791777619634225*^9, 3.79177761988404*^9}, {
   3.7922257503613124`*^9, 3.7922257539853415`*^9}, {3.7932563429015408`*^9, 
   3.793256343573412*^9}, {3.7933408287427187`*^9, 3.7933408417057133`*^9}, 
   3.7933430507783937`*^9, {3.793343579799853*^9, 3.7933435801748323`*^9}, {
   3.7934421709467754`*^9, 3.793442171672537*^9}, {3.793501580590579*^9, 
   3.7935015809604263`*^9}, {3.793503236861795*^9, 3.7935032375648937`*^9}, 
   3.793503383088523*^9, {3.793509940316769*^9, 3.793509941018875*^9}, 
   3.7935102904756536`*^9, 3.7935103342316885`*^9, {3.793542171955906*^9, 
   3.793542172779875*^9}, {3.7935422325238953`*^9, 3.7935422328915057`*^9}, 
   3.793544937974476*^9, {3.839129050944776*^9, 3.8391290545746536`*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"30f4d8c6-99f0-4047-8609-51bcc1c011ec"],

Cell["Integrating spheres properties", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.791784612919685*^9, 3.7917846463998384`*^9}, {
   3.79220601838492*^9, 3.792206028994266*^9}, 
   3.7923819286870813`*^9},ExpressionUUID->"d1305e0d-34f8-4039-ba5f-\
75caacbd4f6d"],

Cell["Sphere diameter", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.791784945540883*^9, 3.79178496382406*^9}, {
   3.79221266901689*^9, 3.792212674594825*^9}, 
   3.7923819286870813`*^9},ExpressionUUID->"1f97a13f-3eed-4679-afdc-\
d033ab37e989"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"7.", "\[Times]", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   FractionBox["d", "2"]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7917849701913743`*^9, 3.7917850074328775`*^9}, {
   3.792212682063333*^9, 3.7922127011884437`*^9}, {3.792213781465571*^9, 
   3.792213785825307*^9}, 3.792381928696779*^9, 3.7923864127503915`*^9},
 CellLabel->
  "In[271]:=",ExpressionUUID->"7551c83b-a9ce-410f-aea4-643407c4e68d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Quadrature angles", "Subsection"]], "Subsubsection",
 CellChangeTimes->{{3.7881644549031124`*^9, 
  3.7881644648824396`*^9}},ExpressionUUID->"82757b19-5e59-4724-be9d-\
98d2a09e4e9d"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Total internal reflection", "Subsubsection"]], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788164474115938*^9, 3.7881644831257877`*^9}, {
  3.7882488215383577`*^9, 
  3.788248830629718*^9}},ExpressionUUID->"64950369-9234-46d2-8d0b-\
d62f1f78462e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", " ", "[", "n_", "]"}], "=", " ", 
   RowBox[{"ArcSin", "[", 
    FractionBox["1.0", "n"], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7881644887050257`*^9, 3.788164576654011*^9}, {
   3.788164641362387*^9, 3.7881646473330097`*^9}, {3.78816486663192*^9, 
   3.788164868089631*^9}, 3.7881649959182477`*^9, {3.788165045225385*^9, 
   3.788165071280407*^9}, {3.7881651278216085`*^9, 3.7881651286143646`*^9}, {
   3.7881652713042994`*^9, 3.7881652738293343`*^9}, 3.788165423531876*^9, 
   3.7881655798395047`*^9, 3.788170014378603*^9, 3.788248830645343*^9, {
   3.7922172104263544`*^9, 3.7922172161270046`*^9}, 3.7922250865645423`*^9, 
   3.792226213168763*^9, 3.7922262532159815`*^9},
 CellLabel->
  "In[273]:=",ExpressionUUID->"1d296f1a-0450-40f4-9de6-27ccbb3cac14"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Critical cosine", "Subsubsection"]], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.788165507786314*^9, 3.788165512272663*^9}, 
   3.788248855832712*^9},ExpressionUUID->"b6814494-9775-49a1-924b-\
9aa62dd285b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Nu]c", "[", "n_", "]"}], "=", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]", "[", "n", "]"}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.7881655168469777`*^9, 3.788165553213174*^9}, {
   3.7881700233225718`*^9, 3.7881700311888175`*^9}, 3.7882488558483377`*^9, {
   3.7917780079782557`*^9, 3.7917780095766544`*^9}, 3.792225115018084*^9, {
   3.792226215434409*^9, 3.792226217090673*^9}, 3.7922262541847544`*^9},
 CellLabel->
  "In[274]:=",ExpressionUUID->"7b322555-8b51-40d4-b586-82be34ada4a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Gauss ", "Subsubsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", "<", "\[Theta]", "<", 
     SubscriptBox["\[Nu]", "c"]}]}], TraditionalForm]], "Subsubsection",
  ExpressionUUID->"8075bbdf-2936-4caa-be96-3a2b2f2078e4"], "Subsubsection"],
 StyleBox[")", "Subsubsection"]
}], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 CellChangeTimes->{{3.7881661305501103`*^9, 3.788166196956831*^9}, 
   3.788249036050741*^9, {3.792377788655436*^9, 
   3.7923777938073263`*^9}},ExpressionUUID->"5c40e921-514d-435d-bc33-\
eb347f22e195"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gauss", "=", 
   RowBox[{"GaussianQuadratureWeights", "[", 
    RowBox[{
     FractionBox["M", "2"], ",", "0", ",", 
     RowBox[{"\[Nu]c", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Nu]Gauss", "=", 
   RowBox[{"gauss", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wGauss", "=", 
   RowBox[{"gauss", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 CellChangeTimes->{{3.7923776401733937`*^9, 3.792377722542237*^9}, {
   3.7923778800033913`*^9, 3.7923778825999393`*^9}, {3.79237852761187*^9, 
   3.7923785301436124`*^9}, {3.792386322398625*^9, 3.792386336997478*^9}, 
   3.793454563204234*^9},
 CellLabel->
  "In[275]:=",ExpressionUUID->"7f1e9773-aae5-439a-85aa-8344109f4704"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Radau (", "Subsubsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "c"], "<", "\[Theta]", "<", "1"}], 
   TraditionalForm]], "Subsubsection",ExpressionUUID->
  "b0485f6d-7a8a-4f10-be7c-60fd8896ea81"], "Subsubsection"],
 StyleBox[")", "Subsubsection"]
}], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.7882347893125086`*^9, 3.788234839945238*^9}, 
   3.788249099278945*^9, 3.79221759625134*^9, {3.792377776994574*^9, 
   3.7923777807149544`*^9}},ExpressionUUID->"f0a480cc-3598-4550-aa07-\
d54e7c9f7933"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cachedLegendreP", "[", 
    RowBox[{"k_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"cachedLegendreP", "[", 
     RowBox[{"k", ",", "x"}], "]"}], "=", 
    RowBox[{"LegendreP", "[", 
     RowBox[{"k", ",", "x"}], "]"}]}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.7923838100376797`*^9, 3.792383928201789*^9}, {
   3.7923848725050774`*^9, 3.7923849015828223`*^9}, {3.792385500237054*^9, 
   3.792385502466875*^9}, {3.7923864513869996`*^9, 3.7923864936818824`*^9}, 
   3.793454577652831*^9},
 CellLabel->
  "In[278]:=",ExpressionUUID->"a9e61377-61b1-4eb4-bdea-ee8fa4e034e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Radau", "[", 
    RowBox[{"x_", ",", "m_"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"cachedLegendreP", "[", 
      RowBox[{
       RowBox[{
        FractionBox["m", "2"], "-", "1"}], ",", "x"}], "]"}], "+", 
     RowBox[{"cachedLegendreP", "[", 
      RowBox[{
       FractionBox["m", "2"], ",", "x"}], "]"}]}], 
    RowBox[{"1", "+", "x"}]]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{
  3.7923821879794292`*^9, {3.79238224622279*^9, 3.792382273023822*^9}, {
   3.7923842476993127`*^9, 3.7923842508890047`*^9}, {3.7923864776051755`*^9, 
   3.792386479355192*^9}, 3.793454577652831*^9},
 CellLabel->
  "In[279]:=",ExpressionUUID->"eee6f8b2-e5e6-4918-860a-b7692e95a7a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Der", "[", 
    RowBox[{"x_", ",", "m_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"cachedLegendreP", "[", 
      RowBox[{
       FractionBox["m", "2"], ",", "x"}], "]"}], ",", "x"}], "]"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{3.792386491016801*^9, 3.793454577668455*^9},
 CellLabel->
  "In[280]:=",ExpressionUUID->"bd86100b-4ecb-4909-b177-d84e6067fc95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RadauRoots", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"N", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "/.", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Radau", "[", 
              RowBox[{"x", ",", "M"}], "]"}], "\[Equal]", "0"}], ",", "x"}], 
           "]"}]}], ",", " ", 
         RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", "Greater"}], "]"}]}],
   ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.7922256083070583`*^9, 3.7922256302834888`*^9}, {
   3.792225700045373*^9, 3.792225701824628*^9}, {3.7922263982798834`*^9, 
   3.7922264001080246`*^9}, {3.7922277155112953`*^9, 3.792227717544365*^9}, {
   3.7923823621680145`*^9, 3.792382364992412*^9}, {3.7923825075818367`*^9, 
   3.792382515489661*^9}, {3.79238263442544*^9, 3.7923826376519313`*^9}, 
   3.792382821520829*^9, {3.792382916105735*^9, 3.792382934576746*^9}, {
   3.7923863091845837`*^9, 3.792386310600319*^9}, 3.793454577668455*^9},
 CellLabel->
  "In[281]:=",ExpressionUUID->"eb02bb72-e600-470b-a543-025ca6575fa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Nu]Radau", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "+", 
         RowBox[{"\[Nu]c", "[", "n", "]"}]}], "2"], "-", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Nu]c", "[", "n", "]"}]}], ")"}], "2"], "\[Times]", 
        RowBox[{"RadauRoots", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       FractionBox["M", "2"]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.7922184590958605`*^9, 3.7922184766467276`*^9}, {
   3.7922185310568633`*^9, 3.7922185501673527`*^9}, {3.792218598692461*^9, 
   3.7922186038200016`*^9}, 3.7922190406029315`*^9, {3.792219588356983*^9, 
   3.79221958900144*^9}, {3.792220511169597*^9, 3.792220512833784*^9}, {
   3.792221669749051*^9, 3.792221669880143*^9}, {3.7922217380071936`*^9, 
   3.7922217402437744`*^9}, 3.7922260350542583`*^9, 3.7922261194394007`*^9, 
   3.793454577668455*^9},
 CellLabel->
  "In[282]:=",ExpressionUUID->"97cab9e4-1480-47c9-87fa-ba90b2480f67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wRadau", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"\[Nu]c", "[", "n", "]"}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"RadauRoots", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Der", "[", 
             RowBox[{
              RowBox[{"RadauRoots", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"M", "-", "2"}]}], "]"}], ")"}], "2"]}]], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{
           FractionBox["M", "2"], "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox[
        RowBox[{"1", "-", 
         RowBox[{"\[Nu]c", "[", "n", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["M", "2"], ")"}], "2"]], "}"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.7922188220702376`*^9, 3.7922188781523447`*^9}, {
   3.7922189462699366`*^9, 3.792218978430025*^9}, 3.792219042339158*^9, {
   3.7922195100520253`*^9, 3.792219518118723*^9}, {3.792220517939391*^9, 
   3.7922205198487377`*^9}, {3.7922216654920425`*^9, 
   3.7922216656531672`*^9}, {3.7922260410962152`*^9, 
   3.7922260445332465`*^9}, {3.792227720387965*^9, 3.7922277438531284`*^9}, {
   3.792227826725137*^9, 3.792227828866419*^9}, 3.793454577668455*^9},
 CellLabel->
  "In[283]:=",ExpressionUUID->"86ad4d2b-da2a-48ef-8c62-d25d38cbb6fc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final quadrature angles and weights", "Subsubsection",
 CellChangeTimes->{{3.788249443551347*^9, 
  3.788249458769981*^9}},ExpressionUUID->"6d676648-0a5f-42a7-82a9-\
3beb486af15f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Nu]", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"\[Nu]Gauss", ",", "\[Nu]Radau"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"w", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"wGauss", ",", "wRadau"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "RadauRoots", ",", "GaussLRoots", ",", "\[Nu]Gauss", ",", "\[Nu]Radau", 
    ",", "wGauss", ",", "wRadau"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.792219094661482*^9, 3.792219180779313*^9}, 
   3.7922200357541904`*^9, {3.7922200990859346`*^9, 3.7922201059417768`*^9}, {
   3.792220201260572*^9, 3.7922202126936502`*^9}, 3.792226065298831*^9, {
   3.792226415201909*^9, 3.7922264161237936`*^9}, 3.792386519369314*^9},
 CellLabel->
  "In[284]:=",ExpressionUUID->"474c287c-a463-4b76-ae4a-0b8da2a0d0b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anglesRad", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"ArcCos", "[", 
      RowBox[{"\[Nu]", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "\[Nu]", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"anglesDeg", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"anglesRad", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "180"}], "\[Pi]"], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "\[Nu]", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7923865547108717`*^9, 3.7923866432033806`*^9}, {
  3.7923869089834595`*^9, 3.7923869091075478`*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"093003ba-e954-461d-8251-f0c278257308"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Redistribution Function", "Subsection",
 CellChangeTimes->{{3.78825029490956*^9, 
  3.7882503130744915`*^9}},ExpressionUUID->"2e1d05fe-9911-4357-ad33-\
4da1f4e74b48"],

Cell[CellGroupData[{

Cell["\[Delta]-M method", "Subsubsection",
 CellChangeTimes->{{3.7882503186097727`*^9, 
  3.788250327422044*^9}},ExpressionUUID->"4b739b34-9696-4586-8ae2-\
06cf3fbf688a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[Tau]", "*"], "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"a", " ", 
      SuperscriptBox["g", "M"]}]}], ")"}], "\[Tau]"}]}]], "Input",
 CellChangeTimes->{{3.788250330781434*^9, 3.7882503731192904`*^9}, {
  3.7922278551490617`*^9, 3.792227855285288*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"8555ab06-86b6-4260-bcf5-d8a5b02349ae"],

Cell[BoxData["0.9999987489239286`"], "Output",
 CellChangeTimes->{
  3.7882503791494403`*^9, 3.788250772444205*^9, 3.7882509620285645`*^9, 
   3.7882525294764895`*^9, 3.7882541723313055`*^9, 3.7882542191499786`*^9, 
   3.788254694324915*^9, 3.7882549937419405`*^9, 3.78825504702668*^9, 
   3.788255137345271*^9, 3.788256529880718*^9, 3.788256609240339*^9, 
   3.7882567841290364`*^9, 3.788257000947667*^9, 3.788423078617476*^9, 
   3.7884238694356394`*^9, 3.7884240055361457`*^9, 3.788424735367237*^9, 
   3.7884248081673717`*^9, 3.7884248760564694`*^9, 3.7884249580887985`*^9, 
   3.788425255270949*^9, 3.7884260269620085`*^9, 3.788428630402644*^9, 
   3.788496994059602*^9, 3.7884975115853624`*^9, 3.7884985350316315`*^9, 
   3.7885006496949835`*^9, 3.7885039676573114`*^9, 3.788504118987608*^9, 
   3.788583588466381*^9, 3.7885845018527336`*^9, 3.7885857714930186`*^9, {
   3.7885907715978336`*^9, 3.788590794574791*^9}, {3.790391323972103*^9, 
   3.790391352364153*^9}, 3.7904009944998646`*^9, 3.790401432439435*^9, 
   3.7904059835188046`*^9, 3.7904060342016087`*^9, 3.7904063843910236`*^9, 
   3.7904064178218822`*^9, 3.790421734532153*^9, 3.7907607174233165`*^9, 
   3.790767635797547*^9, 3.790768278832461*^9, 3.7907683409281216`*^9, 
   3.7907684293326855`*^9, 3.7907684843521843`*^9, 3.7908260243651743`*^9, 
   3.7908281313978863`*^9, 3.790828507502667*^9, 3.790830101251485*^9, 
   3.790830158612152*^9, 3.790830960362679*^9, 3.7908320741953793`*^9, 
   3.790907387734187*^9, 3.791175978331748*^9, 3.791179354721524*^9, 
   3.791182169093642*^9, 3.791182601698888*^9, 3.7911826960534935`*^9, 
   3.7912605730832477`*^9, 3.791262214020928*^9, 3.7912623241737957`*^9, 
   3.7912631253659525`*^9, 3.7912631689348526`*^9, 3.791263593073702*^9, 
   3.791263698596119*^9, {3.7912643986375337`*^9, 3.791264451350006*^9}, 
   3.791265728199251*^9, 3.791265787231167*^9, 3.791265920995237*^9, 
   3.791265981775564*^9, 3.791266441777186*^9, 3.7912665463362207`*^9, {
   3.7912675416635065`*^9, 3.7912675710188756`*^9}, 3.791268507930552*^9, {
   3.791268545827535*^9, 3.791268556477993*^9}, 3.7912685895992217`*^9, 
   3.791269804909511*^9, 3.791270172530943*^9, 3.7912703422272325`*^9, 
   3.79127061157014*^9, 3.7912709506075964`*^9, 3.791270988278916*^9, 
   3.791271021639817*^9, {3.791271110182932*^9, 3.7912711342378635`*^9}, 
   3.7913885598038063`*^9, 3.7916163042165804`*^9, 3.7916164003410206`*^9, 
   3.7916165067469053`*^9, 3.791616646478017*^9, 3.7916170244470882`*^9, 
   3.791777639274706*^9, 3.791778018188101*^9, 3.7917781027810593`*^9, 
   3.79177825568649*^9, 3.7917783961116543`*^9, 3.791778456827303*^9, 
   3.791778529536742*^9, 3.791779534162414*^9, 3.7921193212377996`*^9, 
   3.792218041210207*^9, 3.7922192324157796`*^9, 3.7922196030015726`*^9, 
   3.792219702542075*^9, 3.7922197955494757`*^9, 3.792220120573101*^9, 
   3.7922202300679207`*^9, 3.7922205362287817`*^9, 3.79222110565102*^9, 
   3.7922217996111183`*^9, {3.7922218423967576`*^9, 3.792221855403008*^9}, 
   3.7922238855800858`*^9, 3.7922239880135155`*^9, {3.7922242143304553`*^9, 
   3.792224225282263*^9}, 3.7922244220488367`*^9, {3.7922248349836392`*^9, 
   3.7922248577055273`*^9}, 3.792225030856046*^9, {3.7922250772112703`*^9, 
   3.7922251010020013`*^9}, 3.792225137283163*^9, {3.7922252156898956`*^9, 
   3.7922252399569845`*^9}, {3.792225375135147*^9, 3.7922253820516224`*^9}, {
   3.792225650466771*^9, 3.792225674059342*^9}, 3.7922257799560537`*^9, 
   3.792225862648857*^9, 3.7922260738107224`*^9, 3.7922271297989583`*^9, 
   3.7922272836764183`*^9, 3.79222736164263*^9, 3.792227396951355*^9, 
   3.7922274312421055`*^9, 3.7922274619697385`*^9, 3.7922276730513806`*^9, 
   3.79222827460038*^9, 3.7922283325046563`*^9, 3.7922284546051064`*^9, 
   3.7922291041318636`*^9, 3.7923756060082455`*^9, 3.79237599828362*^9, 
   3.792376787205883*^9, 3.792377496050861*^9, 3.79237779932614*^9, 
   3.792377889488513*^9, 3.7923784124703226`*^9, 3.792378644337451*^9, 
   3.7923787331717243`*^9, 3.792379530320959*^9, 3.792380233875225*^9, 
   3.7923810210061493`*^9, 3.792381864772064*^9, 3.79238299547351*^9, 
   3.7923839100171385`*^9, 3.7923842911191025`*^9, 3.7923849888030605`*^9, 
   3.7923855188047156`*^9, 3.7923860036623077`*^9, 3.7923861612899437`*^9, 
   3.7923866591774673`*^9, 3.7923875018867188`*^9, 3.792387622106988*^9, 
   3.7923876966771708`*^9, 3.79238791604663*^9, 3.7923880480703506`*^9, 
   3.7923881045420737`*^9, 3.7923881591167727`*^9, 3.7923882334203205`*^9, 
   3.7925071065342407`*^9, 3.7925072667361565`*^9, 3.7925076370774956`*^9, 
   3.7925084071039104`*^9, {3.7925142417776804`*^9, 3.792514277176751*^9}, 
   3.792515162053465*^9, 3.7925151984468155`*^9, {3.7925152503622828`*^9, 
   3.792515269157957*^9}, 3.792515768136671*^9, 3.7925158659131002`*^9, 
   3.7925166123453298`*^9, 3.7925168749832325`*^9, 3.7925177145969477`*^9, 
   3.792517900902483*^9, 3.7925179524107533`*^9, 3.792518090433034*^9, 
   3.7925193593478594`*^9, 3.7925194899095745`*^9, 3.7925195361219893`*^9, 
   3.792519684193241*^9, 3.792519724868634*^9, {3.792519908736347*^9, 
   3.792519929821946*^9}, {3.7925199637520733`*^9, 3.792520026362689*^9}, 
   3.7925200585313387`*^9, 3.7925203833842278`*^9, 3.7928094202610846`*^9, 
   3.7928096849152203`*^9, 3.7928098354037356`*^9, 3.792810836821681*^9, 
   3.792810911369589*^9, 3.792811415629105*^9, {3.7928116260120535`*^9, 
   3.792811650949897*^9}, 3.792812711577447*^9, {3.7928127487029347`*^9, 
   3.7928127688438387`*^9}, 3.792812915007818*^9, 3.7928130026652803`*^9, 
   3.792813056324898*^9, 3.792813127143285*^9, 3.7928137316859093`*^9, {
   3.79281377940532*^9, 3.792813802733768*^9}, 3.792814033425006*^9, 
   3.7928140774921746`*^9, {3.792814170087391*^9, 3.7928141810258045`*^9}, 
   3.792814270228027*^9, {3.79281430025968*^9, 3.792814329603835*^9}, {
   3.79281438716844*^9, 3.7928144167495813`*^9}, 3.7928151608882976`*^9, 
   3.7928152023576355`*^9, 3.7928155223297243`*^9, 3.792815634490532*^9, 
   3.792815699350805*^9, 3.792816052157406*^9, 3.792816133689784*^9, 
   3.7928172384208*^9, 3.7930748583798866`*^9, 3.7930748943513727`*^9, {
   3.7930773909898195`*^9, 3.7930774392030067`*^9}, 3.7932543043801575`*^9, 
   3.7932543906953726`*^9, 3.7932550275937505`*^9, 3.7932563913128986`*^9, 
   3.793341090098798*^9, 3.793341569176387*^9, 3.7933422068983574`*^9, 
   3.7933436030927277`*^9, 3.7933437536349573`*^9, 3.7933438821618395`*^9, {
   3.793344740963214*^9, 3.793344768191579*^9}, 3.793344959289838*^9, 
   3.7933450134511075`*^9, 3.7933450900857525`*^9, 3.7933452095316257`*^9, 
   3.7933452552184706`*^9, 3.793345308452095*^9, 3.793345374565086*^9, 
   3.7933454513376384`*^9, 3.7933455507295585`*^9, 3.793345630019022*^9, 
   3.7933457029634156`*^9, 3.793345752310598*^9, 3.7933459621867285`*^9, 
   3.7933460919608*^9, 3.7933462115355396`*^9, 3.7933462682471633`*^9, 
   3.7934152105701666`*^9, 3.79341651795743*^9, 3.7934177433395033`*^9, 
   3.7934197907662716`*^9, 3.793419886098344*^9, 3.7934200352854137`*^9, 
   3.79342015659308*^9, 3.7934208171219025`*^9, 3.793421359394133*^9, 
   3.793421665219017*^9, 3.7934217186150646`*^9, 3.7934217960689793`*^9, 
   3.7934225564133987`*^9, 3.793423433493634*^9, 3.793425211671796*^9, 
   3.7934309755206747`*^9, 3.7934315598972807`*^9, 3.793431710791137*^9, 
   3.7934318194272923`*^9, 3.793431901769517*^9, 3.793433416323041*^9, 
   3.7934340128134966`*^9, 3.7934340978944826`*^9, 3.793434541093625*^9, 
   3.7934346433186674`*^9, 3.7934394650845156`*^9, 3.7934396973268485`*^9, 
   3.7934418634662347`*^9, 3.7934420018088293`*^9, 3.793442074743823*^9, 
   3.793442124890566*^9, 3.7934421801964025`*^9, 3.793442374930875*^9, 
   3.79344254742717*^9, 3.793442747509883*^9, 3.7934429265942917`*^9, 
   3.79345469865438*^9, 3.79350117587787*^9, 3.793501238834435*^9, 
   3.7935013071564064`*^9, 3.7935013654228053`*^9, 3.793501412831109*^9, 
   3.793501498764267*^9, 3.793501585674418*^9, 3.7935016234401655`*^9, 
   3.793501687760067*^9, 3.793501759680818*^9, 3.7935018176454983`*^9, 
   3.793501861534606*^9, 3.7935019076209793`*^9, 3.793501964487174*^9, 
   3.7935020260691013`*^9, 3.7935022028817143`*^9, 3.7935023036259413`*^9, 
   3.7935023522348886`*^9, 3.793502399497514*^9, 3.7935024476520724`*^9, 
   3.7935024921960216`*^9, 3.793503069619511*^9, 3.7935031082446136`*^9, 
   3.7935031511550713`*^9, 3.793503193177466*^9, 3.7935032422985563`*^9, 
   3.793503303191497*^9, 3.7935033882796636`*^9, 3.793509514751213*^9, 
   3.7935096038010316`*^9, 3.793509687064992*^9, 3.793509817834488*^9, 
   3.793509892219372*^9, 3.793509945861396*^9, 3.793510043598775*^9, 
   3.7935102466937313`*^9, 3.7935102950106716`*^9, 3.793510351473382*^9, 
   3.7935106256660323`*^9, 3.7935107400582504`*^9, 3.7935108424871387`*^9, 
   3.7935108883055696`*^9, 3.793510953439787*^9, 3.793511012088687*^9, 
   3.7935406226171355`*^9, 3.793540686788519*^9, 3.7935407425399213`*^9, 
   3.793542186914795*^9, 3.793542237677322*^9, 3.7935424317181664`*^9, 
   3.7935448424009123`*^9, 3.7935449448170233`*^9, 3.793544992576063*^9, 
   3.7935450368314133`*^9, 3.7935450932905097`*^9, 3.7935451392884617`*^9, 
   3.793545222751976*^9, 3.7935452785613074`*^9, 3.793545421968712*^9, 
   3.7935455175984364`*^9, 3.7935457769570813`*^9, 3.7935458455380683`*^9, 
   3.8391292012583666`*^9},
 CellLabel->
  "Out[289]=",ExpressionUUID->"22d6b334-3ec3-4db6-a328-65281e4bcfdc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"as", "=", 
  RowBox[{"a", 
   FractionBox[
    RowBox[{"1", "-", 
     SuperscriptBox["g", "M"]}], 
    RowBox[{"1", "-", 
     RowBox[{"a", " ", 
      SuperscriptBox["g", "M"]}]}]]}]}]], "Input",
 CellChangeTimes->{{3.788250384599743*^9, 3.788250427166544*^9}, {
  3.7904058237096624`*^9, 3.7904058257064657`*^9}, {3.7922278387159133`*^9, 
  3.7922278387752914`*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"d33108f5-3568-4245-b8b1-acc76eb5de41"],

Cell[BoxData["0.8999998748922363`"], "Output",
 CellChangeTimes->{
  3.788250429364148*^9, 3.7882507725066667`*^9, 3.788250962087474*^9, 
   3.7882525295403895`*^9, 3.7882541723952045`*^9, 3.7882542192258577`*^9, 
   3.788254694386822*^9, 3.7882549937928658`*^9, 3.788255047116538*^9, 
   3.78825513743014*^9, 3.7882565299316416`*^9, 3.7882566092982492`*^9, 
   3.7882567841789594`*^9, 3.788257000994596*^9, 3.7884230787112217`*^9, 
   3.7884238694825134`*^9, 3.7884240055829597`*^9, 3.7884247354161606`*^9, 
   3.788424808217292*^9, 3.7884248761073904`*^9, 3.788424958137723*^9, 
   3.788425255323866*^9, 3.788426027013929*^9, 3.7884286304495153`*^9, 
   3.788496994122102*^9, 3.7884975116322393`*^9, 3.7884985350785017`*^9, 
   3.78850064973954*^9, 3.7885039677042637`*^9, 3.7885041190499315`*^9, 
   3.788583588513256*^9, 3.7885845018996053`*^9, 3.7885857715398917`*^9, {
   3.788590771729354*^9, 3.788590794637289*^9}, {3.790391323972103*^9, 
   3.790391352364153*^9}, 3.790400994515465*^9, 3.7904014324550347`*^9, 
   3.790405827048068*^9, 3.7904059835344048`*^9, 3.790406034217209*^9, 
   3.7904063843910236`*^9, 3.7904064178374825`*^9, 3.790421734532153*^9, 
   3.790760717485812*^9, 3.790767635857523*^9, 3.7907682788949614`*^9, 
   3.7907683409750075`*^9, 3.7907684293952312`*^9, 3.7907684843989797`*^9, 
   3.7908260244589224`*^9, 3.7908281315230646`*^9, 3.7908285075495386`*^9, 
   3.790830101298359*^9, 3.790830158674652*^9, 3.7908309604095526`*^9, 
   3.790832074242302*^9, 3.7909073877966843`*^9, 3.7911759784098697`*^9, 
   3.791179354768402*^9, 3.7911821691404557`*^9, 3.7911826017457666`*^9, 
   3.7911826961159964`*^9, 3.7912605731613703`*^9, 3.7912622140678043`*^9, 
   3.7912623242206693`*^9, 3.791263125422861*^9, 3.7912631690108247`*^9, 
   3.7912635932143226`*^9, 3.7912636986590204`*^9, {3.791264398688469*^9, 
   3.7912644514125023`*^9}, 3.79126572825941*^9, 3.79126578728086*^9, 
   3.7912659210497427`*^9, 3.791265982156582*^9, 3.7912664418963127`*^9, 
   3.7912665463866463`*^9, {3.7912675417144628`*^9, 3.791267571067897*^9}, 
   3.7912685079762497`*^9, {3.791268545887493*^9, 3.791268556537724*^9}, 
   3.791268589648961*^9, 3.7912698049693613`*^9, 3.791270172581687*^9, 
   3.791270342277321*^9, 3.7912706116355114`*^9, 3.791270950661381*^9, 
   3.7912709883428745`*^9, 3.7912710217198067`*^9, {3.791271110316366*^9, 
   3.791271134293446*^9}, 3.7913885598819323`*^9, 3.79161630451357*^9, 
   3.7916164004660196`*^9, 3.7916165068560996`*^9, 3.7916166466030183`*^9, 
   3.791617024556463*^9, 3.791777639333659*^9, 3.7917780182379785`*^9, 
   3.791778102834797*^9, 3.791778255736619*^9, 3.7917783961617055`*^9, 
   3.791778456893733*^9, 3.791778529599606*^9, 3.7917795342224355`*^9, 
   3.7921193213159227`*^9, 3.792218041261243*^9, 3.7922192332453623`*^9, 
   3.79221960408635*^9, 3.792219703491745*^9, 3.7922197970935593`*^9, 
   3.7922202313768435`*^9, {3.7922205343794765`*^9, 3.7922205373785934`*^9}, 
   3.792221105665039*^9, 3.792221799689171*^9, {3.792221842409767*^9, 
   3.7922218554140167`*^9}, 3.792223885591093*^9, 3.7922239880184355`*^9, {
   3.792224214341463*^9, 3.792224225294271*^9}, 3.7922244230019703`*^9, {
   3.792224834994647*^9, 3.7922248577165346`*^9}, 3.792224984158558*^9, 
   3.7922250308690557`*^9, {3.792225077222278*^9, 3.792225101026843*^9}, 
   3.7922251372931695`*^9, {3.7922252157055216`*^9, 3.7922252399726095`*^9}, {
   3.7922253751901903`*^9, 3.7922253820672455`*^9}, {3.7922256504807806`*^9, 
   3.7922256740903625`*^9}, 3.792225781253928*^9, 3.7922258626598663`*^9, 
   3.792226074971289*^9, 3.7922271298145833`*^9, 3.792227283723294*^9, 
   3.79222736164263*^9, 3.792227396982605*^9, 3.7922274312421055`*^9, 
   3.7922274619697385`*^9, 3.792227673087427*^9, 3.7922282746094723`*^9, 
   3.792228332520279*^9, 3.7922284546051064`*^9, 3.792229105322956*^9, 
   3.792375606093116*^9, 3.7923759983477335`*^9, 3.7923767872367287`*^9, 
   3.7923774961008244`*^9, 3.79237779937706*^9, 3.7923778895414333`*^9, 
   3.792378412549198*^9, 3.792378644395754*^9, 3.79237873322466*^9, 
   3.7923795303709235`*^9, 3.792380233925147*^9, 3.7923810210521955`*^9, 
   3.7923818648239822`*^9, 3.7923829955578995`*^9, 3.7923839100720625`*^9, 
   3.7923842911730175`*^9, 3.792384988860972*^9, 3.792385518855638*^9, 
   3.7923860037212133`*^9, 3.792386161346852*^9, 3.7923866605749383`*^9, 
   3.7923875019023438`*^9, 3.7923876221199956`*^9, 3.7923876966881742`*^9, 
   3.792387916062252*^9, 3.7923880480859737`*^9, 3.7923881045576973`*^9, 
   3.792388159163649*^9, 3.7923882334203205`*^9, 3.792507106581113*^9, 
   3.792507266767404*^9, 3.792507637155616*^9, 3.792508407150782*^9, {
   3.7925142418245497`*^9, 3.7925142772236233`*^9}, 3.792515162100334*^9, 
   3.792515198478065*^9, {3.7925152504091544`*^9, 3.79251526920477*^9}, 
   3.7925157683241587`*^9, 3.792515865959968*^9, 3.7925166123922014`*^9, 
   3.792516875030105*^9, 3.792517714640932*^9, 3.792517900954464*^9, 
   3.7925179524576244`*^9, 3.7925180904770107`*^9, 3.7925193595353494`*^9, 
   3.7925194899586625`*^9, 3.7925195362469797`*^9, 3.792519684208864*^9, 
   3.7925197249155083`*^9, {3.7925199088457174`*^9, 3.792519929868819*^9}, {
   3.7925199637989473`*^9, 3.7925200264161167`*^9}, 3.792520058578206*^9, 
   3.792520383415474*^9, 3.7928094202610846`*^9, 3.7928096849308586`*^9, 
   3.7928098354037356`*^9, 3.792810836821681*^9, 3.792810911369589*^9, 
   3.792811415629105*^9, {3.792811626027677*^9, 3.792811650949897*^9}, 
   3.792812711593046*^9, {3.7928127487029347`*^9, 3.7928127688438387`*^9}, 
   3.7928129150234556`*^9, 3.7928130026809053`*^9, 3.792813056324898*^9, 
   3.792813127158921*^9, 3.7928137316859093`*^9, {3.79281377940532*^9, 
   3.792813802733768*^9}, 3.792814033425006*^9, 3.7928140774921746`*^9, {
   3.792814170103001*^9, 3.7928141810258045`*^9}, 3.792814270243638*^9, {
   3.79281430025968*^9, 3.792814329603835*^9}, {3.79281438716844*^9, 
   3.7928144167495813`*^9}, 3.7928151608882976`*^9, 3.7928152023732605`*^9, 
   3.792815523345377*^9, 3.792815634521782*^9, 3.792815699350805*^9, 
   3.792816052157406*^9, 3.792816133689784*^9, 3.7928172394676886`*^9, 
   3.7930748584517746`*^9, 3.793074894507619*^9, {3.793077391057793*^9, 
   3.7930774392709866`*^9}, 3.7932543044582815`*^9, 3.793254390898491*^9, 
   3.793255027640624*^9, 3.7932563913753977`*^9, 3.793341090161296*^9, 
   3.793341569237797*^9, 3.793342206960853*^9, 3.7933436031865234`*^9, 
   3.7933437537130766`*^9, 3.7933438822399073`*^9, {3.793344741056961*^9, 
   3.793344768284409*^9}, 3.793344959383583*^9, 3.7933450135514827`*^9, 
   3.793345090179495*^9, 3.793345209640995*^9, 3.793345255312219*^9, 
   3.7933453085457973`*^9, 3.7933453746432066`*^9, 3.793345451453456*^9, 
   3.7933455508233004`*^9, 3.7933456300884633`*^9, 3.7933457030942063`*^9, 
   3.793345752388672*^9, 3.793345962280468*^9, 3.7933460920565*^9, 
   3.7933462116358123`*^9, 3.7933462683253326`*^9, 3.7934152106261463`*^9, 
   3.7934165180254107`*^9, 3.7934177434071465`*^9, 3.793419790828822*^9, 
   3.793419886160845*^9, 3.7934200353635387`*^9, 3.7934201566868334`*^9, 
   3.793420817215653*^9, 3.7934213595817223`*^9, 3.7934216652971406`*^9, 
   3.7934217186933002`*^9, 3.793421796443918*^9, 3.793422556504258*^9, 
   3.7934234335561323`*^9, 3.7934252117376947`*^9, 3.79343097556755*^9, 
   3.793431559944158*^9, 3.793431710853685*^9, 3.793431819489795*^9, 
   3.7934319018320155`*^9, 3.793433416385544*^9, 3.7934340129228687`*^9, 
   3.7934340979473996`*^9, 3.79343454112488*^9, 3.793434643399542*^9, 
   3.7934394651313868`*^9, 3.793439697373723*^9, 3.793441863518218*^9, 
   3.79344200186481*^9, 3.793442074795806*^9, 3.793442124946546*^9, 
   3.7934421802523837`*^9, 3.7934423749868546`*^9, 3.7934425474740458`*^9, 
   3.793442747556757*^9, 3.7934429266411667`*^9, 3.793454698701255*^9, 
   3.7935011759362907`*^9, 3.7935012388656845`*^9, 3.7935013072213025`*^9, 
   3.793501365469756*^9, 3.793501412862346*^9, 3.793501498856542*^9, 
   3.7935015857056704`*^9, 3.7935016234870396`*^9, 3.7935016877978287`*^9, 
   3.7935017597119403`*^9, 3.793501817676834*^9, 3.7935018615658517`*^9, 
   3.7935019076522293`*^9, 3.793501964534046*^9, 3.7935020261315985`*^9, 
   3.793502202928588*^9, 3.7935023036572523`*^9, 3.7935023522818127`*^9, 
   3.7935023995287633`*^9, 3.793502447699049*^9, 3.793502492242893*^9, 
   3.793503069650756*^9, 3.7935031082914667`*^9, 3.7935031512018957`*^9, 
   3.793503193208719*^9, 3.793503242345477*^9, 3.79350330323837*^9, 
   3.793503388326539*^9, 3.793509514836994*^9, 3.793509603863533*^9, 
   3.7935096871118646`*^9, 3.7935098178968563`*^9, 3.7935098922818685`*^9, 
   3.7935099459149475`*^9, 3.793510043652286*^9, 3.7935102467564077`*^9, 
   3.7935102950575438`*^9, 3.793510351520255*^9, 3.7935106257285957`*^9, 
   3.7935107401051826`*^9, 3.7935108425495872`*^9, 3.793510888352537*^9, 
   3.793510953486657*^9, 3.7935110121355553`*^9, 3.793540622669114*^9, 
   3.7935406868285007`*^9, 3.7935407425799065`*^9, 3.7935421869547796`*^9, 
   3.7935422377213025`*^9, 3.79354243175815*^9, 3.7935448424477863`*^9, 
   3.7935449448570013`*^9, 3.793544992622933*^9, 3.79354503687829*^9, 
   3.7935450933305006`*^9, 3.7935451393262463`*^9, 3.7935452228028884`*^9, 
   3.79354527859256*^9, 3.793545422048679*^9, 3.7935455176452575`*^9, 
   3.793545777001066*^9, 3.793545845584986*^9, 3.8391292015283365`*^9},
 CellLabel->
  "Out[290]=",ExpressionUUID->"4d8f9fcc-97f1-46ce-bce0-133c40986dbd"]
}, Open  ]],

Cell[TextData[{
 "Optical thickness of starting layer: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[CapitalDelta]\[Tau]", "*"], "<", 
    SubscriptBox["\[Nu]", "1"]}], TraditionalForm]],ExpressionUUID->
  "b196ad2b-4471-4147-93a3-110649dad5a0"],
 " (min \[Nu])"
}], "Text",
 CellChangeTimes->{{3.7882505625593376`*^9, 3.788250607555338*^9}, {
  3.7882515678138914`*^9, 
  3.788251571410334*^9}},ExpressionUUID->"4eafe6d7-3b50-46e7-b9c5-\
86abcc5ea60f"],

Cell[TextData[{
 "We want ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[CapitalDelta]\[Tau]", "*"], "\[Times]", 
     SuperscriptBox["2", "n1"]}], "=", 
    SuperscriptBox["\[Tau]", "*"]}], TraditionalForm]],ExpressionUUID->
  "f2ee0ef4-3d20-475b-a491-dd25d9775687"]
}], "Text",
 CellChangeTimes->{{3.78825062829633*^9, 3.7882506532492957`*^9}, {
  3.788252318222726*^9, 3.788252319413885*^9}, {3.7882524889770546`*^9, 
  3.7882524895701385`*^9}},ExpressionUUID->"1d8b826c-ecd2-4a8f-ae32-\
c973e3349dd2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"NSolve", "::", "ifun"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"n1", "=", 
  RowBox[{"Ceiling", "[", 
   RowBox[{"x", "/.", 
    RowBox[{
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Tau]", "*"], "\[Equal]", 
        RowBox[{
         RowBox[{"Min", "[", "\[Nu]", "]"}], " ", 
         SuperscriptBox["2", "x"]}]}], ",", "x", ",", "Reals"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.792220244185278*^9, 3.792220336119082*^9}, 
   3.792225739127387*^9, {3.7922257870016475`*^9, 3.7922257941094966`*^9}, {
   3.792225830673808*^9, 3.792225839752345*^9}, {3.7922278447979174`*^9, 
   3.7922278448888087`*^9}, {3.7922290889443464`*^9, 3.7922291359385624`*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"a3c24bba-99ce-4dc2-82ac-ca30a8ed27b8"],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{{3.7922257873480463`*^9, 3.7922257944927673`*^9}, {
   3.7922258475854664`*^9, 3.792225862720908*^9}, 3.7922271299239597`*^9, 
   3.7922272838482947`*^9, 3.79222736173638*^9, 3.792227397123232*^9, 
   3.7922274313046064`*^9, 3.792227462058174*^9, 3.792227673185476*^9, 
   3.7922282746719747`*^9, 3.792228332801422*^9, 3.7922284546832323`*^9, {
   3.792229108027012*^9, 3.792229136655831*^9}, 3.792375606597335*^9, 
   3.792375998542844*^9, 3.7923767873657722`*^9, 3.7923774961606293`*^9, 
   3.792377799770453*^9, 3.7923778897591014`*^9, 3.7923784126330695`*^9, 
   3.7923786444474516`*^9, 3.7923787333957806`*^9, 3.7923795304311085`*^9, 
   3.792380233984057*^9, 3.7923810211019344`*^9, 3.792381864881894*^9, 
   3.792382995653174*^9, 3.792383910133957*^9, 3.792384291235936*^9, 
   3.7923849889298625`*^9, 3.792385518910552*^9, 3.792386003785116*^9, 
   3.7923861614027653`*^9, 3.7923866627868624`*^9, 3.7923875019179697`*^9, 
   3.7923876221340065`*^9, 3.79238769673921*^9, 3.7923879160778785`*^9, 
   3.7923880481015987`*^9, 3.7923881045889473`*^9, 3.7923881592105236`*^9, 
   3.7923882334671955`*^9, 3.792507106737356*^9, 3.7925072669392705`*^9, 
   3.7925076373431053`*^9, 3.792508407338272*^9, {3.7925142419807916`*^9, 
   3.792514277270491*^9}, 3.792515162162831*^9, 3.7925151985405617`*^9, {
   3.792515250456031*^9, 3.7925152692516465`*^9}, 3.7925157683710313`*^9, 
   3.7925158660380893`*^9, 3.792516612532817*^9, 3.7925168750769777`*^9, 
   3.7925177146889133`*^9, 3.792517901006443*^9, 3.7925179525044994`*^9, 
   3.7925180905369864`*^9, 3.7925193595822287`*^9, 3.792519490083658*^9, 
   3.7925195362938538`*^9, 3.792519684365105*^9, 3.7925197249780035`*^9, {
   3.792519908894552*^9, 3.792519929978188*^9}, {3.7925199639239388`*^9, 
   3.7925200264784327`*^9}, 3.792520058640703*^9, 3.7925203835717163`*^9, 
   3.7928094203235865`*^9, 3.792809684946472*^9, 3.792809835419361*^9, 
   3.792810836837306*^9, 3.792810911385212*^9, 3.7928114156447287`*^9, {
   3.7928116260433035`*^9, 3.792811650965523*^9}, 3.792812711608671*^9, {
   3.7928127487185593`*^9, 3.792812768859463*^9}, 3.7928129150547047`*^9, 
   3.7928130026809053`*^9, 3.792813056340532*^9, 3.792813127190161*^9, 
   3.79281373171716*^9, {3.792813779420952*^9, 3.792813802749392*^9}, 
   3.7928140334718833`*^9, 3.792814077539049*^9, {3.792814170149885*^9, 
   3.79281418104143*^9}, 3.792814270274889*^9, {3.792814300275303*^9, 
   3.792814329619459*^9}, {3.792814387184064*^9, 3.7928144167964573`*^9}, 
   3.792815160903922*^9, 3.792815202388871*^9, 3.792815525173526*^9, 
   3.792815634553034*^9, 3.7928156993664293`*^9, 3.792816052188657*^9, 
   3.792816133705411*^9, 3.7928172412958283`*^9, 3.7930748586414795`*^9, 
   3.793074894570116*^9, {3.7930773911337695`*^9, 3.7930774393469563`*^9}, 
   3.7932543046301584`*^9, 3.793254391039117*^9, 3.7932550277176943`*^9, 
   3.7932563914429493`*^9, 3.7933410902237916`*^9, 3.7933415693002896`*^9, 
   3.7933422070389752`*^9, 3.7933436032802176`*^9, 3.793343753806822*^9, 
   3.7933438823336554`*^9, {3.7933447411507044`*^9, 3.7933447683839464`*^9}, 
   3.793344959461703*^9, 3.793345013682953*^9, 3.79334509025762*^9, 
   3.793345209743409*^9, 3.7933452554059615`*^9, 3.7933453086238685`*^9, 
   3.7933453747390714`*^9, 3.793345451612269*^9, 3.793345550917046*^9, 
   3.7933456301822553`*^9, 3.7933457032057204`*^9, 3.793345752482422*^9, 
   3.7933459623585854`*^9, 3.7933460921631126`*^9, 3.7933462117378407`*^9, 
   3.793346268419028*^9, 3.7934152108100824`*^9, 3.793416518093384*^9, 
   3.793417743469735*^9, 3.7934197909069915`*^9, 3.793419886238968*^9, 
   3.7934200354416637`*^9, 3.7934201568274527`*^9, 3.793420817293826*^9, 
   3.793421359675332*^9, 3.793421665390891*^9, 3.793421718786974*^9, 
   3.7934217973659644`*^9, 3.7934225565971155`*^9, 3.7934234336030073`*^9, 
   3.793425211802592*^9, 3.7934309757394266`*^9, 3.7934315600066547`*^9, 
   3.7934317109161882`*^9, 3.793431819552294*^9, 3.793431901894513*^9, 
   3.793433416541889*^9, 3.7934340130947437`*^9, 3.7934340980132523`*^9, 
   3.793434541187379*^9, 3.79343464346229*^9, 3.7934394651782613`*^9, 
   3.793439697436222*^9, 3.793441863582195*^9, 3.7934420019407845`*^9, 
   3.7934420748557825`*^9, 3.7934421250105257`*^9, 3.793442180316363*^9, 
   3.793442375050832*^9, 3.793442547537738*^9, 3.793442747619254*^9, 
   3.7934429267036653`*^9, 3.793454698841878*^9, 3.7935011761047444`*^9, 
   3.7935012389281836`*^9, 3.7935013073720655`*^9, 3.793501365532178*^9, 
   3.7935014129248457`*^9, 3.7935014989230223`*^9, 3.793501585759198*^9, 
   3.7935016235339146`*^9, 3.793501687844717*^9, 3.79350175977444*^9, 
   3.7935018177393456`*^9, 3.7935018616283526`*^9, 3.793501907699105*^9, 
   3.793501964690296*^9, 3.7935020262917814`*^9, 3.793502202975462*^9, 
   3.7935023037196426`*^9, 3.793502352328641*^9, 3.793502399591359*^9, 
   3.79350244774582*^9, 3.7935024923053913`*^9, 3.7935030697288823`*^9, 
   3.7935031083382874`*^9, 3.7935031512644444`*^9, 3.7935031932712126`*^9, 
   3.7935032423989553`*^9, 3.7935033032852464`*^9, 3.793503388373464*^9, 
   3.793509514899495*^9, 3.7935096039104056`*^9, 3.793509687174362*^9, 
   3.7935098179593487`*^9, 3.7935098923287416`*^9, 3.7935099459682736`*^9, 
   3.7935100436991415`*^9, 3.7935102468095903`*^9, 3.7935102951200914`*^9, 
   3.793510351582758*^9, 3.793510625775504*^9, 3.793510740174304*^9, 
   3.793510842602998*^9, 3.793510888414939*^9, 3.793510953548989*^9, 
   3.7935110121981897`*^9, 3.7935406228410473`*^9, 3.793540686872487*^9, 
   3.7935407426238904`*^9, 3.793542187018752*^9, 3.7935422377812805`*^9, 
   3.7935424318061275`*^9, 3.7935448425102854`*^9, 3.7935449449169855`*^9, 
   3.793544992690591*^9, 3.793545036931688*^9, 3.79354509337848*^9, 
   3.7935451393914323`*^9, 3.7935452228653865`*^9, 3.793545278655053*^9, 
   3.7935454221286535`*^9, 3.7935455176922646`*^9, 3.7935457770610437`*^9, 
   3.7935458456317835`*^9, 3.8391292018182993`*^9},
 CellLabel->
  "Out[292]=",ExpressionUUID->"58faf78b-ed0d-497a-9bf8-0809cd0cfad5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalDelta]\[Tau]s", "=", 
  FractionBox[
   SuperscriptBox["\[Tau]", "*"], 
   SuperscriptBox["2", "n1"]]}]], "Input",
 CellChangeTimes->{{3.7882523724440937`*^9, 3.788252398710984*^9}, {
  3.788252506160512*^9, 3.788252506594837*^9}, {3.790405511606992*^9, 
  3.7904055217782097`*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"a9972f3f-970f-4833-94e8-461ef8a5ab72"],

Cell[BoxData["0.000244140319561506`"], "Output",
 CellChangeTimes->{
  3.7882524012734704`*^9, 3.7882525296791754`*^9, 3.7882541725449734`*^9, 
   3.7882542194135685`*^9, 3.7882546944976516`*^9, 3.788254993884719*^9, 
   3.7882550471934195`*^9, 3.7882551375120134`*^9, 3.7882565300205035`*^9, 
   3.7882566094420304`*^9, 3.788256784261834*^9, 3.7882570011483574`*^9, 
   3.788423078898718*^9, 3.7884238695607405`*^9, 3.7884240056767025`*^9, 
   3.7884247355439596`*^9, 3.788424808302163*^9, 3.7884248761942525`*^9, 
   3.788424958223586*^9, 3.7884252554077344`*^9, 3.7884260271367364`*^9, 
   3.7884286305276394`*^9, 3.788496994231476*^9, 3.7884975117572365`*^9, 
   3.7884985351722574`*^9, 3.788500649837802*^9, 3.7885039677888985`*^9, 
   3.7885041191593*^9, 3.7885835886070004`*^9, 3.7885845019777265`*^9, 
   3.7885857716336403`*^9, {3.7885907718140087`*^9, 3.788590794731035*^9}, {
   3.790391323987703*^9, 3.790391352379753*^9}, 3.790400994515465*^9, 
   3.7904014324706345`*^9, 3.790405524071414*^9, 3.7904059835344048`*^9, 
   3.790406034232809*^9, 3.790406384406624*^9, 3.7904064178530827`*^9, 
   3.790421734547753*^9, 3.790760717595186*^9, 3.7907676359534893`*^9, 
   3.790768279051203*^9, 3.7907683410596566`*^9, 3.7907684294889326`*^9, 
   3.7907684845084486`*^9, 3.790826024568297*^9, 3.7908281316322565`*^9, 
   3.7908285077371683`*^9, 3.790830101407736*^9, 3.790830158846527*^9, 
   3.790830960518927*^9, 3.790832074429753*^9, 3.7909073879060555`*^9, 
   3.7911759785973687`*^9, 3.7911793549558992`*^9, 3.7911821693123264`*^9, 
   3.791182601861943*^9, 3.7911826962253695`*^9, 3.7912605734113636`*^9, 
   3.7912622141772532`*^9, 3.791262324330038*^9, 3.791263125546665*^9, 
   3.791263169258741*^9, 3.791263593323694*^9, 3.79126369878311*^9, {
   3.791264398861513*^9, 3.7912644515687513`*^9}, 3.791265728448492*^9, 
   3.7912657873950768`*^9, 3.791265921155573*^9, 3.7912659825727787`*^9, 
   3.7912664420165615`*^9, 3.7912665465064907`*^9, {3.791267543244547*^9, 
   3.79126757117537*^9}, 3.7912685080861597`*^9, {3.791268546087347*^9, 
   3.7912685566381383`*^9}, 3.7912685897588234`*^9, 3.7912698051393833`*^9, 
   3.7912701726957035`*^9, 3.7912703424786196`*^9, 3.7912706117861013`*^9, 
   3.791270950831744*^9, 3.791270988518673*^9, 3.791271021914067*^9, {
   3.791271110583254*^9, 3.791271134407588*^9}, 3.791388560071256*^9, 
   3.7916163047633867`*^9, 3.7916164009503913`*^9, 3.7916165070906544`*^9, 
   3.791616646853015*^9, 3.7916170247908373`*^9, 3.791777639533549*^9, 
   3.7917780183681393`*^9, 3.791778103005106*^9, 3.7917782559206247`*^9, 
   3.791778396261515*^9, 3.791778457013955*^9, 3.7917785297062907`*^9, 
   3.7917795343267126`*^9, 3.7921193214877954`*^9, 3.7922180426862493`*^9, 
   3.792219236552697*^9, 3.792219607658995*^9, 3.792219706233808*^9, 
   3.7922198002227693`*^9, 3.7922202354006877`*^9, 3.7922206288806763`*^9, 
   3.7922211057060585`*^9, 3.7922217997522154`*^9, {3.7922218424728127`*^9, 
   3.792221855456046*^9}, 3.792223885661143*^9, 3.7922239880496874`*^9, {
   3.7922242144015055`*^9, 3.7922242253583164`*^9}, 3.7922244352426643`*^9, {
   3.792224835017952*^9, 3.792224857762567*^9}, 3.79222499261889*^9, 
   3.792225030925095*^9, {3.7922250772783213`*^9, 3.792225101080882*^9}, 
   3.7922251373191876`*^9, {3.7922252157367725`*^9, 3.7922252399882345`*^9}, 
   3.7922253820828695`*^9, {3.792225650504798*^9, 3.7922256741524067`*^9}, 
   3.7922258627319155`*^9, 3.7922271299239597`*^9, 3.7922272838951716`*^9, 
   3.792227361780889*^9, 3.792227397170107*^9, 3.7922274313202305`*^9, 
   3.7922274620691814`*^9, 3.7922276732205005`*^9, 3.792228274687599*^9, 
   3.792228332801422*^9, 3.792228454698858*^9, {3.792229114856492*^9, 
   3.792229142322934*^9}, 3.7923756071275125`*^9, 3.7923759986264973`*^9, 
   3.792376787395779*^9, 3.7923774962193265`*^9, 3.7923777998203716`*^9, 
   3.7923778898120127`*^9, 3.7923784127249255`*^9, 3.792378644497652*^9, 
   3.792378733451553*^9, 3.7923795304813576`*^9, 3.7923802340339785`*^9, 
   3.792381021362018*^9, 3.792381864936807*^9, 3.792382995736045*^9, 
   3.7923839101898694`*^9, 3.7923842912918477`*^9, 3.7923849889867754`*^9, 
   3.7923855189654646`*^9, 3.7923860038430233`*^9, 3.7923861614586787`*^9, 
   3.792386666652335*^9, 3.7923875019179697`*^9, 3.792387622147015*^9, 
   3.792387696751219*^9, 3.7923879160778785`*^9, 3.7923880481015987`*^9, 
   3.7923881046045723`*^9, 3.7923881592574005`*^9, 3.792388233498446*^9, 
   3.7925071067842274`*^9, 3.792507266970519*^9, 3.792507637756382*^9, 
   3.7925084074007697`*^9, {3.792514242027667*^9, 3.792514277332944*^9}, 
   3.7925151622097063`*^9, 3.792515198587434*^9, {3.7925152505029044`*^9, 
   3.7925152693141437`*^9}, 3.7925157684179063`*^9, 3.7925158660849614`*^9, 
   3.792516612564067*^9, 3.79251687512385*^9, 3.792517714732896*^9, 
   3.792517901058423*^9, 3.7925179525669947`*^9, 3.7925180905809755`*^9, 
   3.792519359629095*^9, 3.79251949013053*^9, 3.7925195363407245`*^9, 
   3.792519684396354*^9, 3.792519725024877*^9, {3.792519908941425*^9, 
   3.7925199300250607`*^9}, {3.7925199639717913`*^9, 3.792520026525303*^9}, 
   3.7925200586875787`*^9, 3.7925203835873404`*^9, 3.7928094203235865`*^9, 
   3.792809684962096*^9, 3.792809835419361*^9, 3.7928108368529406`*^9, 
   3.792810911400837*^9, 3.7928114156603565`*^9, {3.7928116260589314`*^9, 
   3.792811650981148*^9}, 3.792812711624296*^9, {3.792812748734186*^9, 
   3.792812768875098*^9}, 3.7928129150703306`*^9, 3.792813002696531*^9, 
   3.7928130563561573`*^9, 3.7928131272057858`*^9, 3.79281373171716*^9, {
   3.792813779420952*^9, 3.7928138027650185`*^9}, 3.7928140334718833`*^9, 
   3.792814077539049*^9, {3.792814170149885*^9, 3.7928141810570555`*^9}, 
   3.792814270290514*^9, {3.79281430029093*^9, 3.792814329635088*^9}, {
   3.792814387199689*^9, 3.7928144167964573`*^9}, 3.792815160903922*^9, 
   3.792815202388871*^9, 3.7928155264547825`*^9, 3.7928156345686584`*^9, 
   3.792815699382056*^9, 3.7928160522042894`*^9, 3.792816133705411*^9, 
   3.7928172428427362`*^9, 3.793074858934016*^9, 3.793074894648239*^9, {
   3.79307739120574*^9, 3.793077439422927*^9}, 3.793254304927029*^9, 
   3.7932543911016197`*^9, 3.793255027764569*^9, 3.7932563915054493`*^9, 
   3.793341090286291*^9, 3.79334156937841*^9, 3.793342207195217*^9, 
   3.7933436033739624`*^9, 3.793343753900566*^9, 3.793343882411773*^9, {
   3.7933447412288246`*^9, 3.793344768593986*^9}, 3.7933449595554476`*^9, 
   3.793345013783227*^9, 3.793345090351364*^9, 3.7933452098382597`*^9, 
   3.7933452555182004`*^9, 3.793345308717614*^9, 3.793345374817191*^9, 
   3.7933454517229557`*^9, 3.793345551010791*^9, 3.7933456302759523`*^9, 
   3.7933457033027644`*^9, 3.793345752560649*^9, 3.793345962452337*^9, 
   3.7933460922649508`*^9, 3.793346211820716*^9, 3.7933462684971514`*^9, 
   3.79341521087006*^9, 3.793416518157361*^9, 3.7934177435321493`*^9, 
   3.7934197909694734`*^9, 3.793419886301469*^9, 3.7934200356135406`*^9, 
   3.7934201569212027`*^9, 3.7934208173719487`*^9, 3.793421359753456*^9, 
   3.793421665469013*^9, 3.793421718865041*^9, 3.7934217977254314`*^9, 
   3.793422556689973*^9, 3.793423433665507*^9, 3.793425211861504*^9, 
   3.7934309758487973`*^9, 3.793431560069158*^9, 3.7934317109786415`*^9, 
   3.7934318195991673`*^9, 3.7934319019570136`*^9, 3.793433416651166*^9, 
   3.793434013134449*^9, 3.7934340980617857`*^9, 3.7934345412468905`*^9, 
   3.7934346435159063`*^9, 3.793439465240759*^9, 3.793439697483097*^9, 
   3.7934418636461744`*^9, 3.7934420019927673`*^9, 3.793442074915765*^9, 
   3.7934421250625086`*^9, 3.7934421804163275`*^9, 3.7934423751028147`*^9, 
   3.7934425475990443`*^9, 3.79344274769738*^9, 3.7934429267505407`*^9, 
   3.7934546989043827`*^9, 3.793501176313998*^9, 3.7935012390025053`*^9, 
   3.7935013074140005`*^9, 3.793501365579052*^9, 3.793501412956044*^9, 
   3.7935014989542723`*^9, 3.7935015857904654`*^9, 3.7935016235651636`*^9, 
   3.793501687907215*^9, 3.793501759805687*^9, 3.79350181777054*^9, 
   3.7935018616595516`*^9, 3.7935019077303514`*^9, 3.793501964737166*^9, 
   3.793502026346692*^9, 3.79350220300671*^9, 3.7935023037665157`*^9, 
   3.7935023523755584`*^9, 3.7935023996225553`*^9, 3.79350244777707*^9, 
   3.7935024923366423`*^9, 3.793503069760127*^9, 3.793503108385208*^9, 
   3.7935031512956934`*^9, 3.7935031933493347`*^9, 3.7935032424458766`*^9, 
   3.7935033033235598`*^9, 3.7935033884359074`*^9, 3.793509514946414*^9, 
   3.7935096039729033`*^9, 3.793509687221239*^9, 3.7935098180062227`*^9, 
   3.7935098923912425`*^9, 3.793509946015168*^9, 3.793510043752597*^9, 
   3.7935102468786025`*^9, 3.7935102951669216`*^9, 3.793510351629629*^9, 
   3.7935106258379736`*^9, 3.7935107402368*^9, 3.793510842665494*^9, 
   3.7935108884618144`*^9, 3.793510953611599*^9, 3.7935110122605534`*^9, 
   3.7935406228850374`*^9, 3.793540686916468*^9, 3.793540742663875*^9, 
   3.793542187054742*^9, 3.7935422378172674`*^9, 3.7935424318701086`*^9, 
   3.793544842571539*^9, 3.793544944956967*^9, 3.793544992727081*^9, 
   3.7935450369785604`*^9, 3.793545093446457*^9, 3.793545139557495*^9, 
   3.793545222912258*^9, 3.7935452787034545`*^9, 3.793545422196624*^9, 
   3.793545517754629*^9, 3.793545777101022*^9, 3.79354584568851*^9, 
   3.839129202358239*^9},
 CellLabel->
  "Out[293]=",ExpressionUUID->"f770910c-13ba-4b91-bea0-d8f89737ba63"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]\[Tau]", "=", 
   FractionBox["\[CapitalDelta]\[Tau]s", 
    RowBox[{"1", "-", 
     RowBox[{"a", " ", 
      SuperscriptBox["g", "M"]}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.788498250710834*^9, 3.788498277572573*^9}, {
   3.7908282244925756`*^9, 3.7908282262579184`*^9}, 3.7922257295829453`*^9, {
   3.792227858199877*^9, 3.7922278585280046`*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"32f1152b-d38c-45ad-911e-246b2497407b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Heyney-Greenstein phase function", "Text"]], \
"Subsubsection",
 CellChangeTimes->{{3.78825290635326*^9, 
  3.788252923479802*^9}},ExpressionUUID->"12b7da6d-23db-46f5-be84-\
3662aea470a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Chi]", "*"], "[", "k_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Chi]", "*"], "[", "k", "]"}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["g", "k"], "-", 
      SuperscriptBox["g", "M"]}], 
     RowBox[{"1", "-", 
      SuperscriptBox["g", "M"]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7922198041214104`*^9, 3.7922198047508554`*^9}, 
   3.792225166299241*^9, 3.792225723440709*^9, {3.7928132976156874`*^9, 
   3.7928133038345366`*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"fc062a8b-aebf-4209-bbe7-83e755f3474e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PPmatrix", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"M", ",", " ", "M"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPmatrix", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "All"}], "]"}], "]"}], "=", "1."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPmatrix", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "All"}], "]"}], "]"}], "=", "\[Nu]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PPmatrix", "[", 
        RowBox[{"[", 
         RowBox[{"nn", ",", "j"}], "]"}], "]"}], "=", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "nn"}], "-", "3"}], ")"}], " ", 
          RowBox[{"\[Nu]", "[", 
           RowBox[{"[", "j", "]"}], "]"}], " ", 
          RowBox[{"PPmatrix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"nn", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"nn", "-", "2"}], ")"}], " ", 
          RowBox[{"PPmatrix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"nn", "-", "2"}], ",", "j"}], "]"}], "]"}]}]}], 
        RowBox[{"nn", "-", "1"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"nn", ",", "3", ",", "M"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "M"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PNmatrix", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"nn", "-", "1"}]], " ", 
      RowBox[{"PPmatrix", "[", 
       RowBox[{"[", 
        RowBox[{"nn", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"nn", ",", "1", ",", "M"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.792499320743333*^9, 3.7924993706941185`*^9}, {
   3.7924994459239445`*^9, 3.792499458876355*^9}, {3.792499569870246*^9, 
   3.7924995851506557`*^9}, {3.792499615727097*^9, 3.7924996598027954`*^9}, {
   3.792506377015198*^9, 3.7925063773902826`*^9}, {3.792506432322228*^9, 
   3.7925064330096893`*^9}, {3.792506467148613*^9, 3.7925064802102146`*^9}, {
   3.7925065167396603`*^9, 3.792506671590308*^9}, {3.7925069333622713`*^9, 
   3.7925070062155075`*^9}, {3.7925070832105665`*^9, 3.792507087644111*^9}, {
   3.7925071620234056`*^9, 3.792507162406027*^9}, {3.7925072993226547`*^9, 
   3.7925073064903374`*^9}, {3.792507349154248*^9, 3.792507349513894*^9}, {
   3.7925075217696495`*^9, 3.792507527062183*^9}, {3.7925080747659383`*^9, 
   3.792508074906559*^9}, {3.792508629607686*^9, 3.792508691723918*^9}, {
   3.792509189969199*^9, 3.792509222688406*^9}, 3.7925094116508427`*^9, {
   3.792514164876917*^9, 3.792514219320238*^9}, {3.792514249421147*^9, 
   3.7925142727162123`*^9}, {3.79251430666064*^9, 3.7925143107318716`*^9}, {
   3.7925143414492393`*^9, 3.7925143874582663`*^9}, {3.7925146507460136`*^9, 
   3.7925147531671677`*^9}, {3.7925147952597003`*^9, 
   3.7925147971873116`*^9}, {3.792515231069809*^9, 3.7925152342457776`*^9}, {
   3.7925188904809103`*^9, 3.792518895814765*^9}, 3.792520290279264*^9, {
   3.7928094622677035`*^9, 3.7928094909868517`*^9}, {3.792809585816292*^9, 
   3.7928096440084195`*^9}, {3.792809696806025*^9, 3.7928097079624295`*^9}, {
   3.792809746041067*^9, 3.792809768838273*^9}, {3.7928106599746737`*^9, 
   3.7928106708029366`*^9}, {3.792810748288248*^9, 3.792810748632*^9}, 
   3.792811323924727*^9, {3.792811405238353*^9, 3.792811409957151*^9}, {
   3.792811618699467*^9, 3.792811648403001*^9}, {3.7928118114660378`*^9, 
   3.792811811637915*^9}, {3.792812811845817*^9, 3.792812815158359*^9}, {
   3.7928139519248667`*^9, 3.7928139721282873`*^9}, {3.792814094758052*^9, 
   3.792814099117487*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"88721a6e-def1-4adf-a288-721af8484f7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hpp", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"M", ",", " ", "M"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hpm", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"M", ",", " ", "M"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"g", "==", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hpp", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1.", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", " ", "M"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hpm", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1.", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", " ", "M"}], "}"}]}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"hpp", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "k"}], "+", "1"}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["\[Chi]", "*"], "[", "k", "]"}], 
             RowBox[{"PPmatrix", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}], " ", 
             RowBox[{"PPmatrix", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"k", "+", "1"}], ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i", ",", "M"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "M"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"hpp", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
          RowBox[{"hpp", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "M"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "M"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"hpm", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "k"}], "+", "1"}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["\[Chi]", "*"], "[", "k", "]"}], 
             RowBox[{"PPmatrix", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}], " ", 
             RowBox[{"PNmatrix", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"k", "+", "1"}], ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i", ",", "M"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "M"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"hpm", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
          RowBox[{"hpm", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "M"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "M"}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7925150205477705`*^9, 3.792515028918619*^9}, {
   3.792515067472681*^9, 3.792515079101334*^9}, 3.792515129186868*^9, 
   3.79251733085216*^9, {3.792517676345151*^9, 3.792517705208599*^9}, {
   3.792518849286147*^9, 3.7925188711475797`*^9}, {3.792518946081359*^9, 
   3.792519098365443*^9}, {3.792519163683292*^9, 3.7925191701634226`*^9}, {
   3.792519312250909*^9, 3.792519312930701*^9}, {3.792519377750278*^9, 
   3.7925193812464733`*^9}, {3.792519479119999*^9, 3.7925194817640905`*^9}, {
   3.792519519762455*^9, 3.7925195317226057`*^9}, {3.792519574992771*^9, 
   3.792519591880318*^9}, {3.792519701369706*^9, 3.7925197018073907`*^9}, {
   3.7925197985172253`*^9, 3.7925198292093377`*^9}, {3.7925198728763776`*^9, 
   3.7925200015378556`*^9}, {3.792809351338253*^9, 3.792809366322853*^9}, {
   3.7928095192997437`*^9, 3.7928095222997704`*^9}, {3.792810222152706*^9, 
   3.792810243356676*^9}, {3.792812640998334*^9, 3.7928126422795887`*^9}, {
   3.792812798109869*^9, 3.792812800938033*^9}, {3.792812845705655*^9, 
   3.792812864288381*^9}, {3.7928129464770203`*^9, 3.7928130528717365`*^9}, {
   3.7928133606321855`*^9, 3.7928133626322126`*^9}, {3.792813994894226*^9, 
   3.7928140221123514`*^9}, {3.792814145837039*^9, 3.792814178463281*^9}, 
   3.7928142596028657`*^9, 3.792814308947298*^9, {3.7928143957935724`*^9, 
   3.7928143964498315`*^9}, {3.792815149966285*^9, 3.792815157153886*^9}, {
   3.7928152067014313`*^9, 3.7928152096389713`*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"8bcc470b-0f66-44d6-a219-7ff3048af32f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"cachedLegendreP", ",", "PPmatrix", ",", "PNmatrix"}], "]"}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7923846807620344`*^9, 3.7923847127458916`*^9}, {
   3.792384743141822*^9, 3.7923847451427183`*^9}, {3.792384979376559*^9, 
   3.7923849807813816`*^9}, {3.7923866874947367`*^9, 3.792386689818104*^9}, 
   3.7923874988270226`*^9, 3.7923881156947627`*^9, {3.7925152393637652`*^9, 
   3.7925152449326954`*^9}, 3.7928107150221586`*^9, 3.7928127192181683`*^9, 
   3.79281275817183*^9, 3.792812873085373*^9, 3.7928137760146594`*^9, 
   3.7928140271280317`*^9, {3.79281428207194*^9, 3.7928142971033983`*^9}, 
   3.7928143273381777`*^9, {3.792814375637044*^9, 3.7928143823246355`*^9}, 
   3.7928151861855226`*^9},
 CellLabel->
  "In[304]:=",ExpressionUUID->"aadfea92-2bb1-422e-b6a4-51c5064e788c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Layer Initialiation", "Subsection"]], "Subsubsection",
 CellChangeTimes->{{3.7885841406678114`*^9, 
  3.788584155151945*^9}},ExpressionUUID->"d42648fc-b92b-4531-872e-\
6203130f086e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EE", "=", 
   RowBox[{"IdentityMatrix", "[", "M", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.788584254289254*^9, 3.7885842771170983`*^9}, {
  3.7922206422778854`*^9, 3.7922206992499585`*^9}, {3.7922247170541935`*^9, 
  3.7922247173654146`*^9}, {3.7923783409322767`*^9, 3.792378344567124*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"3a18b977-f8f9-4f70-8221-41ceaf80c35f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"as", " ", "\[CapitalDelta]\[Tau]s", " ", 
        RowBox[{"w", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], 
       RowBox[{"4", " ", 
        RowBox[{"\[Nu]", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]], " ", 
      RowBox[{"hpm", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "M"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "M"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7885842963816814`*^9, 3.7885843397709446`*^9}, {
   3.7903913368733253`*^9, 3.790391342317735*^9}, {3.790400887577277*^9, 
   3.7904009910678587`*^9}, {3.790401287905181*^9, 3.790401294441592*^9}, {
   3.790401346015283*^9, 3.790401348292887*^9}, {3.7904013821293464`*^9, 
   3.79040140125498*^9}, {3.7904016456606092`*^9, 3.790401646440611*^9}, {
   3.790405438474064*^9, 3.7904054473816795`*^9}, 3.790405541325044*^9, 
   3.790405844114498*^9, {3.7904060257151937`*^9, 3.7904060270723963`*^9}, {
   3.7904063718798018`*^9, 3.7904063738298054`*^9}, {3.7904064070110636`*^9, 
   3.790406408071865*^9}, 3.7917794024678164`*^9, {3.7922207041288557`*^9, 
   3.792220737386146*^9}, 3.7922217521431785`*^9, {3.7922247129579277`*^9, 
   3.792224713310893*^9}, {3.7922277730845776`*^9, 3.7922277746818476`*^9}, 
   3.792378348780222*^9, 3.7923784962181034`*^9, {3.792386917665971*^9, 
   3.792386924069843*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"a75d48d3-6637-458b-b461-750f5955021f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{
         RowBox[{"i", ",", "j"}]},
        "KroneckerDeltaSeq"], " ", 
       FractionBox["\[CapitalDelta]\[Tau]s", 
        RowBox[{"2", " ", 
         RowBox[{"\[Nu]", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]]}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"as", " ", "\[CapitalDelta]\[Tau]s", " ", 
         RowBox[{"w", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], 
        RowBox[{"4", " ", 
         RowBox[{"\[Nu]", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]], 
       RowBox[{"hpp", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "M"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "M"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7885843429583435`*^9, 3.7885844007221966`*^9}, {
   3.7903913454533405`*^9, 3.7903913489789467`*^9}, {3.790401670542653*^9, 
   3.7904017942664704`*^9}, 3.7904055467382536`*^9, 3.790405849636908*^9, 
   3.790405909057412*^9, {3.790406028897599*^9, 3.790406030738403*^9}, {
   3.7904063753898077`*^9, 3.7904063791650143`*^9}, {3.790406411566272*^9, 
   3.7904064150606775`*^9}, 3.7917794090503955`*^9, {3.792221756924556*^9, 
   3.792221768879012*^9}, {3.792224710115786*^9, 3.7922247104780416`*^9}, {
   3.7922277625764866`*^9, 3.792227783622758*^9}, {3.79238670507093*^9, 
   3.792386712962818*^9}, {3.792386926913316*^9, 3.792386928104461*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"91b0eff1-45c7-452f-b42a-b584f126cdda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Inv", "=", 
   RowBox[{"Inverse", "[", 
    RowBox[{"EE", "+", "A"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7885907357754574`*^9, 3.788590776680233*^9}, {
  3.7922207497226467`*^9, 3.7922207604532547`*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"4bf3411b-054f-4958-a74f-9e5ead54d106"],

Cell[BoxData[
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"Inverse", "[", 
    RowBox[{"EE", "+", "A", "-", 
     RowBox[{"B", ".", "Inv", ".", "B"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7885844049878883`*^9, 3.788584443682686*^9}, {
   3.788590759064968*^9, 3.7885907862314944`*^9}, {3.788590906546454*^9, 
   3.7885909595038376`*^9}, {3.7904059939390497`*^9, 3.790405997480256*^9}, 
   3.7917794158124723`*^9, 3.792224574018052*^9, {3.792224751662509*^9, 
   3.792224752705584*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"cb13e540-ee04-45b8-b2d1-da5df13f8509"],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"2.", 
    RowBox[{"G", ".", "B", ".", "Inv"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7885844470107045`*^9, 3.788584469416252*^9}, {
  3.7885907655805345`*^9, 3.788590789512559*^9}, {3.7907633383333178`*^9, 
  3.7907633387084155`*^9}, {3.790763388966175*^9, 3.790763394610564*^9}, {
  3.7907682516615562`*^9, 3.790768252083416*^9}, {3.790768414519153*^9, 
  3.790768414845237*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"eeb042be-e405-473d-8b15-99edead1b517"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{
    RowBox[{"2.", "G"}], "-", "EE"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.788584471994458*^9, 3.788584480540906*^9}, {
  3.7907633409269886`*^9, 3.7907633416301394`*^9}, {3.790768257491254*^9, 
  3.7907682578458014`*^9}, {3.7907684168146753`*^9, 3.790768417080365*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"344dd9a4-e4dc-4459-93a9-a557591ad1b4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"A", ",", "B", ",", "G", ",", "Inv", ",", "hpp", ",", "hpm"}], 
    "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7923879139356365`*^9, 3.7923879863893433`*^9}, 
   3.792388043555179*^9, 3.792811454149006*^9, 3.792812878476063*^9, 
   3.7928138003743596`*^9, 3.7928140307062073`*^9, 3.7928151960294223`*^9},
 CellLabel->
  "In[312]:=",ExpressionUUID->"6812acf9-8c68-4df0-a44e-0abc50c82ff7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"twoaw", "=", 
   RowBox[{"2", " ", "\[Nu]", " ", "w"}]}], ";"}]], "Input",
 CellLabel->
  "In[313]:=",ExpressionUUID->"739e61b7-5477-45e3-bfeb-8155697d4a65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rd1", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"R", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], 
      RowBox[{"twoaw", "[", 
       RowBox[{"[", "j", "]"}], "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "M"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "M"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Td1", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"T", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], 
      RowBox[{"twoaw", "[", 
       RowBox[{"[", "j", "]"}], "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "M"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "M"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790825906071698*^9, 3.7908260179061213`*^9}, {
  3.7908277672387247`*^9, 3.7908277764929094`*^9}, {3.791779449123638*^9, 
  3.7917794508896804`*^9}, {3.79222076994532*^9, 3.7922207801044617`*^9}, {
  3.792220834401165*^9, 3.7922208368999424`*^9}, {3.7922246860559173`*^9, 
  3.7922246918960533`*^9}, {3.7922247593816648`*^9, 3.7922247701740093`*^9}, {
  3.7922277917403345`*^9, 3.7922277959470263`*^9}, {3.7923869313603973`*^9, 
  3.7923869336982484`*^9}, {3.792388014557934*^9, 3.792388024648509*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"44e9553c-a99a-44c4-b75a-57cf3bf0b0aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Doubling until desired thickness is reached", "Subsubsection",
 CellChangeTimes->{{3.7908264258054285`*^9, 
  3.790826451714967*^9}},ExpressionUUID->"5e1e9729-6b85-4dda-8e0c-\
88cfb39ac8d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newE", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    FractionBox["1.", "twoaw"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"star", "=", 
   RowBox[{"DiagonalMatrix", "[", "twoaw", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790827863877113*^9, 3.7908279554609585`*^9}, {
   3.79082798808076*^9, 3.7908280172485714`*^9}, {3.792220785335001*^9, 
   3.7922208012631693`*^9}, {3.7922208390815616`*^9, 3.792220946290944*^9}, {
   3.7922278004912944`*^9, 3.7922278044154587`*^9}, {3.792386954404569*^9, 
   3.792386956034513*^9}, {3.792387001194912*^9, 3.792387019759413*^9}, {
   3.792388002726116*^9, 3.7923880033823724`*^9}, 3.792812651342228*^9},
 CellLabel->
  "In[316]:=",ExpressionUUID->"3518bb08-ad77-4f62-a56b-4b42d092102f"],

Cell["Now I\[CloseCurlyQuote]ll try to avoid recursion here...", "Text",
 CellChangeTimes->{{3.790829588130557*^9, 
  3.7908296125113773`*^9}},ExpressionUUID->"910672a9-4d05-4313-b7f4-\
ec8f697fa4bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Td2", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rd2", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Td", "=", 
   RowBox[{"List", "[", 
    RowBox[{"Td1", ",", "Td2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rd", "=", 
   RowBox[{"List", "[", 
    RowBox[{"Rd1", ",", "Rd2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7908300299549303`*^9, 3.7908300919747925`*^9}, {
   3.7908301251591573`*^9, 3.790830169980811*^9}, {3.7908305036323433`*^9, 
   3.7908305332677765`*^9}, 3.7917794607700524`*^9, {3.7922209616322947`*^9, 
   3.7922210065740447`*^9}, {3.792221037404848*^9, 3.7922210689932766`*^9}, {
   3.792224773050479*^9, 3.792224773534875*^9}, {3.7923869647727356`*^9, 
   3.7923869654486113`*^9}, {3.792812654342255*^9, 3.7928126567329273`*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"ec605d8d-1b1e-4bb1-b826-7d3dd81f5e76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "n1"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EvenQ", "[", "i", "]"}], "\[Equal]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Td", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Td", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{"newE", "-", 
            RowBox[{
             RowBox[{"Rd", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ".", "star", ".", 
             RowBox[{"Rd", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ".", 
          RowBox[{"Td", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Rd", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Td", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{"newE", "-", 
             RowBox[{
              RowBox[{"Rd", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ".", "star", ".", 
              RowBox[{"Rd", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ".", 
           RowBox[{"Rd", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ".", "star", ".", 
           RowBox[{"Td", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{"Rd", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Td", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Td", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{"newE", "-", 
            RowBox[{
             RowBox[{"Rd", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ".", "star", ".", 
             RowBox[{"Rd", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ".", 
          RowBox[{"Td", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Rd", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Td", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{"newE", "-", 
             RowBox[{
              RowBox[{"Rd", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ".", "star", ".", 
              RowBox[{"Rd", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ".", 
           RowBox[{"Rd", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ".", "star", ".", 
           RowBox[{"Td", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "+", 
          RowBox[{"Rd", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7908283558016806`*^9, 3.7908283799818883`*^9}, {
  3.790828411992652*^9, 3.7908284854019156`*^9}, {3.790830118769641*^9, 
  3.7908301216503835`*^9}, {3.7908302098073635`*^9, 3.790830213188691*^9}, {
  3.7908302510185013`*^9, 3.7908303163848524`*^9}, {3.7908303785453672`*^9, 
  3.7908305013672795`*^9}, {3.790830551255361*^9, 3.7908306475836616`*^9}, {
  3.792221214372488*^9, 3.7922212433113976`*^9}, {3.792225199512477*^9, 
  3.7922252002526007`*^9}, {3.7922282196332045`*^9, 3.7922282573039494`*^9}, {
  3.7922286701171665`*^9, 3.792228678683835*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"04aaacab-d426-4a84-ade7-22237715fd7d"],

Cell["R and T for desired optical thickness", "Text",
 CellChangeTimes->{{3.79083082073977*^9, 
  3.790830834177597*^9}},ExpressionUUID->"c9c07807-b40d-4da0-9a94-\
988b06ce54e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"EvenQ", "[", "n1", "]"}], "\[Equal]", "True"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Rslab", "=", 
      RowBox[{"Rd", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Tslab", "=", 
      RowBox[{"Td", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Rslab", "=", 
      RowBox[{"Rd", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Tslab", "=", 
      RowBox[{"Td", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.7908308440483055`*^9, {3.7908308805401917`*^9, 3.790830955872636*^9}, {
   3.7917794748645096`*^9, 3.7917794765906277`*^9}, {3.792224792177969*^9, 
   3.792224792624296*^9}, {3.792387119799674*^9, 3.7923871347431726`*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"92e986c4-b517-4e2c-8ba3-6ef140bc5dba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fresnel reflection & boundary conditions", "Subsubsection",
 CellChangeTimes->{{3.7908316292836523`*^9, 
  3.7908316471728745`*^9}},ExpressionUUID->"b8e394a2-371d-4e96-8f4a-\
56ced7deb91c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Nu]t", "[", 
    RowBox[{"ni_", ",", "nt_", ",", "\[Nu]i_"}], "]"}], "=", 
   SqrtBox[
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["ni", "nt"], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[Nu]i", "2"]}], ")"}]}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FresnelR", "[", 
    RowBox[{"\[Nu]i_", ",", "ni_", ",", "nt_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"nt", " ", "\[Nu]i"}], "-", 
         RowBox[{"ni", " ", 
          RowBox[{"Re", "[", 
           RowBox[{"\[Nu]t", "[", 
            RowBox[{"ni", ",", "nt", ",", "\[Nu]i"}], "]"}], "]"}]}]}], 
        RowBox[{
         RowBox[{"nt", " ", "\[Nu]i"}], "+", 
         RowBox[{"ni", " ", 
          RowBox[{"Re", "[", 
           RowBox[{"\[Nu]t", "[", 
            RowBox[{"ni", ",", "nt", ",", "\[Nu]i"}], "]"}], "]"}]}]}]], 
       ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"ni", " ", "\[Nu]i"}], "-", 
         RowBox[{"nt", " ", 
          RowBox[{"Re", "[", 
           RowBox[{"\[Nu]t", "[", 
            RowBox[{"ni", ",", "nt", ",", "\[Nu]i"}], "]"}], "]"}]}]}], 
        RowBox[{
         RowBox[{"ni", " ", "\[Nu]i"}], "+", 
         RowBox[{"nt", " ", 
          RowBox[{"Re", "[", 
           RowBox[{"\[Nu]t", "[", 
            RowBox[{"ni", ",", "nt", ",", "\[Nu]i"}], "]"}], "]"}]}]}]], 
       ")"}], "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rbound", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FresnelR", "[", 
           RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "+", 
          RowBox[{"FresnelR", "[", 
           RowBox[{
            RowBox[{"\[Nu]t", "[", 
             RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", "nglass",
             ",", "1"}], "]"}], "-", 
          RowBox[{"2", "\[Times]", 
           RowBox[{"FresnelR", "[", 
            RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "\[Times]", 
           RowBox[{"FresnelR", "[", 
            RowBox[{
             RowBox[{"\[Nu]t", "[", 
              RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", 
             "nglass", ",", "1"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"FresnelR", "[", 
            RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "\[Times]", 
           RowBox[{"FresnelR", "[", 
            RowBox[{
             RowBox[{"\[Nu]t", "[", 
              RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", 
             "nglass", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], "\[Times]", " ",
       "twoaw"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Tbound", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Chop", "[", 
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FresnelR", "[", 
          RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "+", 
         RowBox[{"FresnelR", "[", 
          RowBox[{
           RowBox[{"\[Nu]t", "[", 
            RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", "nglass", 
           ",", "1"}], "]"}], "-", 
         RowBox[{"2", "\[Times]", 
          RowBox[{"FresnelR", "[", 
           RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "\[Times]", 
          RowBox[{"FresnelR", "[", 
           RowBox[{
            RowBox[{"\[Nu]t", "[", 
             RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", "nglass",
             ",", "1"}], "]"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"FresnelR", "[", 
           RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "\[Times]", 
          RowBox[{"FresnelR", "[", 
           RowBox[{
            RowBox[{"\[Nu]t", "[", 
             RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", "nglass",
             ",", "1"}], "]"}]}]}], ")"}]}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.790907158522921*^9, 3.7909072052245193`*^9}, {
   3.7909072452076435`*^9, 3.790907330845421*^9}, {3.7909074776058426`*^9, 
   3.7909074797932653`*^9}, {3.790907523327859*^9, 3.7909075662952056`*^9}, 
   3.7909076186216216`*^9, {3.790907703884465*^9, 3.79090771822775*^9}, {
   3.790907789522298*^9, 3.790907812349676*^9}, {3.790907851895261*^9, 
   3.790907852957725*^9}, {3.7909079014561415`*^9, 3.7909079020029955`*^9}, {
   3.7909079737101183`*^9, 3.790907977335003*^9}, {3.7909080525981708`*^9, 
   3.790908111127511*^9}, {3.7909083332608843`*^9, 3.790908352650877*^9}, {
   3.7909097927790146`*^9, 3.7909098401586943`*^9}, {3.790910046940713*^9, 
   3.790910047790107*^9}, 3.7911777568341246`*^9, {3.791178763319762*^9, 
   3.79117879915119*^9}, {3.791179414357689*^9, 3.791179414959256*^9}, {
   3.7911794528640347`*^9, 3.7911794576809826`*^9}, {3.7911799804140344`*^9, 
   3.7911799808120623`*^9}, 3.791779485284866*^9, {3.7922213673964024`*^9, 
   3.7922215616791563`*^9}, {3.7922248062422*^9, 3.792224806522409*^9}, {
   3.792225206736641*^9, 3.792225207548583*^9}, {3.7922278985540366`*^9, 
   3.7922279062689877`*^9}, {3.7923870599788485`*^9, 
   3.7923870954249954`*^9}, {3.7932576580574055`*^9, 3.793257661560248*^9}, {
   3.7932578599727483`*^9, 3.7932578676621943`*^9}, {3.7932590823267727`*^9, 
   3.7932591810949554`*^9}, {3.7932594870039473`*^9, 3.793259496128737*^9}, {
   3.793259538359342*^9, 3.7932595458654137`*^9}, {3.793259766619626*^9, 
   3.7932597778842044`*^9}, {3.793259822202195*^9, 3.793260130136829*^9}, {
   3.793260183888789*^9, 3.7932602950437183`*^9}, {3.793262858210754*^9, 
   3.793262896123499*^9}, {3.79326385148326*^9, 3.793263871971049*^9}, {
   3.793263963806428*^9, 3.7932639657211*^9}, {3.793265333543038*^9, 
   3.7932653794590116`*^9}, {3.7932674441813803`*^9, 
   3.7932674906610575`*^9}, {3.7932676194583178`*^9, 
   3.7932676209249735`*^9}, {3.7932677135863824`*^9, 
   3.7932677366003036`*^9}, {3.793329235817568*^9, 3.7933292795616574`*^9}, {
   3.7933293298064876`*^9, 3.79332933207705*^9}, {3.7933295645062857`*^9, 
   3.7933295663501186`*^9}, {3.7933297420864987`*^9, 3.7933297441361375`*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"62ff3788-f0c9-48a7-9179-51265b5a4217"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Adding boundaries to the slab", "Subsubsection",
 CellChangeTimes->{{3.7911800033149223`*^9, 
  3.7911800102800465`*^9}},ExpressionUUID->"61b66a86-cf7d-49d0-b0f5-\
2ca967abdc7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"T02", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"Tslab", ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"EE", "-", 
       RowBox[{"Rbound", ".", "Rslab"}]}], "]"}], ".", "Tbound"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R20", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"Tslab", ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"EE", "-", 
        RowBox[{"Rbound", ".", "Rslab"}]}], "]"}], ".", "Rbound", ".", 
      "Tslab"}], "+", "Rslab"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.791180023131076*^9, 3.7911800620032167`*^9}, {
  3.791180168567599*^9, 3.791180172306975*^9}, {3.7911804302423563`*^9, 
  3.7911806895142746`*^9}, {3.7911826496568594`*^9, 3.7911827266525354`*^9}, {
  3.791183066048019*^9, 3.791183079493684*^9}, {3.791183345637225*^9, 
  3.791183368727637*^9}, {3.7916169669765673`*^9, 3.7916169823047247`*^9}, {
  3.79177951058592*^9, 3.791779512271915*^9}, {3.7922248163116636`*^9, 
  3.792224816648902*^9}},
 CellLabel->
  "In[328]:=",ExpressionUUID->"92d11ed0-3ed1-4945-8bc7-158dfcf3d646"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"T03", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"Tbound", ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"EE", "-", 
       RowBox[{"R20", ".", "Rbound"}]}], "]"}], ".", "T02"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R30", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"Tbound", ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"EE", "-", 
       RowBox[{"R20", ".", "Rbound"}]}], "]"}], ".", "R20", ".", "Tbound"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "M"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"R30", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
     FractionBox[
      RowBox[{"Rbound", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "i"}], "]"}], "]"}], 
      SuperscriptBox[
       RowBox[{"twoaw", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "2"]]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7911839268187075`*^9, 3.7911839416439285`*^9}, 
   3.7912621831470613`*^9, {3.791262310080556*^9, 3.7912623120179224`*^9}, {
   3.791616995289009*^9, 3.7916170061171446`*^9}, {3.7917795210723352`*^9, 
   3.791779522882453*^9}, {3.792224819487792*^9, 3.792224819882069*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"29b9d6c4-3052-4377-b623-73e54a44151c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rc", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"2", " ", "\[Nu]", " ", "w", " ", 
      RowBox[{"R30", "[", 
       RowBox[{"[", "M", "]"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Tc", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"2", " ", "\[Nu]", " ", "w", " ", 
      RowBox[{"T03", "[", 
       RowBox[{"[", "M", "]"}], "]"}]}], "]"}]}]}], "}"}]], "Input",
 CellChangeTimes->{{3.7912623456891117`*^9, 3.791262349564164*^9}, {
  3.791262420089177*^9, 3.7912624749312363`*^9}, {3.7912625298357964`*^9, 
  3.791262543460386*^9}, {3.791262578256191*^9, 3.791262580974856*^9}, {
  3.7912626168331327`*^9, 3.7912626667690926`*^9}, {3.7916169186016254`*^9, 
  3.7916169325705643`*^9}, {3.792227913127484*^9, 3.79222791686966*^9}, {
  3.7923871779455523`*^9, 3.792387182993332*^9}, {3.792387239213123*^9, 
  3.792387253128194*^9}, {3.792387426807272*^9, 3.7923874338648186`*^9}},
 CellLabel->
  "In[333]:=",ExpressionUUID->"d0224b80-801f-4d4e-9b2e-9af9073ab7e1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.08444568308828544`", ",", "0.7641978516784014`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.791262546491536*^9, 3.7912625825687375`*^9, 3.7912626186768208`*^9, {
   3.7912626545663457`*^9, 3.7912626681286087`*^9}, 3.7912631275006003`*^9, 
   3.7912631713638678`*^9, 3.7912635951048865`*^9, 3.791263700917816*^9, {
   3.7912644006573944`*^9, 3.79126445342137*^9}, 3.7912657304479*^9, 
   3.791265789064934*^9, 3.791265922885525*^9, 3.7912659849376216`*^9, 
   3.7912664438076963`*^9, 3.7912665482163405`*^9, 3.7912675730152793`*^9, 
   3.7912685097563095`*^9, {3.7912685476976213`*^9, 3.791268558348221*^9}, 
   3.7912698068730783`*^9, 3.7912701745450177`*^9, 3.791270344157339*^9, 
   3.7912706139381723`*^9, 3.7912709525775146`*^9, 3.7912710238599267`*^9, {
   3.79127111239674*^9, 3.791271136454191*^9}, 3.791388562035104*^9, 
   3.7916163197323604`*^9, 3.7916164073409877`*^9, 3.7916165112467017`*^9, 
   3.791616651196745*^9, 3.7916169345077925`*^9, {3.7916170151011314`*^9, 
   3.7916170290411177`*^9}, 3.791777641794552*^9, 3.7917780202781773`*^9, 
   3.7917781051912594`*^9, 3.7917782578270655`*^9, 3.7917783982519956`*^9, 
   3.7917784617240677`*^9, 3.7917785446671333`*^9, 3.7917795420230355`*^9, 
   3.792119329018818*^9, 3.792221113609994*^9, 3.7922218075442944`*^9, 
   3.79222184295514*^9, 3.7922219447872143`*^9, 3.7922238862275424`*^9, 
   3.7922239884559417`*^9, {3.7922242147227325`*^9, 3.7922242256795435`*^9}, {
   3.7922248352367063`*^9, 3.792224861085094*^9}, 3.7922250337360725`*^9, {
   3.7922250803058615`*^9, 3.792225104151093*^9}, 3.7922251402413926`*^9, {
   3.7922252186423254`*^9, 3.792225251787986*^9}, 3.792225394085109*^9, 
   3.7922256624087353`*^9, 3.7922258743275146`*^9, 3.7922272166496043`*^9, 
   3.7922273021162286`*^9, 3.7922273648039722`*^9, 3.7922273994539566`*^9, 
   3.7922274316327343`*^9, 3.7922274622824073`*^9, 3.7922277673499174`*^9, 
   3.7922283447185297`*^9, 3.7923757128012495`*^9, 3.7923760499074917`*^9, 
   3.7923786923622866`*^9, 3.792379540023904*^9, 3.792380242892873*^9, 
   3.792383477789016*^9, 3.792384651323075*^9, 3.792385489193746*^9, 
   3.7923859074876966`*^9, 3.7923860510164733`*^9, 3.792386206833173*^9, 
   3.7923871854365206`*^9, 3.792387253862561*^9, 3.7923874343591585`*^9, 
   3.79238751072178*^9, 3.7923877042113924`*^9, 3.792387924618257*^9, 
   3.7923880556436996`*^9, 3.7923882888680077`*^9, 3.7925072792222843`*^9, 
   3.7925076493941636`*^9, 3.7925084138262954`*^9, {3.7925142492024107`*^9, 
   3.7925142831964197`*^9}, 3.7925151678568325`*^9, 3.792515204237378*^9, 
   3.7925152562030945`*^9, 3.7925153064014654`*^9, 3.7925158047237625`*^9, 
   3.792516149658032*^9, 3.7925166566339736`*^9, 3.7925169133491263`*^9, 
   3.792517755088966*^9, 3.792517937966493*^9, 3.792517990188614*^9, 
   3.792518376301775*^9, 3.792519491083603*^9, 3.7925196862785397`*^9, 
   3.7925197259626737`*^9, {3.792519909934288*^9, 3.7925199308865724`*^9}, {
   3.792519964785922*^9, 3.792520033695241*^9}, 3.7925201090660925`*^9, 
   3.792520385455253*^9, 3.79280943660506*^9, 3.7928096859308605`*^9, 
   3.792809835934993*^9, 3.7928108374310637`*^9, 3.7928109119789705`*^9, 
   3.7928114161916122`*^9, {3.792811626637061*^9, 3.7928116515280304`*^9}, 
   3.792812712139928*^9, {3.792812749249817*^9, 3.792812769390724*^9}, 
   3.7928130673562994`*^9, 3.792813732123416*^9, {3.792813779874077*^9, 
   3.792813803218149*^9}, 3.7928141706655083`*^9, {3.7928142707748947`*^9, 
   3.792814313509861*^9}, 3.7928143461040616`*^9, 3.7928144172495875`*^9, 
   3.7928151702478056`*^9, 3.7928152105296087`*^9, 3.7928156350061646`*^9, 
   3.79281569975706*^9, 3.792816053719928*^9, 3.792816135080428*^9, 
   3.7930748673738117`*^9, 3.7930748999671187`*^9, {3.7930773954518895`*^9, 
   3.793077443896122*^9}, 3.7932543127286406`*^9, 3.79325439640532*^9, 
   3.793255032530154*^9, 3.7932563955991583`*^9, 3.7933410944726915`*^9, 
   3.7933415735533466`*^9, 3.7933422114441195`*^9, 3.7933436096198454`*^9, 
   3.7933437587433352`*^9, 3.7933438870656433`*^9, 3.7933447459776993`*^9, 
   3.793344793598374*^9, 3.7933449815009675`*^9, 3.7933450357485504`*^9, 
   3.7933451166973724`*^9, 3.7933452384646273`*^9, 3.7933452802172227`*^9, 
   3.7933453359411135`*^9, 3.7933453970402126`*^9, 3.793345479051258*^9, 
   3.793345573267906*^9, 3.7933456645027*^9, 3.793345727487034*^9, 
   3.793345774524251*^9, 3.7933459841904435`*^9, 3.793346116829212*^9, 
   3.7933462347107744`*^9, 3.7933462924599857`*^9, 3.793415232612978*^9, 
   3.793416540109402*^9, 3.7934177644072423`*^9, 3.7934198115142927`*^9, 
   3.7934199069244337`*^9, 3.793420056932863*^9, 3.79342017875952*^9, 
   3.79342083859589*^9, 3.793421381084519*^9, 3.7934217397395463`*^9, 
   3.793421861193495*^9, 3.7934225791822405`*^9, 3.7934234559053006`*^9, 
   3.7934252342239866`*^9, 3.793431026091737*^9, 3.7934315811485434`*^9, 
   3.7934317326335936`*^9, 3.7934334376087685`*^9, 3.7934340360307703`*^9, 
   3.79343411980099*^9, 3.793434563435719*^9, 3.79343467560954*^9, 
   3.7934394858466897`*^9, 3.793439718511929*^9, 3.7934418853237867`*^9, 
   3.7934420235675917`*^9, 3.793442096540656*^9, 3.7934421465209923`*^9, 
   3.793442202913422*^9, 3.7934423974411497`*^9, 3.793442568933076*^9, 
   3.7934427688610134`*^9, 3.793442948358373*^9, 3.79345472062086*^9, 
   3.7935011991543217`*^9, 3.7935012675484743`*^9, 3.793501331818242*^9, 
   3.7935013869058585`*^9, 3.7935014345315304`*^9, 3.793501519947901*^9, 
   3.79350160750266*^9, 3.7935016438492413`*^9, 3.793501708365994*^9, 
   3.7935017801215878`*^9, 3.7935018387718925`*^9, 3.79350188253646*^9, 
   3.7935019282638483`*^9, 3.793502000076165*^9, 3.7935020538885083`*^9, 
   3.7935022236973596`*^9, 3.793502324674903*^9, 3.793502372907297*^9, 
   3.7935024206665154`*^9, 3.7935024683068504`*^9, 3.7935025135161304`*^9, 
   3.7935030904025154`*^9, 3.7935031292041225`*^9, 3.7935031723974314`*^9, 
   3.793503214126197*^9, 3.7935032641322837`*^9, 3.7935033237901096`*^9, 
   3.793503409442728*^9, 3.7935095364621687`*^9, 3.7935096254730563`*^9, 
   3.793509708532811*^9, 3.7935098390746417`*^9, 3.793509913283585*^9, 
   3.793509967672243*^9, 3.793510064641121*^9, 3.7935102678637667`*^9, 
   3.7935103167002215`*^9, 3.7935103731998277`*^9, 3.7935106468401933`*^9, 
   3.793510761082016*^9, 3.7935108638304358`*^9, 3.793510909187737*^9, 
   3.793510974783849*^9, 3.7935110334177103`*^9, 3.7935406449092503`*^9, 
   3.793540708401807*^9, 3.7935407649861717`*^9, 3.793542209629039*^9, 
   3.7935422599227448`*^9, 3.7935424537825437`*^9, 3.793544865227149*^9, 
   3.793544967889536*^9, 3.7935450150688457`*^9, 3.7935450581635036`*^9, 
   3.7935451167919397`*^9, 3.7935451616293993`*^9, 3.793545247338208*^9, 
   3.793545300399203*^9, 3.793545445020549*^9, 3.7935455398349996`*^9, 
   3.793545799386849*^9, 3.793545868011903*^9, 3.839129234233893*^9},
 CellLabel->
  "Out[333]=",ExpressionUUID->"470da297-dfbc-4e75-9c38-76ad6bcd6845"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find light cones within border", "Subsubsection",
 CellChangeTimes->{{3.793077336758442*^9, 
  3.7930773527767296`*^9}},ExpressionUUID->"3d4ee816-0719-4d81-9bc8-\
10e55f6e11db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"angleBorder", "[", "Z_", "]"}], "=", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"ArcTan", "[", 
      FractionBox["r", "Z"], "]"}], "]"}], "\[Times]", 
    FractionBox["180", "Pi"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"withinBorder", "[", 
    RowBox[{"Z_", ",", "list_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "j", "}"}], ",", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"anglesDeg", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ">", 
         RowBox[{"angleBorder", "[", "Z", "]"}]}], ",", 
        RowBox[{"j", "++"}]}], "]"}], ";", 
      RowBox[{"Drop", "[", 
       RowBox[{"list", ",", 
        RowBox[{"j", "-", "2"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"anglesWB", "[", "Z_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "list", "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Z", "\[Equal]", "0"}], ",", 
       RowBox[{"list", "=", "anglesDeg"}], ",", 
       RowBox[{"list", "=", 
        RowBox[{"withinBorder", "[", 
         RowBox[{"Z", ",", "anglesDeg"}], "]"}]}]}], "]"}], ";", "list"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7934130056838255`*^9, 3.793413017144994*^9}, {
   3.793413127028426*^9, 3.7934131396653624`*^9}, {3.793413191770231*^9, 
   3.793413278753027*^9}, {3.79341350380116*^9, 3.7934135091128063`*^9}, {
   3.7934135401982613`*^9, 3.7934135415201607`*^9}, {3.7934138226083417`*^9, 
   3.79341387545969*^9}, 3.7934142200694714`*^9, {3.7934143287733583`*^9, 
   3.793414334143678*^9}, {3.7934143647860007`*^9, 3.793414400945054*^9}, {
   3.793414672044959*^9, 3.7934147146400394`*^9}, {3.793414805212041*^9, 
   3.7934148347848043`*^9}, {3.793415419288856*^9, 3.793415425993296*^9}, {
   3.7934154957390795`*^9, 3.793415500250386*^9}, 3.7934162270389156`*^9, {
   3.793420704468598*^9, 3.793420784081879*^9}, {3.7934208568108387`*^9, 
   3.7934208723928375`*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"121fff92-c6fc-40ea-bc54-e9cb3e095a94"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sum concerning only angles within border", "Subsubsection",
 CellChangeTimes->{{3.793254599523079*^9, 
  3.793254614012385*^9}},ExpressionUUID->"9d7a1303-a4ef-4e63-a5a1-\
5b0d2729d46d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RlastWB", "[", "Z_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "list", "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Z", "\[Equal]", "0"}], ",", 
        RowBox[{"list", "=", 
         RowBox[{"R30", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "M"}], "]"}], "]"}]}], ",", 
        RowBox[{"list", "=", 
         RowBox[{"withinBorder", "[", 
          RowBox[{"Z", ",", 
           RowBox[{"R30", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "M"}], "]"}], "]"}]}], "]"}]}]}], "]"}], ";",
       "list"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Nu]WB", "[", "Z_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "list", "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Z", "\[Equal]", "0"}], ",", 
        RowBox[{"list", "=", "\[Nu]"}], ",", 
        RowBox[{"list", "=", 
         RowBox[{"withinBorder", "[", 
          RowBox[{"Z", ",", "\[Nu]"}], "]"}]}]}], "]"}], ";", "list"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wWB", "[", "Z_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "list", "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Z", "\[Equal]", "0"}], ",", 
        RowBox[{"list", "=", "w"}], ",", 
        RowBox[{"list", "=", 
         RowBox[{"withinBorder", "[", 
          RowBox[{"Z", ",", "w"}], "]"}]}]}], "]"}], ";", "list"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R30WB", "[", "Z_", "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RlastWB", "[", "Z", "]"}], ",", 
      RowBox[{"\[Nu]WB", "[", "Z", "]"}], ",", 
      RowBox[{"wWB", "[", "Z", "]"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7934203605008125`*^9, 3.7934205273562417`*^9}, {
  3.7934206237410746`*^9, 3.793420673118851*^9}, {3.7934209453417645`*^9, 
  3.7934209815739045`*^9}, {3.793421105507448*^9, 3.793421254162279*^9}, {
  3.7934213790828857`*^9, 3.7934213815376406`*^9}, {3.793421430435133*^9, 
  3.7934214391139374`*^9}, {3.793421602365526*^9, 3.7934216038189588`*^9}, {
  3.7934217564576883`*^9, 3.7934217717549496`*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"547db7ed-7d8d-4358-9e97-533a1fb4ee06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TlastWB", "[", "Z_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "list", "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Z", "\[Equal]", "0"}], ",", 
        RowBox[{"list", "=", 
         RowBox[{"T03", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "M"}], "]"}], "]"}]}], ",", 
        RowBox[{"list", "=", 
         RowBox[{"withinBorder", "[", 
          RowBox[{"Z", ",", 
           RowBox[{"T03", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "M"}], "]"}], "]"}]}], "]"}]}]}], "]"}], ";",
       "list"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T03WB", "[", "Z_", "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TlastWB", "[", "Z", "]"}], ",", 
      RowBox[{"\[Nu]WB", "[", "Z", "]"}], ",", 
      RowBox[{"wWB", "[", "Z", "]"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7934216281423416`*^9, 3.79342165397176*^9}, {
  3.7934216936318593`*^9, 3.7934216941941757`*^9}, {3.793421776884795*^9, 
  3.7934217848900857`*^9}},
 CellLabel->
  "In[341]:=",ExpressionUUID->"f901dcd8-4811-43d9-b751-5b6a213a6dcc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"zRef", "[", "Z_", "]"}], ":=", 
   RowBox[{"Z", "+", 
    RowBox[{"70", "\[Times]", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RcWB", "[", "Z_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{"2", "\[Times]", 
      RowBox[{
       RowBox[{"R30WB", "[", "Z", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Times]", 
      RowBox[{
       RowBox[{"R30WB", "[", "Z", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", 
      RowBox[{
       RowBox[{"R30WB", "[", "Z", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"R30WB", "[", "Z", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TcWB", "[", "Z_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{"2", "\[Times]", 
      RowBox[{
       RowBox[{"T03WB", "[", "Z", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Times]", 
      RowBox[{
       RowBox[{"T03WB", "[", "Z", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", 
      RowBox[{
       RowBox[{"T03WB", "[", "Z", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"R30WB", "[", "Z", "]"}], "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7933444265702896`*^9, 3.793344463839075*^9}, {
   3.7933445549294634`*^9, 3.793344691744531*^9}, {3.793422113399655*^9, 
   3.7934221493994455`*^9}, {3.7934222259592752`*^9, 
   3.7934222862797265`*^9}, {3.7934223162846537`*^9, 3.793422389568899*^9}, {
   3.793422681508328*^9, 3.7934227238534374`*^9}, {3.793423235131158*^9, 
   3.793423263465829*^9}, {3.7934234157586126`*^9, 3.79342341666821*^9}, {
   3.7934236411360397`*^9, 3.793423646171985*^9}, 3.7934318152361517`*^9, 
   3.7934318692592974`*^9, {3.793433504345036*^9, 3.7934335045481586`*^9}, {
   3.7934336725854897`*^9, 3.7934336729539213`*^9}, {3.7934337124961863`*^9, 
   3.793433763552388*^9}},
 CellLabel->
  "In[343]:=",ExpressionUUID->"8f6ee1f7-a470-49c4-becc-0201c2128860"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RvsZ", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TvsZ", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "10"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"RvsZ", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "1"}], ")"}], "\[Times]", "0.004"}]}], ";", 
     RowBox[{
      RowBox[{"RvsZ", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"RcWB", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "\[Times]", "0.01"}], "]"}]}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "10"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"TvsZ", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "1"}], ")"}], "\[Times]", "0.004"}]}], ";", 
     RowBox[{
      RowBox[{"TvsZ", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"TcWB", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "\[Times]", "0.01"}], "]"}]}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7934228315974393`*^9, 3.7934228375560555`*^9}, {
   3.793423033293342*^9, 3.7934230819418283`*^9}, {3.793423165301153*^9, 
   3.7934232280750484`*^9}, {3.793423267311833*^9, 3.793423335411118*^9}, {
   3.793423386126356*^9, 3.79342342066671*^9}, {3.7934234896478987`*^9, 
   3.793423504152485*^9}, {3.793423535024831*^9, 3.793423535365308*^9}, 
   3.7934235843447065`*^9, {3.793423675137063*^9, 3.793423703987175*^9}, {
   3.79342514814142*^9, 3.7934252070239697`*^9}, {3.7934419266757097`*^9, 
   3.793441958055401*^9}, {3.7935100286809187`*^9, 3.7935100379558663`*^9}, {
   3.7935105284713063`*^9, 3.793510621052839*^9}, {3.793510722190442*^9, 
   3.7935107351959233`*^9}, {3.839129291293483*^9, 3.839129295283394*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"26fa106c-9e2f-4796-a8f8-2cf06ad66e5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphs", "Subsubsection",
 CellChangeTimes->{{3.7934546573371224`*^9, 
  3.793454662502035*^9}},ExpressionUUID->"29c56de9-efcf-4d44-93ff-\
2378ea0a2da8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"TvsZ", ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0.04"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"RvsZ", ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0.04"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.1"}], "}"}]}], "}"}]}]}], "]"}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.7934311345976324`*^9, 3.7934311483164372`*^9}, {
   3.7934312330348525`*^9, 3.7934312775663357`*^9}, {3.7934313332837863`*^9, 
   3.7934313860080094`*^9}, {3.7934314784455233`*^9, 3.793431511201785*^9}, 
   3.793540737512169*^9, {3.79354203075749*^9, 3.7935420600582333`*^9}, 
   3.8391291890636177`*^9, {3.839129266724626*^9, 3.839129267975037*^9}, {
   3.8391293392487907`*^9, 3.8391293647393436`*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"5825a620-3304-4272-b27f-9f9fe0dd506d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{{}, {
      {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], AbsoluteThickness[
       1.6], PointBox[{{0., 0.7641978516784012}, {0.004, 
        0.6555255982818884}, {0.008, 0.5427227876058693}, {0.012, 
        0.47911314269315086`}, {0.016, 0.4324998786302722}, {0.02, 
        0.40940720509919826`}, {0.024, 0.40940720509919826`}, {0.028, 
        0.38726620533779177`}, {0.032, 0.38726620533779177`}, {
        0.036000000000000004`, 0.3671879632731845}}]}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}}, {{}, {}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0, 0},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImageSize->Large,
    Method->{
     "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& )}},
    PlotRange->{{0, 0.04}, {0, 1}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.02], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}], ",", 
   GraphicsBox[{{}, {
      {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], AbsoluteThickness[
       1.6], PointBox[{{0., 0.03938036392784935}, {0.004, 
        0.016081184941328416`}, {0.008, 0.008264371392958684}, {0.012, 
        0.005422777951510243}, {0.016, 0.0037240204086397173`}, {0.02, 
        0.0028511260445323733`}, {0.024, 0.0028511260445323733`}, {0.028, 
        0.001968657139600498}, {0.032, 0.001968657139600498}, {
        0.036000000000000004`, 0.0011322362359079186`}}]}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}, {
       {RGBColor[1, 0, 0], PointSize[0.012833333333333334`], 
        AbsoluteThickness[1.6]}, {}}}, {{}, {}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0, 0},
    DisplayFunction->Identity,
    Frame->{{False, False}, {False, False}},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImageSize->Large,
    Method->{
     "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& )}},
    PlotRange->{{0, 0.04}, {0, 0.1}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.02], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7934311360251975`*^9, 3.7934311497887278`*^9}, 
   3.7934312042969265`*^9, {3.7934312516548543`*^9, 3.79343127947258*^9}, 
   3.7934313878830013`*^9, 3.793431468837*^9, {3.793431514159462*^9, 
   3.793431542993*^9}, 3.7934315849068284`*^9, 3.7934317362273254`*^9, 
   3.7934318865316944`*^9, 3.793433441744697*^9, 3.7934335339798603`*^9, 
   3.7934336905255957`*^9, 3.793433752798988*^9, 3.7934337830570173`*^9, 
   3.793434040085645*^9, 3.793434124131511*^9, 3.7934345674020543`*^9, 
   3.7934346801892643`*^9, 3.7934355531323223`*^9, 3.793439489873578*^9, 
   3.7934397225379353`*^9, 3.7934418896003604`*^9, 3.7934419694277616`*^9, 
   3.7934420276274166`*^9, 3.793442100595104*^9, 3.7934421505115843`*^9, 
   3.793442206628858*^9, 3.793442402458912*^9, 3.793442572549285*^9, 
   3.7934427726063643`*^9, 3.7934429525410137`*^9, 3.7934547247615376`*^9, 
   3.793501204016433*^9, 3.7935012710389314`*^9, 3.793501336342924*^9, 
   3.7935013904769554`*^9, 3.793501438148148*^9, 3.7935015234207635`*^9, 
   3.7935016110835676`*^9, 3.793501647471178*^9, 3.7935017118815475`*^9, 
   3.7935017836336145`*^9, 3.7935018423655224`*^9, 3.7935018860478673`*^9, 
   3.7935019327276974`*^9, 3.7935020044735394`*^9, 3.7935020576089478`*^9, 
   3.793502227201743*^9, 3.793502328210084*^9, 3.79350237643843*^9, 
   3.793502424172127*^9, 3.7935024719063373`*^9, 3.793502517084134*^9, 
   3.793503094016019*^9, 3.7935031328158646`*^9, 3.793503175979719*^9, 
   3.7935032176729517`*^9, 3.793503267647789*^9, 3.793503327243168*^9, 
   3.7935034129426103`*^9, 3.793509540212454*^9, 3.793509629144879*^9, 
   3.7935097121781273`*^9, 3.79350984280005*^9, 3.7935099169554243`*^9, 
   3.7935099712389994`*^9, 3.793510068416233*^9, 3.793510271445671*^9, 
   3.793510320406757*^9, 3.7935103768031836`*^9, 3.793510650660452*^9, 
   3.793510764807683*^9, 3.7935108674194155`*^9, 3.793510912828241*^9, 
   3.793510978383315*^9, 3.7935110370789356`*^9, 3.793540650604967*^9, 
   3.793540712594387*^9, 3.793540768508629*^9, 3.793542062188341*^9, 
   3.7935422146303434`*^9, 3.793542263048566*^9, 3.793542456938589*^9, 
   3.7935448682867546`*^9, 3.7935449711110706`*^9, 3.793545018542153*^9, 
   3.7935450613833427`*^9, 3.793545120288245*^9, 3.7935451648798866`*^9, 
   3.793545250624197*^9, 3.79354530361382*^9, 3.793545448562234*^9, 
   3.793545543278442*^9, 3.793545802820023*^9, 3.7935458714332952`*^9, {
   3.8391292405059357`*^9, 3.839129268894929*^9}, 3.8391293053524284`*^9, 
   3.8391293662799783`*^9},
 CellLabel->
  "Out[358]=",ExpressionUUID->"42409cae-06e4-473e-a159-dc188ed2602c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Rc", ",", "Tc"}], "}"}]], "Input",
 CellChangeTimes->{{3.7935014483819375`*^9, 3.793501459399087*^9}},
 CellLabel->
  "In[351]:=",ExpressionUUID->"bb4a42a6-4fe2-4b68-9c64-5237072d291a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.08444568308828544`", ",", "0.7641978516784014`"}], 
  "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwd0FsoQwEAxvGNycYDuTwdc5nSckm5LLllJs0LRlhrDy5NokxJqCVCtLHW
WmSOMazVSCFingwvKxFrK5qIRnMkGiXX83n4+vW9/pOalTUKJoPBKKDXKFpa
HBNRwvgepQ2aV1u24FX0yy7cEfzsw3rVuxM2ZFWewR/2oQf2Pcx4YemJzvf/
v3Kf4GagLWicVpXHiYDXvshYqBkMJSBv6DcRrm8sp8D8YUcnnCTIbii4YPbD
U3beAEwt7B2B7WK/BprSFqagOkht0NAW86zz8DKHbYOsarkdbuvNBzDM2u6E
JTU6NyREL8/QHBL5Dley475hR7I0YYK23ENmwLtHZT6UDXFLoMlRKYZdo5Yq
GPzadGSkvZkmjqHUEOWC8n73+Czt5+qtFo6cJ1ihPl3jItFFqriBtrLae2jP
XKMgrzU8AMnXuQ+4d1fHmqOVWN7CoJ8Tw4Uyl58PTUXyCqj2Pksglck/1xop
4R/SbO5h
  "],
 CellLabel->
  "Out[351]=",ExpressionUUID->"2a1dd097-2c02-40c5-b0a6-2109faba1643"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1350, 677},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"39f6f779-b0af-47c1-ad58-eb9a931659bb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 487, 9, 66, "Input",ExpressionUUID->"6f5f2aaf-849f-40b4-9801-882f21fbcc21"],
Cell[CellGroupData[{
Cell[1070, 33, 285, 4, 45, "Subsubsection",ExpressionUUID->"92b0c50e-816d-486f-8598-a2281b8bfd94",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[1358, 39, 242, 4, 44, "Subsubsection",ExpressionUUID->"feb54112-28b2-4372-a4d7-567b2b73faca",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[1603, 45, 3404, 48, 28, "Input",ExpressionUUID->"766192cc-a24a-4b14-950c-339d1788d7d5",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[5044, 98, 185, 3, 44, "Subsubsection",ExpressionUUID->"b703fb77-9cc4-495f-94d8-ced251e1e637"],
Cell[5232, 103, 2015, 31, 48, "Input",ExpressionUUID->"cd30718f-4cb3-4623-89d6-500c212f7d10"],
Cell[CellGroupData[{
Cell[7272, 138, 287, 5, 44, "Subsubsection",ExpressionUUID->"43238c5a-a463-482a-8b00-25b88dc62d3b",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[7562, 145, 1348, 22, 45, "Input",ExpressionUUID->"18a9c909-f4b2-417b-90ba-e68a9585b420",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[8913, 169, 250, 4, 44, "Subsubsection",ExpressionUUID->"5ab51fc1-f1bc-4ed2-9722-b1d959bc8847",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[9178, 176, 971, 20, 48, "Input",ExpressionUUID->"b4471cdf-4442-4d8e-bb6d-aa865a4f3c4a"],
Cell[CellGroupData[{
Cell[10174, 200, 241, 4, 44, "Subsubsection",ExpressionUUID->"76dfc411-73c8-4c53-91c3-9d685f7b9750",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[10418, 206, 1597, 24, 28, "Input",ExpressionUUID->"da4a993b-c97d-43fc-858f-15fa3f3e9395",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[12018, 232, 247, 4, 44, "Subsubsection",ExpressionUUID->"6fd6839e-762e-4b32-8b6f-0ab55ea54ef3",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[12268, 238, 1689, 26, 48, "Input",ExpressionUUID->"30f4d8c6-99f0-4047-8609-51bcc1c011ec",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[13960, 266, 309, 5, 53, "Subsection",ExpressionUUID->"d1305e0d-34f8-4039-ba5f-75caacbd4f6d",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[14272, 273, 294, 5, 44, "Subsubsection",ExpressionUUID->"1f97a13f-3eed-4679-afdc-d033ab37e989",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[14569, 280, 595, 14, 65, "Input",ExpressionUUID->"7551c83b-a9ce-410f-aea4-643407c4e68d",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15213, 300, 206, 3, 45, "Subsubsection",ExpressionUUID->"82757b19-5e59-4724-be9d-98d2a09e4e9d"],
Cell[CellGroupData[{
Cell[15444, 307, 312, 5, 39, "Text",ExpressionUUID->"64950369-9234-46d2-8d0b-d62f1f78462e",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[15759, 314, 880, 16, 61, "Input",ExpressionUUID->"1d296f1a-0450-40f4-9de6-27ccbb3cac14",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[16676, 335, 272, 4, 39, "Text",ExpressionUUID->"b6814494-9775-49a1-924b-9aa62dd285b3",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[16951, 341, 604, 12, 45, "Input",ExpressionUUID->"7b322555-8b51-40d4-b586-82be34ada4a8",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[17592, 358, 597, 14, 39, "Text",ExpressionUUID->"5c40e921-514d-435d-bc33-eb347f22e195",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}],
Cell[18192, 374, 929, 24, 119, "Input",ExpressionUUID->"7f1e9773-aae5-439a-85aa-8344109f4704",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[19158, 403, 602, 14, 39, "Text",ExpressionUUID->"f0a480cc-3598-4550-aa07-d54e7c9f7933",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}],
Cell[19763, 419, 682, 16, 45, "Input",ExpressionUUID->"a9e61377-61b1-4eb4-bdea-ee8fa4e034e7",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}],
Cell[20448, 437, 782, 21, 53, "Input",ExpressionUUID->"eee6f8b2-e5e6-4918-860a-b7692e95a7a5",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}],
Cell[21233, 460, 482, 14, 59, "Input",ExpressionUUID->"bd86100b-4ecb-4909-b177-d84e6067fc95",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}],
Cell[21718, 476, 1188, 27, 45, "Input",ExpressionUUID->"eb02bb72-e600-470b-a543-025ca6575fa2",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}],
Cell[22909, 505, 1223, 29, 62, "Input",ExpressionUUID->"97cab9e4-1480-47c9-87fa-ba90b2480f67",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}],
Cell[24135, 536, 1718, 44, 73, "Input",ExpressionUUID->"86ad4d2b-da2a-48ef-8c62-d25d38cbb6fc",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25902, 586, 186, 3, 44, "Subsubsection",ExpressionUUID->"6d676648-0a5f-42a7-82a9-3beb486af15f"],
Cell[26091, 591, 912, 22, 119, "Input",ExpressionUUID->"474c287c-a463-4b76-ae4a-0b8da2a0d0b5"],
Cell[27006, 615, 914, 27, 99, "Input",ExpressionUUID->"093003ba-e954-461d-8251-f0c278257308"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27957, 647, 176, 3, 53, "Subsection",ExpressionUUID->"2e1d05fe-9911-4357-ad33-4da1f4e74b48"],
Cell[CellGroupData[{
Cell[28158, 654, 170, 3, 44, "Subsubsection",ExpressionUUID->"4b739b34-9696-4586-8ae2-06cf3fbf688a"],
Cell[CellGroupData[{
Cell[28353, 661, 406, 11, 32, "Input",ExpressionUUID->"8555ab06-86b6-4260-bcf5-d8a5b02349ae"],
Cell[28762, 674, 9366, 129, 32, "Output",ExpressionUUID->"22d6b334-3ec3-4db6-a328-65281e4bcfdc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38165, 808, 476, 13, 52, "Input",ExpressionUUID->"d33108f5-3568-4245-b8b1-acc76eb5de41"],
Cell[38644, 823, 9396, 129, 32, "Output",ExpressionUUID->"4d8f9fcc-97f1-46ce-bce0-133c40986dbd"]
}, Open  ]],
Cell[48055, 955, 470, 13, 34, "Text",ExpressionUUID->"4eafe6d7-3b50-46e7-b9c5-86abcc5ea60f"],
Cell[48528, 970, 535, 14, 34, "Text",ExpressionUUID->"1d8b826c-ecd2-4a8f-ae32-c973e3349dd2"],
Cell[CellGroupData[{
Cell[49088, 988, 883, 20, 82, "Input",ExpressionUUID->"a3c24bba-99ce-4dc2-82ac-ca30a8ed27b8"],
Cell[49974, 1010, 6033, 83, 32, "Output",ExpressionUUID->"58faf78b-ed0d-497a-9bf8-0809cd0cfad5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56044, 1098, 398, 9, 47, "Input",ExpressionUUID->"a9972f3f-970f-4833-94e8-461ef8a5ab72"],
Cell[56445, 1109, 9275, 128, 32, "Output",ExpressionUUID->"f770910c-13ba-4b91-bea0-d8f89737ba63"]
}, Open  ]],
Cell[65735, 1240, 488, 11, 48, "Input",ExpressionUUID->"32f1152b-d38c-45ad-911e-246b2497407b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66260, 1256, 212, 4, 39, "Subsubsection",ExpressionUUID->"12b7da6d-23db-46f5-be84-3662aea470a8"],
Cell[66475, 1262, 629, 18, 53, "Input",ExpressionUUID->"fc062a8b-aebf-4209-bbe7-83e755f3474e"],
Cell[67107, 1282, 4150, 97, 215, "Input",ExpressionUUID->"88721a6e-def1-4adf-a288-721af8484f7a"],
Cell[71260, 1381, 5934, 149, 381, "Input",ExpressionUUID->"8bcc470b-0f66-44d6-a219-7ff3048af32f"],
Cell[77197, 1532, 881, 16, 28, "Input",ExpressionUUID->"aadfea92-2bb1-422e-b6a4-51c5064e788c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78115, 1553, 206, 3, 45, "Subsubsection",ExpressionUUID->"d42648fc-b92b-4531-872e-6203130f086e"],
Cell[78324, 1558, 415, 8, 45, "Input",ExpressionUUID->"3a18b977-f8f9-4f70-8221-41ceaf80c35f"],
Cell[78742, 1568, 1621, 34, 65, "Input",ExpressionUUID->"a75d48d3-6637-458b-b461-750f5955021f"],
Cell[80366, 1604, 1650, 39, 65, "Input",ExpressionUUID->"91b0eff1-45c7-452f-b42a-b584f126cdda"],
Cell[82019, 1645, 334, 8, 45, "Input",ExpressionUUID->"4bf3411b-054f-4958-a74f-9e5ead54d106"],
Cell[82356, 1655, 579, 12, 45, "Input",ExpressionUUID->"cb13e540-ee04-45b8-b2d1-da5df13f8509"],
Cell[82938, 1669, 525, 11, 28, "Input",ExpressionUUID->"eeb042be-e405-473d-8b15-99edead1b517"],
Cell[83466, 1682, 414, 9, 28, "Input",ExpressionUUID->"344dd9a4-e4dc-4459-93a9-a557591ad1b4"],
Cell[83883, 1693, 480, 10, 28, "Input",ExpressionUUID->"6812acf9-8c68-4df0-a44e-0abc50c82ff7"],
Cell[84366, 1705, 192, 5, 28, "Input",ExpressionUUID->"739e61b7-5477-45e3-bfeb-8155697d4a65"],
Cell[84561, 1712, 1467, 37, 124, "Input",ExpressionUUID->"44e9553c-a99a-44c4-b75a-57cf3bf0b0aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86065, 1754, 196, 3, 44, "Subsubsection",ExpressionUUID->"5e1e9729-6b85-4dda-8e0c-88cfb39ac8d7"],
Cell[86264, 1759, 785, 15, 100, "Input",ExpressionUUID->"3518bb08-ad77-4f62-a56b-4b42d092102f"],
Cell[87052, 1776, 200, 3, 34, "Text",ExpressionUUID->"910672a9-4d05-4313-b7f4-ec8f697fa4bf"],
Cell[87255, 1781, 1178, 28, 156, "Input",ExpressionUUID->"ec605d8d-1b1e-4bb1-b826-7d3dd81f5e76"],
Cell[88436, 1811, 3898, 96, 289, "Input",ExpressionUUID->"04aaacab-d426-4a84-ade7-22237715fd7d"],
Cell[92337, 1909, 178, 3, 34, "Text",ExpressionUUID->"c9c07807-b40d-4da0-9a94-988b06ce54e4"],
Cell[92518, 1914, 1084, 28, 161, "Input",ExpressionUUID->"92e986c4-b517-4e2c-8ba3-6ef140bc5dba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93639, 1947, 195, 3, 44, "Subsubsection",ExpressionUUID->"b8e394a2-371d-4e96-8f4a-56ced7deb91c"],
Cell[93837, 1952, 6612, 155, 322, "Input",ExpressionUUID->"62ff3788-f0c9-48a7-9179-51265b5a4217"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100486, 2112, 184, 3, 44, "Subsubsection",ExpressionUUID->"61b66a86-cf7d-49d0-b0f5-2ca967abdc7e"],
Cell[100673, 2117, 1104, 26, 82, "Input",ExpressionUUID->"92d11ed0-3ed1-4945-8bc7-158dfcf3d646"],
Cell[101780, 2145, 1418, 39, 141, "Input",ExpressionUUID->"29b9d6c4-3052-4377-b623-73e54a44151c"],
Cell[CellGroupData[{
Cell[103223, 2188, 1035, 21, 82, "Input",ExpressionUUID->"d0224b80-801f-4d4e-9b2e-9af9073ab7e1"],
Cell[104261, 2211, 6933, 97, 32, "Output",ExpressionUUID->"470da297-dfbc-4e75-9c38-76ad6bcd6845"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[111243, 2314, 183, 3, 44, "Subsubsection",ExpressionUUID->"3d4ee816-0719-4d81-9bc8-10e55f6e11db"],
Cell[111429, 2319, 2179, 54, 158, "Input",ExpressionUUID->"121fff92-c6fc-40ea-bc54-e9cb3e095a94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113645, 2378, 191, 3, 44, "Subsubsection",ExpressionUUID->"9d7a1303-a4ef-4e63-a5a1-5b0d2729d46d"],
Cell[113839, 2383, 2459, 68, 156, "Input",ExpressionUUID->"547db7ed-7d8d-4358-9e97-533a1fb4ee06"],
Cell[116301, 2453, 1253, 35, 82, "Input",ExpressionUUID->"f901dcd8-4811-43d9-b751-5b6a213a6dcc"],
Cell[117557, 2490, 2507, 65, 101, "Input",ExpressionUUID->"8f6ee1f7-a470-49c4-becc-0201c2128860"],
Cell[120067, 2557, 2627, 72, 177, "Input",ExpressionUUID->"26fa106c-9e2f-4796-a8f8-2cf06ad66e5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122731, 2634, 159, 3, 44, "Subsubsection",ExpressionUUID->"29c56de9-efcf-4d44-93ff-2378ea0a2da8"],
Cell[CellGroupData[{
Cell[122915, 2641, 1445, 37, 82, "Input",ExpressionUUID->"5825a620-3304-4272-b27f-9f9fe0dd506d"],
Cell[124363, 2680, 6094, 125, 401, "Output",ExpressionUUID->"42409cae-06e4-473e-a159-dc188ed2602c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130494, 2810, 225, 5, 28, "Input",ExpressionUUID->"bb4a42a6-4fe2-4b68-9c64-5237072d291a"],
Cell[130722, 2817, 736, 16, 32, "Output",ExpressionUUID->"2a1dd097-2c02-40c5-b0a6-2109faba1643"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

