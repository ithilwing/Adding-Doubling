(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    199471,       4648]
NotebookOptionsPosition[    181885,       4378]
NotebookOutlinePosition[    182285,       4394]
CellTagsIndexPosition[    182242,       4391]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.8096594484581027`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"20f709a7-7a41-4259-b3c2-467ca2c47923"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearSystemCache", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "NumericalDifferentialEquationAnalysis`"}]}], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"d81f1174-77ce-4fe7-b596-1f00bd956dc7"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Optical properties", "Subsection"]], "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7882492235523186`*^9, 3.788249230040389*^9}, 
   3.7882494315821295`*^9},ExpressionUUID->"d519455e-0b36-4280-9190-\
f215ccc3f881"],

Cell["Matrix size", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788249272833284*^9, 3.7882492804487057`*^9}, 
   3.788249431583129*^9},ExpressionUUID->"694beab7-4b88-415a-920b-\
82b7893d9c7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", "32"}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7882492974266653`*^9, 3.7882493114299326`*^9}, 
   3.7882494315881195`*^9, {3.7882507672942066`*^9, 3.7882507677631674`*^9}, {
   3.7882509407364583`*^9, 3.788250940835305*^9}, {3.79161628446688*^9, 
   3.7916162867169547`*^9}, {3.791616388200457*^9, 3.7916163886692066`*^9}, {
   3.7916164978717804`*^9, 3.7916164981687217`*^9}, {3.791616637822033*^9, 
   3.791616638165818*^9}, {3.791778451047606*^9, 3.791778451614038*^9}, {
   3.791778521530567*^9, 3.7917785224763684`*^9}, 3.792217232294221*^9, 
   3.792218131763231*^9, {3.792218486410858*^9, 3.7922184866019974`*^9}, 
   3.792219503655507*^9, {3.792221840139164*^9, 3.792221852672881*^9}, {
   3.7922221921047773`*^9, 3.7922221922598877`*^9}, {3.7922238765457106`*^9, 
   3.7922238790809326`*^9}, 3.7922242117875347`*^9, {3.7922248556250424`*^9, 
   3.7922248556951027`*^9}, {3.792225237380481*^9, 3.7922252374225035`*^9}, {
   3.7922253636886444`*^9, 3.792225406569166*^9}, {3.792225647461534*^9, 
   3.7922256681235847`*^9}, {3.792225859916937*^9, 3.792225859966972*^9}, {
   3.792225978582167*^9, 3.792225984585209*^9}, {3.7922272796021996`*^9, 
   3.7922272796490736`*^9}, {3.7922273589370527`*^9, 3.792227359043871*^9}, {
   3.7922273943826723`*^9, 3.7922273944451733`*^9}, 3.792227428974539*^9, 
   3.7922274602286077`*^9, {3.79222766510894*^9, 3.7922276665962996`*^9}, {
   3.7922283241271434`*^9, 3.792228324240224*^9}, {3.7922284458576365`*^9, 
   3.7922284468916626`*^9}, {3.792229019666634*^9, 3.7922290197135105`*^9}, {
   3.792376398570703*^9, 3.792376399414261*^9}, {3.7923767793758593`*^9, 
   3.792376780606015*^9}, {3.792378720675173*^9, 3.792378721489737*^9}, {
   3.7923795235982127`*^9, 3.7923795256878366`*^9}, {3.7923810109408817`*^9, 
   3.7923810124616275`*^9}, {3.7923818580914097`*^9, 3.792381859652986*^9}, {
   3.7923819427735558`*^9, 3.7923819439042683`*^9}, {3.792385997472746*^9, 
   3.7923859986924877`*^9}, {3.7923881018146257`*^9, 3.792388102142754*^9}, {
   3.7925070742991123`*^9, 3.792507075611354*^9}, {3.7925152639267426`*^9, 
   3.792515264648087*^9}, {3.7925158585159616`*^9, 3.792515859534878*^9}, {
   3.792516569341157*^9, 3.7925165708429227`*^9}, {3.7925180838847976`*^9, 
   3.7925180851732597`*^9}, 3.792519320388919*^9, 3.792520015305013*^9, {
   3.7925200490877714`*^9, 3.792520051724842*^9}, {3.7925203772194166`*^9, 
   3.7925203791025257`*^9}, {3.7928093895262985`*^9, 3.7928093897763*^9}, {
   3.7928096531335473`*^9, 3.7928096599773903`*^9}, {3.79281290030449*^9, 
   3.7928129004763813`*^9}, {3.7928129998683825`*^9, 
   3.7928130000871353`*^9}, {3.792813078512721*^9, 3.7928130789346004`*^9}, {
   3.792813344475713*^9, 3.7928133445694747`*^9}, {3.7928139811440215`*^9, 
   3.7928139813940396`*^9}, {3.7928140637419825`*^9, 
   3.7928140638044844`*^9}, {3.7928154656570807`*^9, 3.792815486126114*^9}, {
   3.7928156221153746`*^9, 3.7928156246310215`*^9}, {3.792816049735512*^9, 
   3.7928160497823887`*^9}, {3.7928171895544186`*^9, 3.792817189835673*^9}, {
   3.7928272450947514`*^9, 3.7928272451885033`*^9}, {3.793259559017295*^9, 
   3.7932595596266623`*^9}, {3.793259717199313*^9, 3.7932597174493103`*^9}, {
   3.7933293971245117`*^9, 3.7933293976558485`*^9}, {3.793329572213284*^9, 
   3.7933295725882635`*^9}, 3.7933348003736167`*^9, {3.7935992870645957`*^9, 
   3.7935992878254013`*^9}, {3.7936289263733587`*^9, 
   3.7936289354467516`*^9}, {3.794147830368*^9, 3.7941478343517485`*^9}, {
   3.794147898436141*^9, 3.794147924739846*^9}, {3.794148189384389*^9, 
   3.7941481915659666`*^9}, {3.7941483510066624`*^9, 3.794148351441984*^9}, {
   3.7942082099176545`*^9, 3.7942082102301455`*^9}, {3.7942088823491955`*^9, 
   3.794208882633304*^9}, {3.794209185440916*^9, 3.794209227869113*^9}, {
   3.794209279469172*^9, 3.7942092798285427`*^9}, {3.7942098488764524`*^9, 
   3.7942098494858065`*^9}, {3.7942099152519865`*^9, 
   3.7942099161581984`*^9}, {3.794209991100038*^9, 3.794209992037265*^9}, {
   3.7942100557694345`*^9, 3.7942100566600323`*^9}, 3.794210847573761*^9, {
   3.7942139732268105`*^9, 3.7942139744978104`*^9}, {3.8086249005270615`*^9, 
   3.8086249161701255`*^9}, {3.8086286671783066`*^9, 
   3.8086286685471916`*^9}, {3.8086293392734795`*^9, 
   3.8086293404789343`*^9}, {3.808642894163748*^9, 3.808642894547577*^9}, {
   3.8087173057350454`*^9, 3.8087173064340053`*^9}, {3.809056418138497*^9, 
   3.8090564185049667`*^9}, {3.8090565420963173`*^9, 
   3.8090565449096813`*^9}, {3.8090574056339254`*^9, 3.809057407203876*^9}, {
   3.809069197248249*^9, 3.809069198845011*^9}, {3.8090694619525566`*^9, 
   3.8090694639693594`*^9}, {3.809069996941017*^9, 3.8090699971475472`*^9}, {
   3.8096625521762457`*^9, 3.8096625525771084`*^9}, {3.809663017554516*^9, 
   3.809663017739661*^9}, {3.8096795318376837`*^9, 3.8096795334873905`*^9}, {
   3.8096798339004297`*^9, 3.809679835322435*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"6887370b-353b-497e-9c6f-276c7187256e"],

Cell["Albedo", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7882493158362083`*^9, 3.788249320887768*^9}, 
   3.788249431589119*^9, 3.7922195354679766`*^9, 
   3.792815490673053*^9},ExpressionUUID->"eb9c8c74-393e-4861-b6ca-\
e62bd5cdde48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "=", "0.9"}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7882493237764597`*^9, 3.788249326489238*^9}, 
   3.78824943159611*^9, {3.79126596003623*^9, 3.7912659603391027`*^9}, {
   3.791268549928115*^9, 3.791268550312147*^9}, {3.7912698296705055`*^9, 
   3.791269829939379*^9}, {3.791270944557312*^9, 3.7912709449573536`*^9}, {
   3.791388525354162*^9, 3.7913885259828215`*^9}, {3.79177761457381*^9, 
   3.7917776148037868`*^9}, {3.7933405300537424`*^9, 
   3.7933405304442406`*^9}, {3.793599319925597*^9, 3.7935993202780356`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"671145ce-ea1d-417e-ac85-f6d9e5c5c13b"],

Cell["Optical thickness", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7882493292392197`*^9, 3.7882493589429708`*^9}, 
   3.788249431597108*^9},ExpressionUUID->"52bec5da-a39c-49d7-8e97-\
8193123fbf6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Tau]", "=", "1.0"}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788249363520791*^9, 3.7882493680987797`*^9}, 
   3.7882494316021*^9, {3.791263105278714*^9, 3.791263110885676*^9}, {
   3.7912643846881294`*^9, 3.7912643865176134`*^9}, {3.7912711291441145`*^9, 
   3.791271129582285*^9}, {3.7917776171536393`*^9, 3.7917776176137776`*^9}, {
   3.792217202516688*^9, 3.7922172038996735`*^9}, {3.793330356662778*^9, 
   3.793330358147069*^9}, {3.793599317350639*^9, 3.793599317703084*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"b57f65c9-4f1c-4730-a8f6-f08325246818"],

Cell["Anisotropy", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788249371279792*^9, 3.788249376697728*^9}, 
   3.7882494316030984`*^9},ExpressionUUID->"c58a06f3-61f7-46dc-b2ea-\
83036280b69a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "=", "0.9"}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788249379239214*^9, 3.788249384177027*^9}, 
   3.788249431609087*^9, {3.791263580478447*^9, 3.7912635813373423`*^9}, {
   3.7912657805109777`*^9, 3.7912657808911085`*^9}, {3.791265912069148*^9, 
   3.7912659144652195`*^9}, {3.791268502372403*^9, 3.791268502605404*^9}, {
   3.7912685847991076`*^9, 3.791268584899171*^9}, {3.7913885303420506`*^9, 
   3.7913885313861856`*^9}, {3.7933294436209*^9, 3.793329443949132*^9}, {
   3.793340533574981*^9, 3.793340534043525*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"000d24e0-33fa-469e-885f-d9c1550a993a"],

Cell["Refractive index", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788249387614379*^9, 3.788249399438468*^9}, 
   3.7882494316100883`*^9},ExpressionUUID->"69f71f7b-9a00-4452-9043-\
7455380949c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "1.4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nglass", "=", "1.56"}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.78824941739543*^9, 3.788249431616077*^9}, {
   3.791263157971749*^9, 3.791263158673581*^9}, {3.791263691639995*^9, 
   3.7912636927291136`*^9}, {3.791264418767206*^9, 3.7912644448252068`*^9}, {
   3.791266436734633*^9, 3.791266437072504*^9}, {3.7912665411163874`*^9, 
   3.7912665414962296`*^9}, {3.7912675326778107`*^9, 3.791267560884816*^9}, {
   3.791268524546917*^9, 3.7912685264571395`*^9}, {3.791270605536208*^9, 
   3.7912706059764833`*^9}, {3.7912707157300014`*^9, 3.79127071606889*^9}, {
   3.7912709828889313`*^9, 3.791270983268548*^9}, {3.7912711003362985`*^9, 
   3.7912711016530533`*^9}, {3.7913884081267023`*^9, 
   3.7913884103634295`*^9}, {3.791777619634225*^9, 3.79177761988404*^9}, {
   3.7922257503613124`*^9, 3.7922257539853415`*^9}, {3.7932576309177866`*^9, 
   3.7932576314881926`*^9}, {3.7932580186018543`*^9, 
   3.7932580189456015`*^9}, {3.793259695299878*^9, 3.7932597127390633`*^9}, 
   3.7932597519243417`*^9, {3.793259843648035*^9, 3.793259844085246*^9}, {
   3.7932603669835925`*^9, 3.7932603725515504`*^9}, {3.7932608426960096`*^9, 
   3.793260845492869*^9}, {3.793329405391159*^9, 3.7933294366598396`*^9}, {
   3.793334780940632*^9, 3.793334782113414*^9}, {3.7933348397269135`*^9, 
   3.7933348400861993`*^9}, {3.7933406986298866`*^9, 3.793340705635358*^9}, {
   3.7941468704953194`*^9, 3.7941468728116813`*^9}, {3.79414778776488*^9, 
   3.7941477878697166`*^9}, {3.794147940685815*^9, 3.794147940891491*^9}, {
   3.794148184730694*^9, 3.7941482128375707`*^9}, {3.7942082260421157`*^9, 
   3.794208229854492*^9}, {3.794360760750176*^9, 3.7943607643750706`*^9}, {
   3.808707023005836*^9, 3.808707026531395*^9}, {3.808713166188828*^9, 
   3.808713167462*^9}, {3.8087132914489307`*^9, 3.808713292124015*^9}, {
   3.8090564230528774`*^9, 3.8090564232565527`*^9}, 3.809076606224815*^9, 
   3.8096605929282722`*^9, {3.8096808160997424`*^9, 3.8096808188856916`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"8b5011b4-377b-4e96-ad7d-7202c6962194"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integrating spheres properties", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.791784612919685*^9, 3.7917846463998384`*^9}, {
   3.79220601838492*^9, 3.792206028994266*^9}, 3.7923819286870813`*^9, 
   3.809659935500543*^9},ExpressionUUID->"0eed2f7b-bbc1-4993-ab8a-\
2601271871f9"],

Cell["Distance from spheres to tissue", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.7917848806086817`*^9, 3.7917849041893115`*^9}, {
   3.7922126541416006`*^9, 3.7922126553919573`*^9}, 3.7923819286870813`*^9, 
   3.809659935503542*^9},ExpressionUUID->"1c705d03-6123-43e2-bf7f-\
07fe5da1da67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{"3.5", "\[Times]", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.7917849093295517`*^9, 3.791784928523388*^9}, {
   3.7917857158824873`*^9, 3.791785716468306*^9}, {3.7922057280572667`*^9, 
   3.79220572849479*^9}, {3.7922129559994307`*^9, 3.792212956312235*^9}, 
   3.7922160243053274`*^9, {3.7922165186297703`*^9, 3.7922165273794947`*^9}, {
   3.7922881074658327`*^9, 3.7922881078097553`*^9}, {3.792380227689103*^9, 
   3.792380228269204*^9}, 3.7923819286870813`*^9, 3.792386411387823*^9, {
   3.793077403888068*^9, 3.793077432587318*^9}, {3.793254385785835*^9, 
   3.7932543861295805`*^9}, {3.79325502293754*^9, 3.793255023250038*^9}, {
   3.793340954920052*^9, 3.7933409552743416`*^9}, {3.7933421993658257`*^9, 
   3.79334220129585*^9}, {3.7933435954513416`*^9, 3.793343595815168*^9}, {
   3.793343703728532*^9, 3.793343704448203*^9}, {3.7933438580506697`*^9, 
   3.793343859084279*^9}, {3.7933449521782837`*^9, 3.793344953678407*^9}, {
   3.7933450075267797`*^9, 3.7933450080423174`*^9}, {3.7933450842057085`*^9, 
   3.793345084690409*^9}, {3.7933452033261647`*^9, 3.7933452037086186`*^9}, {
   3.7933452467374463`*^9, 3.793345249491028*^9}, {3.7933453024155874`*^9, 
   3.7933453029468837`*^9}, {3.7933453682126503`*^9, 
   3.7933453690251055`*^9}, {3.7933454447227726`*^9, 3.793345445050722*^9}, {
   3.793345544759312*^9, 3.7933455450876913`*^9}, {3.7933456230534897`*^9, 
   3.79334562360001*^9}, {3.7933456952826385`*^9, 3.79334569561611*^9}, {
   3.793345745512395*^9, 3.793345746668703*^9}, {3.79334595628125*^9, 
   3.7933459564530144`*^9}, {3.79334608545794*^9, 3.793346085684119*^9}, {
   3.793346205481452*^9, 3.793346205793844*^9}, {3.793346260720298*^9, 
   3.793346261022385*^9}, {3.793422408372247*^9, 3.7934224094792767`*^9}, 
   3.8096599355045395`*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"f8c1d41d-f3f2-4e31-ad2e-16c201f2e87f"],

Cell["Sphere diameter", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.791784945540883*^9, 3.79178496382406*^9}, {
   3.79221266901689*^9, 3.792212674594825*^9}, 3.7923819286870813`*^9, 
   3.809659935505536*^9},ExpressionUUID->"25bad7e0-f952-4ff3-a214-\
1f7d9a807834"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"7.", "\[Times]", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   FractionBox["d", "2"]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.7917849701913743`*^9, 3.7917850074328775`*^9}, {
   3.792212682063333*^9, 3.7922127011884437`*^9}, {3.792213781465571*^9, 
   3.792213785825307*^9}, 3.792381928696779*^9, 3.7923864127503915`*^9, 
   3.8096599355065346`*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"72add1d9-dec3-45a2-af8d-f4470ee1a451"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Quadrature angles", "Subsection"]], "Subsubsection",
 CellChangeTimes->{{3.7881644549031124`*^9, 
  3.7881644648824396`*^9}},ExpressionUUID->"6eb33064-2449-4e72-9988-\
7a7c448cfe26"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Total internal reflection", "Subsubsection"]], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.788164474115938*^9, 3.7881644831257877`*^9}, {
  3.7882488215383577`*^9, 
  3.788248830629718*^9}},ExpressionUUID->"4c76fbee-94ee-4a17-9c50-\
927af131001a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", " ", "[", "n_", "]"}], "=", " ", 
   RowBox[{"ArcSin", "[", 
    FractionBox["1.0", "n"], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7881644887050257`*^9, 3.788164576654011*^9}, {
   3.788164641362387*^9, 3.7881646473330097`*^9}, {3.78816486663192*^9, 
   3.788164868089631*^9}, 3.7881649959182477`*^9, {3.788165045225385*^9, 
   3.788165071280407*^9}, {3.7881651278216085`*^9, 3.7881651286143646`*^9}, {
   3.7881652713042994`*^9, 3.7881652738293343`*^9}, 3.788165423531876*^9, 
   3.7881655798395047`*^9, 3.788170014378603*^9, 3.788248830645343*^9, {
   3.7922172104263544`*^9, 3.7922172161270046`*^9}, 3.7922250865645423`*^9, 
   3.792226213168763*^9, 3.7922262532159815`*^9, {3.793261050690884*^9, 
   3.793261074288829*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"781199c4-9943-4ca8-9466-7fbd8374e988"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Critical cosine", "Subsubsection"]], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.788165507786314*^9, 3.788165512272663*^9}, 
   3.788248855832712*^9},ExpressionUUID->"dd0c4002-330a-44db-9839-\
bb3573db72f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Nu]c", "[", "n_", "]"}], "=", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]", "[", "n", "]"}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.7881655168469777`*^9, 3.788165553213174*^9}, {
   3.7881700233225718`*^9, 3.7881700311888175`*^9}, 3.7882488558483377`*^9, {
   3.7917780079782557`*^9, 3.7917780095766544`*^9}, 3.792225115018084*^9, {
   3.792226215434409*^9, 3.792226217090673*^9}, 3.7922262541847544`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"2cd351c7-0ae9-4755-b624-1a682e2507c2"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Gauss ", "Subsubsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", "<", "\[Theta]", "<", 
     SubscriptBox["\[Nu]", "c"]}]}], TraditionalForm]], "Subsubsection",
  ExpressionUUID->"bb28a658-b91a-451c-ab31-043f59df28b3"], "Subsubsection"],
 StyleBox[")", "Subsubsection"]
}], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 CellChangeTimes->{{3.7881661305501103`*^9, 3.788166196956831*^9}, 
   3.788249036050741*^9, {3.792377788655436*^9, 
   3.7923777938073263`*^9}},ExpressionUUID->"70bb1b81-275c-4231-83be-\
efc3b67e834f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gauss", "=", 
   RowBox[{"GaussianQuadratureWeights", "[", 
    RowBox[{
     FractionBox["M", "2"], ",", "0", ",", 
     RowBox[{"\[Nu]c", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Nu]Gauss", "=", 
   RowBox[{"gauss", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wGauss", "=", 
   RowBox[{"gauss", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7923776401733937`*^9, 3.792377722542237*^9}, {
  3.7923778800033913`*^9, 3.7923778825999393`*^9}, {3.79237852761187*^9, 
  3.7923785301436124`*^9}, {3.792386322398625*^9, 3.792386336997478*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"8a85041f-b93e-4184-bac0-1a41abb2717b"],

Cell[TextData[{
 StyleBox["Radau (", "Subsubsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "c"], "<", "\[Theta]", "<", "1"}], 
   TraditionalForm]], "Subsubsection",ExpressionUUID->
  "817c2798-b2c6-4c70-b328-6fe4eee1f28e"], "Subsubsection"],
 StyleBox[")", "Subsubsection"]
}], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.7882347893125086`*^9, 3.788234839945238*^9}, 
   3.788249099278945*^9, 3.79221759625134*^9, {3.792377776994574*^9, 
   3.7923777807149544`*^9}},ExpressionUUID->"05729207-cd82-46b3-a584-\
87d45f92b060"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cachedLegendreP", "[", 
    RowBox[{"k_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"cachedLegendreP", "[", 
     RowBox[{"k", ",", "x"}], "]"}], "=", 
    RowBox[{"LegendreP", "[", 
     RowBox[{"k", ",", "x"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7923838100376797`*^9, 3.792383928201789*^9}, {
  3.7923848725050774`*^9, 3.7923849015828223`*^9}, {3.792385500237054*^9, 
  3.792385502466875*^9}, {3.7923864513869996`*^9, 3.7923864936818824`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"9afad9d4-89a5-407c-bd46-263b21bf4d22"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Radau", "[", 
    RowBox[{"x_", ",", "m_"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"cachedLegendreP", "[", 
      RowBox[{
       RowBox[{
        FractionBox["m", "2"], "-", "1"}], ",", "x"}], "]"}], "+", 
     RowBox[{"cachedLegendreP", "[", 
      RowBox[{
       FractionBox["m", "2"], ",", "x"}], "]"}]}], 
    RowBox[{"1", "+", "x"}]]}], ";"}]], "Input",
 CellChangeTimes->{
  3.7923821879794292`*^9, {3.79238224622279*^9, 3.792382273023822*^9}, {
   3.7923842476993127`*^9, 3.7923842508890047`*^9}, {3.7923864776051755`*^9, 
   3.792386479355192*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"814b11b5-8dea-44a0-9488-87bad1bd3c22"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Der", "[", 
    RowBox[{"x_", ",", "m_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"cachedLegendreP", "[", 
      RowBox[{
       FractionBox["m", "2"], ",", "x"}], "]"}], ",", "x"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.792386491016801*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"d68c6c8f-bc26-49a4-8f5b-1d60ee3bbdcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RadauRoots", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"N", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "/.", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Radau", "[", 
               RowBox[{"x", ",", "M"}], "]"}], "\[Equal]", "0"}], ",", "x"}], 
            "]"}]}], ",", " ", 
          RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], "]"}], ",", "Greater"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7922256083070583`*^9, 3.7922256302834888`*^9}, {
   3.792225700045373*^9, 3.792225701824628*^9}, {3.7922263982798834`*^9, 
   3.7922264001080246`*^9}, {3.7922277155112953`*^9, 3.792227717544365*^9}, {
   3.7923823621680145`*^9, 3.792382364992412*^9}, {3.7923825075818367`*^9, 
   3.792382515489661*^9}, {3.79238263442544*^9, 3.7923826376519313`*^9}, 
   3.792382821520829*^9, {3.792382916105735*^9, 3.792382934576746*^9}, {
   3.7923863091845837`*^9, 3.792386310600319*^9}, {3.794208188230876*^9, 
   3.7942081914651403`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"68fbd410-2ef5-4111-9dc9-3f7ec8263816"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Nu]Radau", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "+", 
         RowBox[{"\[Nu]c", "[", "n", "]"}]}], "2"], "-", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Nu]c", "[", "n", "]"}]}], ")"}], "2"], "\[Times]", 
        RowBox[{"RadauRoots", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       FractionBox["M", "2"]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7922184590958605`*^9, 3.7922184766467276`*^9}, {
   3.7922185310568633`*^9, 3.7922185501673527`*^9}, {3.792218598692461*^9, 
   3.7922186038200016`*^9}, 3.7922190406029315`*^9, {3.792219588356983*^9, 
   3.79221958900144*^9}, {3.792220511169597*^9, 3.792220512833784*^9}, {
   3.792221669749051*^9, 3.792221669880143*^9}, {3.7922217380071936`*^9, 
   3.7922217402437744`*^9}, 3.7922260350542583`*^9, 3.7922261194394007`*^9, 
   3.7942106597532187`*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"a2b54de5-ac9b-4bb5-9799-af9e3eebd685"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wRadau", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"\[Nu]c", "[", "n", "]"}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"RadauRoots", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Der", "[", 
             RowBox[{
              RowBox[{"RadauRoots", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"M", "-", "2"}]}], "]"}], ")"}], "2"]}]], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{
           FractionBox["M", "2"], "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox[
        RowBox[{"1", "-", 
         RowBox[{"\[Nu]c", "[", "n", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["M", "2"], ")"}], "2"]], "}"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7922188220702376`*^9, 3.7922188781523447`*^9}, {
   3.7922189462699366`*^9, 3.792218978430025*^9}, 3.792219042339158*^9, {
   3.7922195100520253`*^9, 3.792219518118723*^9}, {3.792220517939391*^9, 
   3.7922205198487377`*^9}, {3.7922216654920425`*^9, 
   3.7922216656531672`*^9}, {3.7922260410962152`*^9, 
   3.7922260445332465`*^9}, {3.792227720387965*^9, 3.7922277438531284`*^9}, {
   3.792227826725137*^9, 3.792227828866419*^9}, 3.7942106643899236`*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"ca28fafc-897d-44b7-9ebb-b9a69c1dbf1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final quadrature angles and weights", "Subsubsection",
 CellChangeTimes->{{3.788249443551347*^9, 
  3.788249458769981*^9}},ExpressionUUID->"a33cf8c2-e500-4e14-96dd-\
317c1fbd9fd6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Nu]", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"\[Nu]Gauss", ",", "\[Nu]Radau"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"w", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"wGauss", ",", "wRadau"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "RadauRoots", ",", "GaussLRoots", ",", "\[Nu]Gauss", ",", "\[Nu]Radau", 
    ",", "wGauss", ",", "wRadau"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.792219094661482*^9, 3.792219180779313*^9}, 
   3.7922200357541904`*^9, {3.7922200990859346`*^9, 3.7922201059417768`*^9}, {
   3.792220201260572*^9, 3.7922202126936502`*^9}, 3.792226065298831*^9, {
   3.792226415201909*^9, 3.7922264161237936`*^9}, 3.792386519369314*^9, {
   3.793329921165865*^9, 3.79332992923138*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"40bdede1-faf4-452c-872b-7a7ac6797412"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"anglesRad", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ArcCos", "[", 
      RowBox[{"\[Nu]", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "\[Nu]", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"anglesDeg", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"anglesRad", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "180"}], "\[Pi]"], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "\[Nu]", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7923865547108717`*^9, 3.7923866432033806`*^9}, {
   3.7923869089834595`*^9, 3.7923869091075478`*^9}, {3.79421067112932*^9, 
   3.794210673958869*^9}, 3.8086293487065287`*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"6433d9c2-1c81-4a7f-bfa2-1d211e79b7ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "89.78749518780407`", ",", "88.88869576519235`", ",", "87.30499979604849`", 
   ",", "85.09001088848306`", ",", "82.31565227258426`", ",", 
   "79.06737105880336`", ",", "75.44043319677127`", ",", "71.53775723986466`",
    ",", "67.46953870431479`", ",", "63.35457659967811`", ",", 
   "59.322874643320084`", ",", "55.51859428132227`", ",", 
   "52.10156948995937`", ",", "49.244314138816605`", ",", 
   "47.12043874668809`", ",", "45.88144581678486`", ",", "45.44872842879325`",
    ",", "44.87049816802472`", ",", "43.83903513371717`", ",", 
   "42.368797442240606`", ",", "40.480093527001834`", ",", 
   "38.19806091629736`", ",", "35.55171328534133`", ",", "32.57298955718557`",
    ",", "29.295860557648464`", ",", "25.755529859077438`", ",", 
   "21.987724464618143`", ",", "18.027990137582613`", ",", 
   "13.910661202840586`", ",", "9.666017700861701`", ",", 
   "5.304721296761423`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.808629358942424*^9, {3.808630102383641*^9, 3.808630123068946*^9}, 
   3.808630218415578*^9, 3.80864245815175*^9, 3.808642937148329*^9, 
   3.808645982801791*^9, 3.8086463213826923`*^9, 3.8086467869348354`*^9, 
   3.80871313846566*^9, 3.8087131728833227`*^9, 3.808713297026743*^9, {
   3.8087145319062195`*^9, 3.8087145484377956`*^9}, 3.808715461160966*^9, 
   3.80871712280931*^9, {3.80871729223758*^9, 3.8087173115663767`*^9}, 
   3.8087177050783935`*^9, 3.809056493464097*^9, 3.809056551594939*^9, 
   3.8090569330774794`*^9, 3.809057444774706*^9, 3.8090676995484314`*^9, 
   3.809068182696777*^9, 3.8090692093241034`*^9, 3.8090693531306353`*^9, 
   3.809069471166552*^9, 3.8090697533664055`*^9, 3.8090700050714097`*^9, 
   3.809072038877056*^9, 3.8090742203846903`*^9, 3.8090742862555113`*^9, 
   3.8090743636818824`*^9, 3.80907533445441*^9, 3.809076614891246*^9, 
   3.8090780091897273`*^9, 3.80966073875515*^9, 3.809662437352149*^9, 
   3.8096625946200156`*^9, 3.80966308163863*^9, 3.809663849599124*^9, 
   3.8096645403072577`*^9, 3.8096734254211087`*^9, 3.809673733700818*^9, 
   3.8096738164149356`*^9, 3.80967557672018*^9, 3.8096795421757536`*^9, 
   3.8096798837361255`*^9, 3.809680542444042*^9, 3.8096808257694025`*^9, 
   3.809681464930327*^9, 3.809688830953416*^9, 3.8096891261259995`*^9, 
   3.80968930358307*^9, 3.809689818744459*^9, 3.8096901399087563`*^9, 
   3.8096903736550136`*^9, 3.809690493266862*^9, 3.809693925648712*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"260a8406-1fb1-4358-b7ce-42aa93590eba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tanAnglesDeg", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Tan", "[", 
     RowBox[{"anglesRad", "[", 
      RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "\[Nu]", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.808630069158241*^9, 3.808630117114152*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"3a1a97b5-b0bf-4093-80cd-51b1d78e472b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "269.61985566568455`", ",", "51.55077486130287`", ",", "21.2443467063188`", 
   ",", "11.64064825450644`", ",", "7.411407519958223`", ",", 
   "5.177046908000945`", ",", "3.850195752243533`", ",", "2.99524310704814`", 
   ",", "2.4105878830241974`", ",", "1.993005818114745`", ",", 
   "1.6857246559242862`", ",", "1.456021087709024`", ",", 
   "1.2846291579077675`", ",", "1.160324257430155`", ",", 
   "1.0768982871263288`", ",", "1.031251506133154`", ",", 
   "1.0157875445575932`", ",", "0.9954897198943795`", ",", 
   "0.9602741946690656`", ",", "0.9121273132552323`", ",", 
   "0.853479993499982`", ",", "0.7868676043679071`", ",", 
   "0.7146557270420287`", ",", "0.6388626509672238`", ",", 
   "0.5610788330800313`", ",", "0.4824617150806368`", ",", 
   "0.40377702556780304`", ",", "0.32545987651235386`", ",", 
   "0.24767245865465504`", ",", "0.17032275978399466`", ",", 
   "0.09285030714630638`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8086301553753014`*^9, 3.8086302186402335`*^9, 3.808642458473155*^9, 
   3.8086429374166193`*^9, 3.8086459830793056`*^9, 3.8086463217265377`*^9, 
   3.808646787182328*^9, 3.8087131386294127`*^9, 3.8087131730890045`*^9, 
   3.808713297239641*^9, {3.8087145321488457`*^9, 3.8087145486934*^9}, 
   3.808715461248825*^9, 3.80871712296507*^9, {3.808717292381355*^9, 
   3.808717311769927*^9}, 3.8087177052491293`*^9, 3.809056494704837*^9, 
   3.809056551891265*^9, 3.8090569332891483`*^9, 3.8090574451452265`*^9, 
   3.8090677000194902`*^9, 3.8090681830572114`*^9, 3.809069210159804*^9, 
   3.8090693535879173`*^9, 3.8090694715145617`*^9, 3.8090697539824395`*^9, 
   3.809070005584314*^9, 3.809072039421206*^9, 3.8090742212073975`*^9, 
   3.80907428653407*^9, 3.8090743641581345`*^9, 3.809075334673071*^9, 
   3.80907661516182*^9, 3.809078010209733*^9, 3.809660740419051*^9, 
   3.809662438120453*^9, 3.8096625949744167`*^9, 3.809663081983088*^9, 
   3.8096638498697042`*^9, 3.8096645406876755`*^9, 3.8096734258091917`*^9, 
   3.809673734090151*^9, 3.8096738167124605`*^9, 3.809675577490384*^9, 
   3.8096795424006395`*^9, 3.809679884185422*^9, 3.8096805431149874`*^9, 
   3.809680825977075*^9, 3.8096814651619616`*^9, 3.8096888311671896`*^9, 
   3.8096891267330427`*^9, 3.8096893039092655`*^9, 3.809689819045535*^9, 
   3.8096901401743402`*^9, 3.809690374113298*^9, 3.8096904935653086`*^9, 
   3.809693925938258*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"17d68501-2e41-464e-8d40-8d74b7516c9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"distances", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"3.5", "/", 
     RowBox[{"tanAnglesDeg", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "\[Nu]", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.808630164499197*^9, 3.808630203066304*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"cb78daac-55f5-4654-b657-f6b417545792"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \\\"0.`\\\"]\\) \
encountered.\"", 2, 31, 1, 26756153774950139605, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8086302056103716`*^9, 3.80863021886788*^9}, 
   3.8086424588517632`*^9, 3.8086429378382998`*^9, 3.8086459834217763`*^9, 
   3.8086463220517673`*^9, 3.808646787448917*^9, 3.8087131387971563`*^9, 
   3.808713173413529*^9, 3.808713297608071*^9, {3.8087145323914676`*^9, 
   3.8087145489030757`*^9}, 3.8087154613227105`*^9, 3.8087171231348057`*^9, {
   3.808717292539317*^9, 3.808717311967818*^9}, 3.80871770549315*^9, 
   3.8090564957355127`*^9, 3.8090565521826954`*^9, 3.8090569335048075`*^9, 
   3.8090574457790227`*^9, 3.809067701296753*^9, 3.8090681834136553`*^9, 
   3.809069210628521*^9, 3.809069354362705*^9, 3.8090694718435802`*^9, 
   3.8090697551915426`*^9, 3.809070006337174*^9, 3.809072040018273*^9, 
   3.8090742217315764`*^9, 3.809074287032292*^9, 3.8090743644876194`*^9, 
   3.8090753354658256`*^9, 3.809076615582159*^9, 3.8090780108826838`*^9, 
   3.8096607412433624`*^9, 3.8096624388813543`*^9, 3.8096625953028984`*^9, 
   3.809663082824767*^9, 3.809663850129292*^9, 3.8096645410561256`*^9, 
   3.8096734265591764`*^9, 3.8096737345633855`*^9, 3.8096738170479336`*^9, 
   3.809675577992156*^9, 3.80967954261677*^9, 3.8096798852926817`*^9, 
   3.809680543499386*^9, 3.809680826171176*^9, 3.809681465350662*^9, 
   3.809688831645899*^9, 3.809689127013554*^9, 3.8096893042563334`*^9, 
   3.8096898196864815`*^9, 3.8096901407723966`*^9, 3.809690374543149*^9, 
   3.809690494191323*^9, 3.8096939262747374`*^9},
 CellLabel->
  "During evaluation of \
In[31]:=",ExpressionUUID->"29e98c34-07e3-4344-b4b2-4fabf3062753"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.012981239795409686`", ",", "0.06789422679710895`", ",", 
   "0.16474971192966734`", ",", "0.30067054028928725`", ",", 
   "0.4722449805350508`", ",", "0.6760610947122909`", ",", 
   "0.9090446889513417`", ",", "1.1685195074029588`", ",", 
   "1.4519279818203863`", ",", "1.7561413861354276`", ",", 
   "2.0762584136736986`", ",", "2.403811338685399`", ",", 
   "2.724521686632376`", ",", "3.016398198682561`", ",", "3.250074813787332`",
    ",", "3.3939344371227365`", ",", "3.4456023986042847`", ",", 
   "3.515857502146126`", ",", "3.6447923097695933`", ",", 
   "3.837183635592575`", ",", "4.100857696320533`", ",", 
   "4.4480163887437705`", ",", "4.897463026689165`", ",", 
   "5.478485860303584`", ",", "6.237982603597463`", ",", "7.254461630007312`",
    ",", "8.668150435449363`", ",", "10.754013789675689`", ",", 
   "14.131567227990683`", ",", "20.549220811351`", ",", "37.695082628913326`",
    ",", "ComplexInfinity"}], "}"}]], "Output",
 CellChangeTimes->{{3.8086302057122154`*^9, 3.808630218919799*^9}, 
   3.808642458942837*^9, 3.8086429378855934`*^9, 3.808645983494663*^9, 
   3.8086463220979652`*^9, 3.808646787513813*^9, 3.8087131388650513`*^9, 
   3.8087131734504814`*^9, 3.808713297671973*^9, {3.808714532434402*^9, 
   3.808714548946007*^9}, 3.8087154613656588`*^9, 3.8087171232126827`*^9, {
   3.80871729257605*^9, 3.808717311987787*^9}, 3.8087177063245955`*^9, 
   3.809056495919381*^9, 3.8090565522282476`*^9, 3.8090569335746984`*^9, 
   3.8090574459269648`*^9, 3.809067701937982*^9, 3.8090681835394554`*^9, 
   3.809069210717909*^9, 3.809069354431594*^9, 3.80906947190948*^9, 
   3.8090697556957517`*^9, 3.8090700065752172`*^9, 3.8090720401111245`*^9, 
   3.809074221873498*^9, 3.809074287085209*^9, 3.8090743645774775`*^9, 
   3.8090753356565275`*^9, 3.8090766156400676`*^9, 3.8090780111512575`*^9, 
   3.8096607414154043`*^9, 3.809662439093361*^9, 3.809662595464647*^9, 
   3.8096630830154743`*^9, 3.8096638502251406`*^9, 3.809664541151496*^9, 
   3.8096734274979763`*^9, 3.8096737348179836`*^9, 3.809673817268592*^9, 
   3.8096755785108624`*^9, 3.8096795427174053`*^9, 3.80967988549137*^9, 
   3.80968054364915*^9, 3.809680826227254*^9, 3.8096814654285393`*^9, 
   3.809688831958074*^9, 3.8096891271633224`*^9, 3.8096893044410377`*^9, 
   3.8096898198671937`*^9, 3.8096901409681644`*^9, 3.809690374730857*^9, 
   3.809690494382013*^9, 3.809693926464448*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"e1bf17be-03a2-44ce-8d6c-e002ddad8f46"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["The Redistribution Function", "Subsubsection"]], \
"Subsection",
 CellChangeTimes->{{3.78825029490956*^9, 
  3.7882503130744915`*^9}},ExpressionUUID->"747a9117-1392-44e6-8d16-\
4fe4c1f2ab28"],

Cell[CellGroupData[{

Cell["\[Delta]-M method", "Subsubsection",
 CellChangeTimes->{{3.7882503186097727`*^9, 
  3.788250327422044*^9}},ExpressionUUID->"7c690763-f722-4f32-b816-\
5bc560e2ed2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Tau]s", "[", 
   RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Tau]s", "[", 
    RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"A", " ", 
       SuperscriptBox["G", "M"]}]}], ")"}], "T"}]}]}]], "Input",
 CellChangeTimes->{{3.788250330781434*^9, 3.7882503731192904`*^9}, {
  3.7922278551490617`*^9, 3.792227855285288*^9}, {3.793599495304205*^9, 
  3.793599543273235*^9}, {3.7935996178977547`*^9, 3.793599621782646*^9}, {
  3.793601154721073*^9, 3.793601158226093*^9}, {3.794146888313346*^9, 
  3.7941468920874214`*^9}, {3.7943601278488517`*^9, 3.7943601420160947`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"6315404c-9194-41c6-abf0-1a30400b8bf6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"as", "[", 
   RowBox[{"A_", ",", "G_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"as", "[", 
    RowBox[{"A", ",", "G"}], "]"}], "=", 
   RowBox[{"A", 
    FractionBox[
     RowBox[{"1", "-", 
      SuperscriptBox["G", "M"]}], 
     RowBox[{"1", "-", 
      RowBox[{"A", "\[Times]", 
       SuperscriptBox["G", "M"]}]}]]}]}]}]], "Input",
 CellChangeTimes->{{3.788250384599743*^9, 3.788250427166544*^9}, {
  3.7904058237096624`*^9, 3.7904058257064657`*^9}, {3.7922278387159133`*^9, 
  3.7922278387752914`*^9}, {3.7935995682617764`*^9, 3.7935995896869116`*^9}, {
  3.793599712102791*^9, 3.7935997341151924`*^9}, {3.7935998172492423`*^9, 
  3.7935998217591467`*^9}, {3.7936011603317814`*^9, 3.793601165984892*^9}, {
  3.7941469008776217`*^9, 3.7941469038100195`*^9}, {3.7943601485547915`*^9, 
  3.794360159566345*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"9e7c42a5-f726-4fdf-ad64-8d60624eb8fa"],

Cell[TextData[{
 "Optical thickness of starting layer: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[CapitalDelta]\[Tau]", "*"], "<", 
    SubscriptBox["\[Nu]", "1"]}], TraditionalForm]],ExpressionUUID->
  "771b6e81-3238-4734-a5b7-7161b63d97d8"],
 " (min \[Nu])"
}], "Text",
 CellChangeTimes->{{3.7882505625593376`*^9, 3.788250607555338*^9}, {
  3.7882515678138914`*^9, 
  3.788251571410334*^9}},ExpressionUUID->"ef7b3a00-4652-41cd-940c-\
370daa86b062"],

Cell[TextData[{
 "We want ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[CapitalDelta]\[Tau]", "*"], "\[Times]", 
     SuperscriptBox["2", "n1"]}], "=", 
    SuperscriptBox["\[Tau]", "*"]}], TraditionalForm]],ExpressionUUID->
  "187c0e18-8d55-42ce-b5db-3600ca2e18db"]
}], "Text",
 CellChangeTimes->{{3.78825062829633*^9, 3.7882506532492957`*^9}, {
  3.788252318222726*^9, 3.788252319413885*^9}, {3.7882524889770546`*^9, 
  3.7882524895701385`*^9}},ExpressionUUID->"a5f32691-2d8e-4b3b-babd-\
c6772b82d34c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n1Delayed", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"n1Delayed", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "myN", "}"}], ",", 
      RowBox[{
       RowBox[{"myN", "=", "0"}], ";", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"myN", "<", "100000"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Tau]s", "[", 
              RowBox[{"A", ",", "T", ",", "G"}], "]"}], "<", 
             RowBox[{
              RowBox[{"Min", "[", "\[Nu]", "]"}], "\[Times]", 
              SuperscriptBox["2", "myN"]}]}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
          RowBox[{"myN", "++"}]}]}], "]"}], ";", "myN"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n1", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"n1", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NumberQ", "[", "A", "]"}], 
       StyleBox["\[And]", "OperatorCharacter"], 
       RowBox[{"NumberQ", "[", "T", "]"}], 
       StyleBox["\[And]", "OperatorCharacter"], 
       RowBox[{"NumberQ", "[", "G", "]"}]}], 
      StyleBox[",", "OperatorCharacter"], 
      RowBox[{"n1Delayed", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}], ",", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"n1", "[", 
        RowBox[{"A", ",", "T", ",", "G"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"n1", "[", 
  RowBox[{"a", ",", "\[Tau]", ",", "g"}], "]"}]}], "Input",
 CellChangeTimes->{{3.792220244185278*^9, 3.792220336119082*^9}, 
   3.792225739127387*^9, {3.7922257870016475`*^9, 3.7922257941094966`*^9}, {
   3.792225830673808*^9, 3.792225839752345*^9}, {3.7922278447979174`*^9, 
   3.7922278448888087`*^9}, {3.7922290889443464`*^9, 
   3.7922291359385624`*^9}, {3.793599837082054*^9, 3.7935998608056808`*^9}, {
   3.7936011689598813`*^9, 3.7936011725642147`*^9}, {3.793602396497547*^9, 
   3.7936024536808596`*^9}, 3.7936024893824787`*^9, {3.7936060381039667`*^9, 
   3.7936060775717263`*^9}, {3.7936061187563305`*^9, 3.7936061363502207`*^9}, 
   3.793614545087449*^9, {3.7936146725151415`*^9, 3.7936146777279367`*^9}, 
   3.7936147911929235`*^9, 3.7936160877712817`*^9, {3.7936313661055255`*^9, 
   3.793631379930108*^9}, {3.7941469260820537`*^9, 3.79414693081962*^9}, {
   3.794215818298195*^9, 3.7942159003251557`*^9}, {3.7943601832706103`*^9, 
   3.794360205601622*^9}, 3.794663430956566*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"8fc6817d-1678-4f77-b655-da21929158fe"],

Cell[BoxData["9"], "Output",
 CellChangeTimes->{
  3.79361467969185*^9, 3.793614846951327*^9, 3.7936161183025193`*^9, 
   3.793628761054471*^9, 3.7936289447220173`*^9, {3.793631376545994*^9, 
   3.793631382104025*^9}, 3.793672943129897*^9, 3.7936813871197596`*^9, 
   3.7936815130121527`*^9, 3.7936817043850417`*^9, 3.793682222993435*^9, 
   3.793682351321638*^9, 3.793682436907895*^9, 3.7936825911160603`*^9, 
   3.793682765836003*^9, 3.793687594403212*^9, 3.79368785203395*^9, 
   3.7936880609321995`*^9, 3.7936882957100725`*^9, 3.793688429694688*^9, 
   3.793688741967166*^9, 3.7936917605225954`*^9, 3.793692686772748*^9, 
   3.7941470199127526`*^9, 3.794147791647787*^9, 3.7941478380139956`*^9, {
   3.7941478860126443`*^9, 3.7941479445297794`*^9}, {3.794148195786339*^9, 
   3.7941482168742313`*^9}, {3.794148336354665*^9, 3.7941483559119654`*^9}, {
   3.794208196136859*^9, 3.7942082341824656`*^9}, 3.794208887427148*^9, 
   3.794208968950934*^9, 3.794209161003605*^9, {3.794209196143959*^9, 
   3.7942092362941504`*^9}, 3.7942092857082877`*^9, 3.7942098014024425`*^9, 
   3.794209863250951*^9, 3.794209929282748*^9, 3.7942100053024306`*^9, 
   3.794210097576603*^9, {3.794210831743664*^9, 3.7942108533187227`*^9}, 
   3.7942135829964437`*^9, {3.7942139635610104`*^9, 3.7942139790017233`*^9}, 
   3.7942155463468723`*^9, 3.794215645123608*^9, {3.794215894123914*^9, 
   3.7942159051605525`*^9}, 3.7942161327812467`*^9, 3.7942164474831934`*^9, 
   3.7942165719963226`*^9, 3.7942166856744995`*^9, 3.79421687731404*^9, 
   3.7942170428923254`*^9, 3.794217100518673*^9, 3.794217474496374*^9, 
   3.7942177673080215`*^9, 3.794218045151953*^9, {3.794223204574177*^9, 
   3.7942232186001143`*^9}, 3.794223415616193*^9, 3.794223602084807*^9, 
   3.7942239566809955`*^9, 3.79422411125484*^9, 3.7942247338095136`*^9, 
   3.794225223561096*^9, 3.794225284481263*^9, 3.794226068319229*^9, 
   3.794226126539643*^9, 3.794226239015707*^9, 3.794226599987214*^9, 
   3.794226683703656*^9, 3.794226810878598*^9, 3.7943047357885957`*^9, 
   3.794304804257187*^9, 3.794305063356764*^9, 3.79430510076564*^9, 
   3.794305325676541*^9, 3.794305407061013*^9, 3.794305568965829*^9, 
   3.794306069731037*^9, 3.794306110415968*^9, 3.794306165488656*^9, 
   3.7943065341620874`*^9, {3.794306631440635*^9, 3.794306687382161*^9}, 
   3.7943067661902013`*^9, {3.7943069344230747`*^9, 3.794306977364846*^9}, 
   3.7943070075355654`*^9, 3.7943072961709576`*^9, 3.79430733528262*^9, 
   3.7943600911365147`*^9, {3.7943602010704937`*^9, 3.7943602104899693`*^9}, 
   3.7943606639661427`*^9, 3.7943607288875356`*^9, 3.79436076835146*^9, 
   3.794360870993697*^9, 3.794361355460427*^9, 3.794361535041325*^9, 
   3.794362872692296*^9, 3.7943635980222187`*^9, 3.7943641439394255`*^9, 
   3.794663599308645*^9, 3.794663704710298*^9, 3.7946640392605104`*^9, 
   3.7946641609209433`*^9, 3.794664227979401*^9, 3.794664764725115*^9, 
   3.7946648769125175`*^9, 3.7946650901976037`*^9, 3.8085457479008904`*^9, 
   3.808546050946122*^9, 3.808546736159978*^9, 3.8085631436442986`*^9, 
   3.8086201025644073`*^9, 3.8086248109878426`*^9, 3.8086248450238423`*^9, 
   3.808624942715723*^9, 3.8086250269202757`*^9, 3.8086276366228323`*^9, 
   3.808627819047331*^9, 3.8086284300973873`*^9, 3.8086286747840953`*^9, 
   3.8086293593817434`*^9, {3.808630103197383*^9, 3.808630123856728*^9}, 
   3.8086302194210215`*^9, 3.8086424593197384`*^9, 3.8086429381973934`*^9, 
   3.808645984002084*^9, 3.808646322663039*^9, 3.8086467879102926`*^9, 
   3.8087131393348694`*^9, 3.808713173831448*^9, 3.8087132979505415`*^9, {
   3.8087145331063175`*^9, 3.8087145495604277`*^9}, 3.808715461527959*^9, 
   3.808717123447323*^9, {3.808717292787142*^9, 3.8087173124341073`*^9}, 
   3.8087177067001524`*^9, 3.809056496901332*^9, 3.8090565528613033`*^9, 
   3.80905693431283*^9, 3.8090574473096027`*^9, 3.809067703700334*^9, 
   3.809068184697698*^9, 3.809069211762455*^9, 3.809069355782155*^9, 
   3.809069472774126*^9, 3.8090697570528083`*^9, 3.809070007804294*^9, 
   3.8090720407710867`*^9, 3.8090742228749275`*^9, 3.8090742875924115`*^9, 
   3.809074365130617*^9, 3.809075336452278*^9, 3.8090766160683994`*^9, 
   3.809078013153119*^9, 3.809660742598151*^9, 3.809662441158907*^9, 
   3.8096625964142733`*^9, 3.809663083971964*^9, 3.809663851084792*^9, 
   3.8096645420223427`*^9, 3.8096734282074456`*^9, 3.8096737353890676`*^9, 
   3.809673817884004*^9, 3.809675579975464*^9, 3.809679543163947*^9, 
   3.8096798868103*^9, 3.809680544396978*^9, 3.809680826547406*^9, 
   3.80968146581194*^9, 3.8096888327339287`*^9, 3.809689127896747*^9, 
   3.8096893052293377`*^9, 3.809689820571434*^9, 3.8096901416490235`*^9, 
   3.809690375448363*^9, 3.8096904952592597`*^9, 3.80969392727271*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"92cc997c-04d4-4729-a1ce-175e315814b1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]\[Tau]s", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalDelta]\[Tau]s", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    FractionBox[
     RowBox[{"\[Tau]s", "[", 
      RowBox[{"A", ",", "T", ",", "G"}], "]"}], 
     SuperscriptBox["2", 
      RowBox[{"n1", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}]]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7882523724440937`*^9, 3.788252398710984*^9}, {
   3.788252506160512*^9, 3.788252506594837*^9}, {3.790405511606992*^9, 
   3.7904055217782097`*^9}, {3.7935998873097486`*^9, 3.793599913372396*^9}, 
   3.793599951385497*^9, {3.7936011753857794`*^9, 3.7936011814252806`*^9}, {
   3.7941470274369407`*^9, 3.794147032674718*^9}, {3.7943602189487534`*^9, 
   3.794360231720377*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"d8b7cad3-84ec-4ad6-bc20-54b77245eaf1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]\[Tau]", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalDelta]\[Tau]", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    FractionBox[
     RowBox[{"\[CapitalDelta]\[Tau]s", "[", 
      RowBox[{"A", ",", "T", ",", "G"}], "]"}], 
     RowBox[{"1", "-", 
      RowBox[{"A", "\[Times]", 
       SuperscriptBox["G", "M"]}]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.788498250710834*^9, 3.788498277572573*^9}, {
   3.7908282244925756`*^9, 3.7908282262579184`*^9}, 3.7922257295829453`*^9, {
   3.792227858199877*^9, 3.7922278585280046`*^9}, {3.793599955440117*^9, 
   3.7935999952884054`*^9}, {3.7936011837958145`*^9, 
   3.7936011898027167`*^9}, {3.7936180316198387`*^9, 3.793618050892221*^9}, {
   3.7941470376309357`*^9, 3.7941470420330253`*^9}, {3.794360237643751*^9, 
   3.7943602614158864`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"007300fb-96db-49d7-b532-d4e81b2dfdf0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Heyney-Greenstein phase function", "Text"]], \
"Subsubsection",
 CellChangeTimes->{{3.78825290635326*^9, 
  3.788252923479802*^9}},ExpressionUUID->"3a760808-de01-433a-98e4-\
e006b79c6325"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Chi]", "*"], "[", 
    RowBox[{"k_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Chi]", "*"], "[", 
     RowBox[{"k", ",", "G"}], "]"}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["G", "k"], "-", 
      SuperscriptBox["G", "M"]}], 
     RowBox[{"1", "-", 
      SuperscriptBox["G", "M"]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7922198041214104`*^9, 3.7922198047508554`*^9}, 
   3.792225166299241*^9, 3.792225723440709*^9, {3.7928132976156874`*^9, 
   3.7928133038345366`*^9}, {3.7936001778257227`*^9, 3.793600193684124*^9}, {
   3.793601194696021*^9, 3.793601210588129*^9}, {3.7943602811537604`*^9, 
   3.794360296078781*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"b737892d-deef-4b77-b00a-53ce6047b8f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PPmatrix", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"M", ",", " ", "M"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPmatrix", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "All"}], "]"}], "]"}], "=", "1."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPmatrix", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "All"}], "]"}], "]"}], "=", "\[Nu]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PPmatrix", "[", 
        RowBox[{"[", 
         RowBox[{"nn", ",", "j"}], "]"}], "]"}], "=", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "nn"}], "-", "3"}], ")"}], " ", 
          RowBox[{"\[Nu]", "[", 
           RowBox[{"[", "j", "]"}], "]"}], " ", 
          RowBox[{"PPmatrix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"nn", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"nn", "-", "2"}], ")"}], " ", 
          RowBox[{"PPmatrix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"nn", "-", "2"}], ",", "j"}], "]"}], "]"}]}]}], 
        RowBox[{"nn", "-", "1"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"nn", ",", "3", ",", "M"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "M"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PNmatrix", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"nn", "-", "1"}]], " ", 
      RowBox[{"PPmatrix", "[", 
       RowBox[{"[", 
        RowBox[{"nn", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"nn", ",", "1", ",", "M"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.792499320743333*^9, 3.7924993706941185`*^9}, {
   3.7924994459239445`*^9, 3.792499458876355*^9}, {3.792499569870246*^9, 
   3.7924995851506557`*^9}, {3.792499615727097*^9, 3.7924996598027954`*^9}, {
   3.792506377015198*^9, 3.7925063773902826`*^9}, {3.792506432322228*^9, 
   3.7925064330096893`*^9}, {3.792506467148613*^9, 3.7925064802102146`*^9}, {
   3.7925065167396603`*^9, 3.792506671590308*^9}, {3.7925069333622713`*^9, 
   3.7925070062155075`*^9}, {3.7925070832105665`*^9, 3.792507087644111*^9}, {
   3.7925071620234056`*^9, 3.792507162406027*^9}, {3.7925072993226547`*^9, 
   3.7925073064903374`*^9}, {3.792507349154248*^9, 3.792507349513894*^9}, {
   3.7925075217696495`*^9, 3.792507527062183*^9}, {3.7925080747659383`*^9, 
   3.792508074906559*^9}, {3.792508629607686*^9, 3.792508691723918*^9}, {
   3.792509189969199*^9, 3.792509222688406*^9}, 3.7925094116508427`*^9, {
   3.792514164876917*^9, 3.792514219320238*^9}, {3.792514249421147*^9, 
   3.7925142727162123`*^9}, {3.79251430666064*^9, 3.7925143107318716`*^9}, {
   3.7925143414492393`*^9, 3.7925143874582663`*^9}, {3.7925146507460136`*^9, 
   3.7925147531671677`*^9}, {3.7925147952597003`*^9, 
   3.7925147971873116`*^9}, {3.792515231069809*^9, 3.7925152342457776`*^9}, {
   3.7925188904809103`*^9, 3.792518895814765*^9}, 3.792520290279264*^9, {
   3.7928094622677035`*^9, 3.7928094909868517`*^9}, {3.792809585816292*^9, 
   3.7928096440084195`*^9}, {3.792809696806025*^9, 3.7928097079624295`*^9}, {
   3.792809746041067*^9, 3.792809768838273*^9}, {3.7928106599746737`*^9, 
   3.7928106708029366`*^9}, {3.792810748288248*^9, 3.792810748632*^9}, 
   3.792811323924727*^9, {3.792811405238353*^9, 3.792811409957151*^9}, {
   3.792811618699467*^9, 3.792811648403001*^9}, {3.7928118114660378`*^9, 
   3.792811811637915*^9}, {3.792812811845817*^9, 3.792812815158359*^9}, {
   3.7928139519248667`*^9, 3.7928139721282873`*^9}, {3.792814094758052*^9, 
   3.792814099117487*^9}, 3.7942106866269455`*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"8fe78ed5-06bd-42a1-8a24-6b7e0b299d23"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7925150205477705`*^9, 3.792515028918619*^9}, {
   3.792515067472681*^9, 3.792515079101334*^9}, 3.792515129186868*^9, 
   3.79251733085216*^9, {3.792517676345151*^9, 3.792517705208599*^9}, {
   3.792518849286147*^9, 3.7925188711475797`*^9}, {3.792518946081359*^9, 
   3.792519098365443*^9}, {3.792519163683292*^9, 3.7925191701634226`*^9}, {
   3.792519312250909*^9, 3.792519312930701*^9}, {3.792519377750278*^9, 
   3.7925193812464733`*^9}, {3.792519479119999*^9, 3.7925194817640905`*^9}, {
   3.792519519762455*^9, 3.7925195317226057`*^9}, {3.792519574992771*^9, 
   3.792519591880318*^9}, {3.792519701369706*^9, 3.7925197018073907`*^9}, {
   3.7925197985172253`*^9, 3.7925198292093377`*^9}, {3.7925198728763776`*^9, 
   3.7925200015378556`*^9}, {3.792809351338253*^9, 3.792809366322853*^9}, {
   3.7928095192997437`*^9, 3.7928095222997704`*^9}, {3.792810222152706*^9, 
   3.792810243356676*^9}, {3.792812640998334*^9, 3.7928126422795887`*^9}, {
   3.792812798109869*^9, 3.792812800938033*^9}, {3.792812845705655*^9, 
   3.792812864288381*^9}, {3.7928129464770203`*^9, 3.7928130528717365`*^9}, {
   3.7928133606321855`*^9, 3.7928133626322126`*^9}, {3.792813994894226*^9, 
   3.7928140221123514`*^9}, {3.792814145837039*^9, 3.792814178463281*^9}, 
   3.7928142596028657`*^9, 3.792814308947298*^9, {3.7928143957935724`*^9, 
   3.7928143964498315`*^9}, {3.792815149966285*^9, 3.792815157153886*^9}, {
   3.7928152067014313`*^9, 3.7928152096389713`*^9}, {3.7936003179689536`*^9, 
   3.7936003303594713`*^9}, {3.7936003801494446`*^9, 
   3.7936003841182027`*^9}, {3.7936004732461405`*^9, 3.793600479763943*^9}, {
   3.7936010187687364`*^9, 3.7936010927728195`*^9}, {3.793601239081325*^9, 
   3.7936012940080256`*^9}, 3.7943606128581047`*^9, 3.8087098164909925`*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"9d65ffd7-d750-455c-bd1f-1c574032234e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hpp", "[", "G_", "]"}], ":=", 
   RowBox[{
    RowBox[{"hpp", "[", "G", "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newHPP", ",", "i", ",", "j", ",", "k"}], "}"}], ",", 
      RowBox[{
       RowBox[{"newHPP", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{"M", ",", " ", "M"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"g", "\[Equal]", "0"}], ",", 
         RowBox[{"newHPP", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1.", ",", 
            RowBox[{"{", 
             RowBox[{"M", ",", " ", "M"}], "}"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"newHPP", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "k"}], "+", "1"}], ")"}], " ", 
                  RowBox[{
                   SuperscriptBox["\[Chi]", "*"], "[", 
                   RowBox[{"k", ",", "G"}], "]"}], 
                  RowBox[{"PPmatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}], " ", 
                  RowBox[{"PPmatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", "j"}], "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "0", ",", 
                   RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "i", ",", "M"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "M"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"newHPP", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{"newHPP", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"i", "+", "1"}], ",", "M"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "M"}], "}"}]}], "]"}]}]}], "]"}], ";", 
       "newHPP"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hpm", "[", "G_", "]"}], ":=", 
   RowBox[{
    RowBox[{"hpm", "[", "G", "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newHPM", ",", "i", ",", "j", ",", "k"}], "}"}], ",", 
      RowBox[{
       RowBox[{"newHPM", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{"M", ",", " ", "M"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"g", "\[Equal]", "0"}], ",", 
         RowBox[{"newHPM", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1.", ",", 
            RowBox[{"{", 
             RowBox[{"M", ",", " ", "M"}], "}"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"newHPM", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "k"}], "+", "1"}], ")"}], " ", 
                  RowBox[{
                   SuperscriptBox["\[Chi]", "*"], "[", 
                   RowBox[{"k", ",", "G"}], "]"}], 
                  RowBox[{"PPmatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}], " ", 
                  RowBox[{"PNmatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", "j"}], "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "0", ",", 
                   RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "i", ",", "M"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "M"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"newHPM", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{"newHPM", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"i", "+", "1"}], ",", "M"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "M"}], "}"}]}], "]"}]}]}], "]"}], ";", 
       "newHPM"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7943603663686275`*^9, 3.7943605907141857`*^9}, {
  3.7943606223206153`*^9, 3.794360628191703*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"75999204-7aa5-489c-a8fa-a4f9c43ef698"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hpp", "[", "g", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.794360740860223*^9, 3.794360752909054*^9}, {
   3.794360825376154*^9, 3.7943608258136363`*^9}, 3.8087173271542244`*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"7407133a-c5c5-4422-a645-b0195f9bbf2c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"cachedLegendreP", ",", "PPmatrix", ",", "PNmatrix"}], "]"}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7923846807620344`*^9, 3.7923847127458916`*^9}, {
   3.792384743141822*^9, 3.7923847451427183`*^9}, {3.792384979376559*^9, 
   3.7923849807813816`*^9}, {3.7923866874947367`*^9, 3.792386689818104*^9}, 
   3.7923874988270226`*^9, 3.7923881156947627`*^9, {3.7925152393637652`*^9, 
   3.7925152449326954`*^9}, 3.7928107150221586`*^9, 3.7928127192181683`*^9, 
   3.79281275817183*^9, 3.792812873085373*^9, 3.7928137760146594`*^9, 
   3.7928140271280317`*^9, {3.79281428207194*^9, 3.7928142971033983`*^9}, 
   3.7928143273381777`*^9, {3.792814375637044*^9, 3.7928143823246355`*^9}, 
   3.7928151861855226`*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"2432e5b0-d967-4a7e-a285-a8eee7ad5b35"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Layer Initialiation", "Subsubsection",
 CellChangeTimes->{{3.7885841406678114`*^9, 
  3.788584155151945*^9}},ExpressionUUID->"d4c56b0a-14fb-4a52-9a39-\
9af9ec80d8c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EE", "=", 
   RowBox[{"IdentityMatrix", "[", "M", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.788584254289254*^9, 3.7885842771170983`*^9}, {
   3.7922206422778854`*^9, 3.7922206992499585`*^9}, {3.7922247170541935`*^9, 
   3.7922247173654146`*^9}, {3.7923783409322767`*^9, 3.792378344567124*^9}, 
   3.79361379363116*^9, 3.8087073358107395`*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"01011968-6dd9-4355-9ebf-2de9605891f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"BB", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"as", "[", 
          RowBox[{"A", ",", "G"}], "]"}], "\[Times]", 
         RowBox[{"\[CapitalDelta]\[Tau]s", "[", 
          RowBox[{"A", ",", "T", ",", "G"}], "]"}], "\[Times]", 
         RowBox[{"w", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], 
        RowBox[{"4", " ", 
         RowBox[{"\[Nu]", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]], " ", 
       RowBox[{
        RowBox[{"hpm", "[", "G", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "M"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "M"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7885842963816814`*^9, 3.7885843397709446`*^9}, {
   3.7903913368733253`*^9, 3.790391342317735*^9}, {3.790400887577277*^9, 
   3.7904009910678587`*^9}, {3.790401287905181*^9, 3.790401294441592*^9}, {
   3.790401346015283*^9, 3.790401348292887*^9}, {3.7904013821293464`*^9, 
   3.79040140125498*^9}, {3.7904016456606092`*^9, 3.790401646440611*^9}, {
   3.790405438474064*^9, 3.7904054473816795`*^9}, 3.790405541325044*^9, 
   3.790405844114498*^9, {3.7904060257151937`*^9, 3.7904060270723963`*^9}, {
   3.7904063718798018`*^9, 3.7904063738298054`*^9}, {3.7904064070110636`*^9, 
   3.790406408071865*^9}, 3.7917794024678164`*^9, {3.7922207041288557`*^9, 
   3.792220737386146*^9}, 3.7922217521431785`*^9, {3.7922247129579277`*^9, 
   3.792224713310893*^9}, {3.7922277730845776`*^9, 3.7922277746818476`*^9}, 
   3.792378348780222*^9, 3.7923784962181034`*^9, {3.792386917665971*^9, 
   3.792386924069843*^9}, {3.7936013961755524`*^9, 3.793601439703062*^9}, 
   3.7936015287398825`*^9, {3.7936073185322886`*^9, 3.793607327125167*^9}, 
   3.793613793641142*^9, {3.7936147036949563`*^9, 3.7936147176650352`*^9}, {
   3.794147091717585*^9, 3.794147120227827*^9}, 3.794210701425664*^9, {
   3.794360682034897*^9, 3.7943607186638384`*^9}, {3.7943608457861385`*^9, 
   3.794360860115673*^9}, 3.8087073358107395`*^9},
 CellLabel->"In[51]:=",ExpressionUUID->"5dba3e14-6dc9-4ce1-ad58-10cb8aad75ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AA", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AA", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        TemplateBox[{
          RowBox[{"i", ",", "j"}]},
         "KroneckerDeltaSeq"], " ", 
        FractionBox[
         RowBox[{"\[CapitalDelta]\[Tau]s", "[", 
          RowBox[{"A", ",", "T", ",", "G"}], "]"}], 
         RowBox[{"2", " ", 
          RowBox[{"\[Nu]", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]]}], "-", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"as", "[", 
           RowBox[{"A", ",", "G"}], "]"}], "\[Times]", 
          RowBox[{"\[CapitalDelta]\[Tau]s", "[", 
           RowBox[{"A", ",", "T", ",", "G"}], "]"}], " ", 
          RowBox[{"w", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], 
         RowBox[{"4", " ", 
          RowBox[{"\[Nu]", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]], 
        RowBox[{
         RowBox[{"hpp", "[", "G", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "M"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "M"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7885843429583435`*^9, 3.7885844007221966`*^9}, {
   3.7903913454533405`*^9, 3.7903913489789467`*^9}, {3.790401670542653*^9, 
   3.7904017942664704`*^9}, 3.7904055467382536`*^9, 3.790405849636908*^9, 
   3.790405909057412*^9, {3.790406028897599*^9, 3.790406030738403*^9}, {
   3.7904063753898077`*^9, 3.7904063791650143`*^9}, {3.790406411566272*^9, 
   3.7904064150606775`*^9}, 3.7917794090503955`*^9, {3.792221756924556*^9, 
   3.792221768879012*^9}, {3.792224710115786*^9, 3.7922247104780416`*^9}, {
   3.7922277625764866`*^9, 3.792227783622758*^9}, {3.79238670507093*^9, 
   3.792386712962818*^9}, {3.792386926913316*^9, 3.792386928104461*^9}, {
   3.793329862138648*^9, 3.79332988878871*^9}, {3.793601454618083*^9, 
   3.7936014816268153`*^9}, 3.793601531186034*^9, {3.7936072878863325`*^9, 
   3.793607310555306*^9}, 3.793613793646142*^9, {3.7941471620421853`*^9, 
   3.794147167345858*^9}, 3.794210704458891*^9, {3.7943608814932985`*^9, 
   3.794360904080954*^9}, 3.8087073358107395`*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"2b9406ab-9037-448f-92f0-0551c8d6f3e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inv", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Inv", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Inverse", "[", 
     RowBox[{"EE", "+", 
      RowBox[{"AA", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7885907357754574`*^9, 3.788590776680233*^9}, {
   3.7922207497226467`*^9, 3.7922207604532547`*^9}, {3.793601489247452*^9, 
   3.7936014980246534`*^9}, {3.793601538979783*^9, 3.7936015440158653`*^9}, 
   3.793613793658115*^9, {3.7941471860065656`*^9, 3.7941471905534267`*^9}, {
   3.794360909549039*^9, 3.794360915381426*^9}, 3.8087073358107395`*^9},
 CellLabel->"In[53]:=",ExpressionUUID->"040b75b7-ab05-490c-bcd0-b1c9bae74112"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GG", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"GG", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Inverse", "[", 
     RowBox[{"EE", "+", 
      RowBox[{"AA", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}], "-", 
      RowBox[{
       RowBox[{"BB", "[", 
        RowBox[{"A", ",", "T", ",", "G"}], "]"}], ".", 
       RowBox[{"Inv", "[", 
        RowBox[{"A", ",", "T", ",", "G"}], "]"}], ".", 
       RowBox[{"BB", "[", 
        RowBox[{"A", ",", "T", ",", "G"}], "]"}]}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7885844049878883`*^9, 3.788584443682686*^9}, {
   3.788590759064968*^9, 3.7885907862314944`*^9}, {3.788590906546454*^9, 
   3.7885909595038376`*^9}, {3.7904059939390497`*^9, 3.790405997480256*^9}, 
   3.7917794158124723`*^9, 3.792224574018052*^9, {3.792224751662509*^9, 
   3.792224752705584*^9}, {3.793601558943409*^9, 3.793601587658293*^9}, {
   3.79360743287125*^9, 3.793607435130908*^9}, 3.7936137936651063`*^9, {
   3.794147229148838*^9, 3.7941472336707373`*^9}, {3.7943609209318886`*^9, 
   3.794360942689482*^9}, 3.8087073358107395`*^9},
 CellLabel->"In[54]:=",ExpressionUUID->"d0325f8c-df1f-4454-a1c8-14dff315b870"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RR", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RR", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"2.", 
     RowBox[{
      RowBox[{"GG", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}], ".", 
      RowBox[{"BB", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}], ".", 
      RowBox[{"Inv", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7885844470107045`*^9, 3.788584469416252*^9}, {
   3.7885907655805345`*^9, 3.788590789512559*^9}, {3.7907633383333178`*^9, 
   3.7907633387084155`*^9}, {3.790763388966175*^9, 3.790763394610564*^9}, {
   3.7907682516615562`*^9, 3.790768252083416*^9}, {3.790768414519153*^9, 
   3.790768414845237*^9}, {3.7936015966806774`*^9, 3.7936016250114775`*^9}, 
   3.7936075386598887`*^9, 3.7936137936730947`*^9, {3.7941472420296164`*^9, 
   3.7941472462380123`*^9}, {3.7943609554964714`*^9, 3.7943609713829207`*^9}, 
   3.8087073358157563`*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"0000b52c-6dc8-4fac-9aa0-a12f5af15ef0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TT", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"TT", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{
     RowBox[{"2.", 
      RowBox[{"GG", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}]}], "-", "EE"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.788584471994458*^9, 3.788584480540906*^9}, {
   3.7907633409269886`*^9, 3.7907633416301394`*^9}, {3.790768257491254*^9, 
   3.7907682578458014`*^9}, {3.7907684168146753`*^9, 3.790768417080365*^9}, {
   3.7936016286131964`*^9, 3.793601638846182*^9}, {3.7936071370185747`*^9, 
   3.7936071432518797`*^9}, {3.793607363659868*^9, 3.7936073641470966`*^9}, {
   3.7936074657038198`*^9, 3.7936074879187555`*^9}, {3.793607541564322*^9, 
   3.793607565458084*^9}, 3.793613793680085*^9, {3.794147253045322*^9, 
   3.794147256983142*^9}, {3.7943609768908663`*^9, 3.794360983569992*^9}, 
   3.8087073358157563`*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"b5c78a7e-1384-4cbe-9e71-3a452a088dcf"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"A", ",", "B", ",", "G", ",", "Inv", ",", "hpp", ",", "hpm"}], 
    "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7923879139356365`*^9, 3.7923879863893433`*^9}, 
   3.792388043555179*^9, 3.792811454149006*^9, 3.792812878476063*^9, 
   3.7928138003743596`*^9, 3.7928140307062073`*^9, 3.7928151960294223`*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"6127a884-394f-43a8-9b58-9a9b9eaff7c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"twoaw", "=", 
   RowBox[{"2", " ", "\[Nu]", " ", "w"}]}], ";"}]], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"38868958-868b-4ab2-a3ce-90b2d63d2db8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Rd1", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Rd1", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"RR", "[", 
         RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], 
       RowBox[{"twoaw", "[", 
        RowBox[{"[", "j", "]"}], "]"}]], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "M"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "M"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Td1", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Td1", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"TT", "[", 
         RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], 
       RowBox[{"twoaw", "[", 
        RowBox[{"[", "j", "]"}], "]"}]], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "M"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "M"}], "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790825906071698*^9, 3.7908260179061213`*^9}, {
  3.7908277672387247`*^9, 3.7908277764929094`*^9}, {3.791779449123638*^9, 
  3.7917794508896804`*^9}, {3.79222076994532*^9, 3.7922207801044617`*^9}, {
  3.792220834401165*^9, 3.7922208368999424`*^9}, {3.7922246860559173`*^9, 
  3.7922246918960533`*^9}, {3.7922247593816648`*^9, 3.7922247701740093`*^9}, {
  3.7922277917403345`*^9, 3.7922277959470263`*^9}, {3.7923869313603973`*^9, 
  3.7923869336982484`*^9}, {3.792388014557934*^9, 3.792388024648509*^9}, {
  3.793601655828003*^9, 3.793601693336605*^9}, {3.7936075564013214`*^9, 
  3.793607558822514*^9}, {3.7936076201318736`*^9, 3.7936076226604366`*^9}, {
  3.7936139763978367`*^9, 3.793613996307184*^9}, {3.7936144059235506`*^9, 
  3.7936144094816403`*^9}, {3.793614754343576*^9, 3.7936147633960524`*^9}, {
  3.794147352604027*^9, 3.7941473657354155`*^9}, {3.794360997113846*^9, 
  3.794361017956889*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"1e118888-887b-4ce7-bd74-5048584f8eba"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7936291668805523`*^9, 3.793629169077237*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"289b870e-5fe8-4862-bda9-f71dc03445ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Doubling until desired thickness is reached", "Subsubsection",
 CellChangeTimes->{{3.7908264258054285`*^9, 
  3.790826451714967*^9}},ExpressionUUID->"effe496d-edb8-456a-bc8d-\
37afa8aa0bb3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newE", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    FractionBox["1.", "twoaw"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"star", "=", 
   RowBox[{"DiagonalMatrix", "[", "twoaw", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790827863877113*^9, 3.7908279554609585`*^9}, {
   3.79082798808076*^9, 3.7908280172485714`*^9}, {3.792220785335001*^9, 
   3.7922208012631693`*^9}, {3.7922208390815616`*^9, 3.792220946290944*^9}, {
   3.7922278004912944`*^9, 3.7922278044154587`*^9}, {3.792386954404569*^9, 
   3.792386956034513*^9}, {3.792387001194912*^9, 3.792387019759413*^9}, {
   3.792388002726116*^9, 3.7923880033823724`*^9}, 3.792812651342228*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"b5d440df-9b4a-4795-9d55-c0e8615dc5d8"],

Cell["Now I\[CloseCurlyQuote]ll try to avoid recursion here...", "Text",
 CellChangeTimes->{{3.790829588130557*^9, 
  3.7908296125113773`*^9}},ExpressionUUID->"30928a34-d01c-4a5d-919e-\
40fd16f02048"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Td2", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rd2", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Td", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Td", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Td1", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"n1", "[", 
          RowBox[{"A", ",", "T", ",", "G"}], "]"}], "+", "1"}]}], "}"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rd", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Rd", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Rd1", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"n1", "[", 
          RowBox[{"A", ",", "T", ",", "G"}], "]"}], "+", "1"}]}], "}"}]}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7908300299549303`*^9, 3.7908300919747925`*^9}, {
   3.7908301251591573`*^9, 3.790830169980811*^9}, {3.7908305036323433`*^9, 
   3.7908305332677765`*^9}, 3.7917794607700524`*^9, {3.7922209616322947`*^9, 
   3.7922210065740447`*^9}, {3.792221037404848*^9, 3.7922210689932766`*^9}, {
   3.792224773050479*^9, 3.792224773534875*^9}, {3.7923869647727356`*^9, 
   3.7923869654486113`*^9}, {3.792812654342255*^9, 3.7928126567329273`*^9}, {
   3.793601766254529*^9, 3.7936017917532663`*^9}, {3.793606474725402*^9, 
   3.7936066402148314`*^9}, {3.7936067266598*^9, 3.793606772272468*^9}, {
   3.7936726203888116`*^9, 3.7936726306080046`*^9}, {3.793672666266532*^9, 
   3.7936726856721897`*^9}, {3.79367273034233*^9, 3.793672732925335*^9}, {
   3.793672784565096*^9, 3.7936728232256184`*^9}, {3.793673038152157*^9, 
   3.793673039525608*^9}, {3.7936813483154964`*^9, 3.793681378725894*^9}, {
   3.793681441473016*^9, 3.793681460789174*^9}, {3.79368155410905*^9, 
   3.793681554662174*^9}, {3.793681671686073*^9, 3.7936816996559944`*^9}, {
   3.7941473857240334`*^9, 3.7941473997160673`*^9}, {3.79436103364402*^9, 
   3.7943610555780883`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"ee8c49fa-cb96-4cdb-933a-b9b4f1d4e54a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"makeTChain", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"makeTChain", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "Tchain", ",", "Rchain"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Tchain", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Td1", "[", 
           RowBox[{"A", ",", "T", ",", "G"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"n1", "[", 
              RowBox[{"A", ",", "T", ",", "G"}], "]"}], "+", "1"}]}], "}"}]}],
          "]"}]}], ";", 
       RowBox[{"Rchain", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Rd1", "[", 
           RowBox[{"A", ",", "T", ",", "G"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"n1", "[", 
              RowBox[{"A", ",", "T", ",", "G"}], "]"}], "+", "1"}]}], "}"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"n1", "[", 
           RowBox[{"A", ",", "T", ",", "G"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Tchain", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Tchain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"Inverse", "[", 
             RowBox[{"newE", "-", 
              RowBox[{
               RowBox[{"Rchain", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ".", "star", ".", 
               RowBox[{"Rchain", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ".", 
            RowBox[{"Tchain", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Rchain", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Tchain", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{"newE", "-", 
               RowBox[{
                RowBox[{"Rchain", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ".", "star", ".", 
                RowBox[{"Rchain", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ".", 
             RowBox[{"Rchain", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", "star", ".", 
             RowBox[{"Tchain", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "+", 
            RowBox[{"Rchain", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "Tchain"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeRChain", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"makeRChain", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "Tchain", ",", "Rchain"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Tchain", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Td1", "[", 
           RowBox[{"A", ",", "T", ",", "G"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"n1", "[", 
              RowBox[{"A", ",", "T", ",", "G"}], "]"}], "+", "1"}]}], "}"}]}],
          "]"}]}], ";", 
       RowBox[{"Rchain", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Rd1", "[", 
           RowBox[{"A", ",", "T", ",", "G"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"n1", "[", 
              RowBox[{"A", ",", "T", ",", "G"}], "]"}], "+", "1"}]}], "}"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"n1", "[", 
           RowBox[{"A", ",", "T", ",", "G"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Tchain", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Tchain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"Inverse", "[", 
             RowBox[{"newE", "-", 
              RowBox[{
               RowBox[{"Rchain", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ".", "star", ".", 
               RowBox[{"Rchain", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ".", 
            RowBox[{"Tchain", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Rchain", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Tchain", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{"newE", "-", 
               RowBox[{
                RowBox[{"Rchain", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ".", "star", ".", 
                RowBox[{"Rchain", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ".", 
             RowBox[{"Rchain", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", "star", ".", 
             RowBox[{"Tchain", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "+", 
            RowBox[{"Rchain", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "Rchain"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7936870317285585`*^9, 3.793687050905012*^9}, {
  3.793687087751794*^9, 3.793687149448249*^9}, {3.793687198644426*^9, 
  3.7936873667992706`*^9}, {3.793687399580555*^9, 3.793687441163528*^9}, {
  3.7936875417411833`*^9, 3.793687574169962*^9}, {3.7941474196617565`*^9, 
  3.7941474390822678`*^9}, {3.7943610621948423`*^9, 3.7943611147614555`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"441b383a-7dc1-48df-810f-e11ab1102514"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7908283558016806`*^9, 3.7908283799818883`*^9}, {
   3.790828411992652*^9, 3.7908284854019156`*^9}, {3.790830118769641*^9, 
   3.7908301216503835`*^9}, {3.7908302098073635`*^9, 3.790830213188691*^9}, {
   3.7908302510185013`*^9, 3.7908303163848524`*^9}, {3.7908303785453672`*^9, 
   3.7908305013672795`*^9}, {3.790830551255361*^9, 3.7908306475836616`*^9}, {
   3.792221214372488*^9, 3.7922212433113976`*^9}, {3.792225199512477*^9, 
   3.7922252002526007`*^9}, {3.7922282196332045`*^9, 
   3.7922282573039494`*^9}, {3.7922286701171665`*^9, 3.792228678683835*^9}, {
   3.793601804196718*^9, 3.7936019025412455`*^9}, {3.793602261806383*^9, 
   3.7936022653338346`*^9}, {3.793681415764927*^9, 3.793681439371355*^9}, {
   3.7936817740583954`*^9, 3.7936818331534977`*^9}, 3.793685153834257*^9, {
   3.793685250463704*^9, 3.793685253084262*^9}, {3.7936853025963573`*^9, 
   3.7936853487622223`*^9}, {3.793685508073764*^9, 3.793685517527299*^9}, 
   3.793687584706168*^9, 3.8087098298352075`*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"1dd36ba5-b1d8-4481-9ad8-1e8e0f27bb90"],

Cell["R and T for desired optical thickness", "Text",
 CellChangeTimes->{{3.79083082073977*^9, 
  3.790830834177597*^9}},ExpressionUUID->"9251dde8-bc9a-462b-a019-\
5f250299b4cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Rslab", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Rslab", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{
     RowBox[{"makeRChain", "[", 
      RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"n1", "[", 
        RowBox[{"A", ",", "T", ",", "G"}], "]"}], "+", "1"}], "]"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tslab", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Tslab", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{
     RowBox[{"makeTChain", "[", 
      RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"n1", "[", 
        RowBox[{"A", ",", "T", ",", "G"}], "]"}], "+", "1"}], "]"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7908308440483055`*^9, {3.7908308805401917`*^9, 3.790830955872636*^9}, {
   3.7917794748645096`*^9, 3.7917794765906277`*^9}, {3.792224792177969*^9, 
   3.792224792624296*^9}, {3.792387119799674*^9, 3.7923871347431726`*^9}, {
   3.793601913719668*^9, 3.793601954904506*^9}, {3.793602048816903*^9, 
   3.793602076412424*^9}, {3.7936022376503654`*^9, 3.7936022379668674`*^9}, {
   3.7936728791309977`*^9, 3.7936728795114117`*^9}, {3.793681862972059*^9, 
   3.793681897458418*^9}, {3.7936819675539827`*^9, 3.7936819717722893`*^9}, {
   3.793687739262374*^9, 3.793687741288152*^9}, {3.7936878905607967`*^9, 
   3.793687945598013*^9}, {3.7936881099474583`*^9, 3.7936881103408327`*^9}, {
   3.794147450509329*^9, 3.7941474652901278`*^9}, {3.794361123162774*^9, 
   3.794361136703109*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"83e7952e-3128-4707-904b-9c095ff4a831"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fresnel reflection & boundary conditions", "Subsubsection",
 CellChangeTimes->{{3.7908316292836523`*^9, 
  3.7908316471728745`*^9}},ExpressionUUID->"1f650fdd-37ad-460d-9b01-\
b064916c530e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Nu]t", "[", 
    RowBox[{"ni_", ",", "nt_", ",", "\[Nu]i_"}], "]"}], "=", 
   SqrtBox[
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["ni", "nt"], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[Nu]i", "2"]}], ")"}]}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FresnelR", "[", 
    RowBox[{"\[Nu]i_", ",", "ni_", ",", "nt_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"nt", " ", "\[Nu]i"}], "-", 
         RowBox[{"ni", " ", 
          RowBox[{"Re", "[", 
           RowBox[{"\[Nu]t", "[", 
            RowBox[{"ni", ",", "nt", ",", "\[Nu]i"}], "]"}], "]"}]}]}], 
        RowBox[{
         RowBox[{"nt", " ", "\[Nu]i"}], "+", 
         RowBox[{"ni", " ", 
          RowBox[{"Re", "[", 
           RowBox[{"\[Nu]t", "[", 
            RowBox[{"ni", ",", "nt", ",", "\[Nu]i"}], "]"}], "]"}]}]}]], 
       ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"ni", " ", "\[Nu]i"}], "-", 
         RowBox[{"nt", " ", 
          RowBox[{"Re", "[", 
           RowBox[{"\[Nu]t", "[", 
            RowBox[{"ni", ",", "nt", ",", "\[Nu]i"}], "]"}], "]"}]}]}], 
        RowBox[{
         RowBox[{"ni", " ", "\[Nu]i"}], "+", 
         RowBox[{"nt", " ", 
          RowBox[{"Re", "[", 
           RowBox[{"\[Nu]t", "[", 
            RowBox[{"ni", ",", "nt", ",", "\[Nu]i"}], "]"}], "]"}]}]}]], 
       ")"}], "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rbound", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Re", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"FresnelR", "[", 
            RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "+", 
           RowBox[{"FresnelR", "[", 
            RowBox[{
             RowBox[{"\[Nu]t", "[", 
              RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", 
             "nglass", ",", "1"}], "]"}], "-", 
           RowBox[{"2", "\[Times]", 
            RowBox[{"FresnelR", "[", 
             RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "\[Times]", 
            RowBox[{"FresnelR", "[", 
             RowBox[{
              RowBox[{"\[Nu]t", "[", 
               RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", 
              "nglass", ",", "1"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"FresnelR", "[", 
             RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "\[Times]", 
            RowBox[{"FresnelR", "[", 
             RowBox[{
              RowBox[{"\[Nu]t", "[", 
               RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", 
              "nglass", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], "\[Times]", 
       " ", "twoaw"}], "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Tbound", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Re", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FresnelR", "[", 
           RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "+", 
          RowBox[{"FresnelR", "[", 
           RowBox[{
            RowBox[{"\[Nu]t", "[", 
             RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", "nglass",
             ",", "1"}], "]"}], "-", 
          RowBox[{"2", "\[Times]", 
           RowBox[{"FresnelR", "[", 
            RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "\[Times]", 
           RowBox[{"FresnelR", "[", 
            RowBox[{
             RowBox[{"\[Nu]t", "[", 
              RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", 
             "nglass", ",", "1"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"FresnelR", "[", 
            RowBox[{"\[Nu]", ",", "n", ",", "nglass"}], "]"}], "\[Times]", 
           RowBox[{"FresnelR", "[", 
            RowBox[{
             RowBox[{"\[Nu]t", "[", 
              RowBox[{"n", ",", "nglass", ",", "\[Nu]"}], "]"}], ",", 
             "nglass", ",", "1"}], "]"}]}]}], ")"}]}]}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790907158522921*^9, 3.7909072052245193`*^9}, {
   3.7909072452076435`*^9, 3.790907330845421*^9}, {3.7909074776058426`*^9, 
   3.7909074797932653`*^9}, {3.790907523327859*^9, 3.7909075662952056`*^9}, 
   3.7909076186216216`*^9, {3.790907703884465*^9, 3.79090771822775*^9}, {
   3.790907789522298*^9, 3.790907812349676*^9}, {3.790907851895261*^9, 
   3.790907852957725*^9}, {3.7909079014561415`*^9, 3.7909079020029955`*^9}, {
   3.7909079737101183`*^9, 3.790907977335003*^9}, {3.7909080525981708`*^9, 
   3.790908111127511*^9}, {3.7909083332608843`*^9, 3.790908352650877*^9}, {
   3.7909097927790146`*^9, 3.7909098401586943`*^9}, {3.790910046940713*^9, 
   3.790910047790107*^9}, 3.7911777568341246`*^9, {3.791178763319762*^9, 
   3.79117879915119*^9}, {3.791179414357689*^9, 3.791179414959256*^9}, {
   3.7911794528640347`*^9, 3.7911794576809826`*^9}, {3.7911799804140344`*^9, 
   3.7911799808120623`*^9}, 3.791779485284866*^9, {3.7922213673964024`*^9, 
   3.7922215616791563`*^9}, {3.7922248062422*^9, 3.792224806522409*^9}, {
   3.792225206736641*^9, 3.792225207548583*^9}, {3.7922278985540366`*^9, 
   3.7922279062689877`*^9}, {3.7923870599788485`*^9, 
   3.7923870954249954`*^9}, {3.7932576580574055`*^9, 3.793257661560248*^9}, {
   3.7932578599727483`*^9, 3.7932578676621943`*^9}, {3.7932590823267727`*^9, 
   3.7932591810949554`*^9}, {3.7932594870039473`*^9, 3.793259496128737*^9}, {
   3.793259538359342*^9, 3.7932595458654137`*^9}, {3.793259766619626*^9, 
   3.7932597778842044`*^9}, {3.793259822202195*^9, 3.793260130136829*^9}, {
   3.793260183888789*^9, 3.7932602950437183`*^9}, {3.793262858210754*^9, 
   3.793262896123499*^9}, {3.79326385148326*^9, 3.793263871971049*^9}, {
   3.793263963806428*^9, 3.7932639657211*^9}, {3.793265333543038*^9, 
   3.7932653794590116`*^9}, {3.7932674441813803`*^9, 
   3.7932674906610575`*^9}, {3.7932676194583178`*^9, 
   3.7932676209249735`*^9}, {3.7932677135863824`*^9, 
   3.7932677366003036`*^9}, {3.793329235817568*^9, 3.7933292795616574`*^9}, {
   3.7933293298064876`*^9, 3.79332933207705*^9}, {3.7933295645062857`*^9, 
   3.7933295663501186`*^9}, {3.7933297420864987`*^9, 
   3.7933297441361375`*^9}, {3.79414787219234*^9, 3.794147881755327*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"159a1f10-a3cf-4576-b05f-1dc2fc25149d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Adding boundaries to the slab", "Subsubsection",
 CellChangeTimes->{{3.7911800033149223`*^9, 
  3.7911800102800465`*^9}},ExpressionUUID->"5522287e-0477-4b39-9b46-\
e869c733d6e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"T02", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"T02", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Tslab", "[", 
      RowBox[{"A", ",", "T", ",", "G"}], "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"EE", "-", 
       RowBox[{"Rbound", ".", 
        RowBox[{"Rslab", "[", 
         RowBox[{"A", ",", "T", ",", "G"}], "]"}]}]}], "]"}], ".", 
     "Tbound"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R20", "[", 
    RowBox[{"A_", ",", "T_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"R20", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Tslab", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"EE", "-", 
        RowBox[{"Rbound", ".", 
         RowBox[{"Rslab", "[", 
          RowBox[{"A", ",", "T", ",", "G"}], "]"}]}]}], "]"}], ".", "Rbound", 
      ".", 
      RowBox[{"Tslab", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}]}], "+", 
     RowBox[{"Rslab", "[", 
      RowBox[{"A", ",", "T", ",", "G"}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.791180023131076*^9, 3.7911800620032167`*^9}, {
  3.791180168567599*^9, 3.791180172306975*^9}, {3.7911804302423563`*^9, 
  3.7911806895142746`*^9}, {3.7911826496568594`*^9, 3.7911827266525354`*^9}, {
  3.791183066048019*^9, 3.791183079493684*^9}, {3.791183345637225*^9, 
  3.791183368727637*^9}, {3.7916169669765673`*^9, 3.7916169823047247`*^9}, {
  3.79177951058592*^9, 3.791779512271915*^9}, {3.7922248163116636`*^9, 
  3.792224816648902*^9}, {3.793688176674693*^9, 3.7936882249470053`*^9}, {
  3.7936926758278017`*^9, 3.7936926778320694`*^9}, {3.793692793238184*^9, 
  3.793692811639281*^9}, {3.7941475251022277`*^9, 3.7941475426876197`*^9}, {
  3.794216548584157*^9, 3.794216567733035*^9}, {3.7943611505899057`*^9, 
  3.794361169934112*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"8facdea5-d510-4f76-9944-bd401b23037d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.7946634537779417`*^9, 3.808709837150069*^9},
 CellLabel->"In[79]:=",ExpressionUUID->"e03aa249-b7a8-400d-a15e-709d3d118c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"T03", "[", 
     RowBox[{
      RowBox[{"A_", "?", "NumericQ"}], ",", 
      RowBox[{"T_", "?", "NumericQ"}], ",", 
      RowBox[{"G_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"T03", "[", 
      RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "newT03", "}"}], ",", 
       RowBox[{
        RowBox[{"newT03", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "\[Equal]", "0"}], "||", 
           RowBox[{"T", "\[Equal]", "0"}]}], ",", 
          RowBox[{"newT03", "=", 
           RowBox[{"Re", "[", 
            RowBox[{"Chop", "[", 
             RowBox[{"Tbound", ".", 
              RowBox[{"Inverse", "[", "EE", "]"}], ".", 
              RowBox[{"T02", "[", 
               RowBox[{"A", ",", "T", ",", "G"}], "]"}]}], "]"}], "]"}]}], 
          ",", 
          RowBox[{"newT03", "=", 
           RowBox[{"Re", "[", 
            RowBox[{"Chop", "[", 
             RowBox[{"Tbound", ".", 
              RowBox[{"Inverse", "[", 
               RowBox[{"EE", "-", 
                RowBox[{
                 RowBox[{"R20", "[", 
                  RowBox[{"A", ",", "T", ",", "G"}], "]"}], ".", "Rbound"}]}],
                "]"}], ".", 
              RowBox[{"T02", "[", 
               RowBox[{"A", ",", "T", ",", "G"}], "]"}]}], "]"}], "]"}]}]}], 
         "]"}], ";", "newT03"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R30", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}], ",", 
     RowBox[{"G_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"R30", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "newR30", "}"}], ",", 
      RowBox[{
       RowBox[{"newR30", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "\[Equal]", "0"}], "||", 
          RowBox[{"T", "\[Equal]", "0"}]}], ",", 
         RowBox[{"newR30", "=", 
          RowBox[{"Re", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{"Tbound", ".", 
             RowBox[{"Inverse", "[", "EE", "]"}], ".", 
             RowBox[{"R20", "[", 
              RowBox[{"A", ",", "T", ",", "G"}], "]"}], ".", "Tbound"}], 
            "]"}], "]"}]}], ",", 
         RowBox[{"newR30", "=", 
          RowBox[{"Re", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{"Tbound", ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{"EE", "-", 
               RowBox[{
                RowBox[{"R20", "[", 
                 RowBox[{"A", ",", "T", ",", "G"}], "]"}], ".", "Rbound"}]}], 
              "]"}], ".", 
             RowBox[{"R20", "[", 
              RowBox[{"A", ",", "T", ",", "G"}], "]"}], ".", "Tbound"}], 
            "]"}], "]"}]}]}], "]"}], ";", "newR30"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7911839268187075`*^9, 3.7911839416439285`*^9}, 
   3.7912621831470613`*^9, {3.791262310080556*^9, 3.7912623120179224`*^9}, {
   3.791616995289009*^9, 3.7916170061171446`*^9}, {3.7917795210723352`*^9, 
   3.791779522882453*^9}, {3.792224819487792*^9, 3.792224819882069*^9}, {
   3.793340654400057*^9, 3.793340665197448*^9}, {3.7936881890063124`*^9, 
   3.7936882009282827`*^9}, {3.793688234139328*^9, 3.7936882647974052`*^9}, {
   3.793688461734682*^9, 3.793688464132859*^9}, {3.7941476587424297`*^9, 
   3.794147678758013*^9}, {3.794304457881604*^9, 3.794304602040683*^9}, {
   3.7943046601201115`*^9, 3.794304725837538*^9}, {3.7943050058536034`*^9, 
   3.7943050455961246`*^9}, {3.79436118806429*^9, 3.7943612550097485`*^9}, {
   3.794663458865659*^9, 3.794663535808155*^9}, {3.7946636970763836`*^9, 
   3.794663698873455*^9}, 3.808712451821271*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"b6d4dd95-2641-4fbf-8ef0-9e0cab63c48e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"modifyR30", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}], ",", 
     RowBox[{"G_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"modifyR30", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newR30", ",", "i"}], "}"}], ",", 
      RowBox[{
       RowBox[{"newR30", "=", 
        RowBox[{"R30", "[", 
         RowBox[{"A", ",", "T", ",", "G"}], "]"}]}], ";", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "M"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{"newR30", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
          FractionBox[
           RowBox[{"Rbound", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "i"}], "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"twoaw", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "2"]]}]}], "]"}], ";", 
       "newR30"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modifyR30", "[", 
   RowBox[{"a", ",", "\[Tau]", ",", "g"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"modifyR30", "[", 
    RowBox[{"a", ",", "\[Tau]", ",", "g"}], "]"}], "[", 
   RowBox[{"[", "M", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.793688822302993*^9, 3.7936889430064044`*^9}, {
   3.794147711914954*^9, 3.79414771607143*^9}, {3.7943612603734517`*^9, 
   3.7943612653943405`*^9}, {3.794663988816514*^9, 3.7946640301948133`*^9}, 
   3.808712482431142*^9, {3.8087131300098352`*^9, 3.808713133713733*^9}, {
   3.8087131936614895`*^9, 3.80871320325548*^9}, {3.8087132458309402`*^9, 
   3.8087132625067434`*^9}, 3.808717337989663*^9, 3.8087177225683317`*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"2032df68-de17-4f4b-9a63-302b3c01195a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "M"}], ",", 
     RowBox[{"i", "++"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"R30", "[", 
        RowBox[{"A", ",", "T"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
      FractionBox[
       RowBox[{"Rbound", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"twoaw", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "2"]]}]}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{3.7936889583181133`*^9},
 CellLabel->"In[85]:=",ExpressionUUID->"20cc7118-8b28-45b6-bae8-8f092a21bb74"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"2", "\[Times]", 
    RowBox[{"\[Nu]", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "\[Times]", 
    RowBox[{"w", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "\[Times]", 
    RowBox[{
     RowBox[{"modifyR30", "[", 
      RowBox[{"a", ",", "\[Tau]", ",", "g"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"M", ",", "i"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.808713458667077*^9, 3.808713542878684*^9}, {
   3.808713573825899*^9, 3.808713600195262*^9}, 3.8087140368825135`*^9, {
   3.8087144697771726`*^9, 3.8087145439203444`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"1728adfb-23b2-476d-8072-ddbeed3cf568"],

Cell[BoxData["0.036054704139477846`"], "Output",
 CellChangeTimes->{{3.8087135328181844`*^9, 3.8087135451497765`*^9}, 
   3.808713602970417*^9, {3.808714474289487*^9, 3.808714551967309*^9}, 
   3.808715463400223*^9, 3.8087171254703074`*^9, {3.808717294948678*^9, 
   3.808717315775897*^9}, 3.808717708953172*^9, 3.809056501029296*^9, 
   3.809056555738122*^9, 3.809056937717245*^9, 3.8090574834689007`*^9, 
   3.809067760762121*^9, 3.8090682647635913`*^9, 3.8090692207045083`*^9, 
   3.809069362328889*^9, 3.8090695179684*^9, 3.8090698307283916`*^9, 
   3.809070014236261*^9, 3.80907204486866*^9, 3.8090742302863655`*^9, 
   3.809074291735913*^9, 3.809074368997546*^9, 3.8090753416461267`*^9, 
   3.8090766197516203`*^9, 3.809078019926549*^9, 3.8096607492542353`*^9, 
   3.809662449477639*^9, 3.8096626302041035`*^9, 3.8096630894403863`*^9, 
   3.8096638562487144`*^9, 3.809664546982521*^9, 3.809673431434819*^9, 
   3.8096737389287558`*^9, 3.8096738210384293`*^9, 3.8096755846751394`*^9, 
   3.809679573293145*^9, 3.8096798913611517`*^9, 3.809680548803056*^9, 
   3.8096808298986855`*^9, 3.809681468370927*^9, 3.809688836007832*^9, 
   3.8096891313314533`*^9, 3.8096893090101776`*^9, 3.809689824046467*^9, 
   3.809690145328951*^9, 3.809690379206976*^9, 3.8096904994430757`*^9, 
   3.8096939309592447`*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"9d49eeb1-6ae6-4694-aaf6-1cf585c1c04b"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.808713548876176*^9, 3.8087135682230687`*^9}, {
  3.8087145602621727`*^9, 3.808714588934043*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"530d72ec-e63a-4e2b-b686-e13cb70cc4a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find total R and T", "Subsubsection",
 CellChangeTimes->{{3.8087075008296623`*^9, 
  3.8087075087121973`*^9}},ExpressionUUID->"fee8aaea-da3e-42fc-8ec4-\
60f9af8295b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Rc", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}], ",", 
     RowBox[{"G_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Rc", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Total", "[", 
     RowBox[{"2", " ", "\[Nu]", " ", "w", "\[Times]", 
      RowBox[{
       RowBox[{"modifyR30", "[", 
        RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
       RowBox[{"[", "M", "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tc", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}], ",", 
     RowBox[{"G_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Tc", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"Total", "[", 
     RowBox[{"2", " ", "\[Nu]", " ", "w", " ", 
      RowBox[{
       RowBox[{"T03", "[", 
        RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
       RowBox[{"[", "M", "]"}], "]"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7912623456891117`*^9, 3.791262349564164*^9}, {
   3.791262420089177*^9, 3.7912624749312363`*^9}, {3.7912625298357964`*^9, 
   3.791262543460386*^9}, {3.791262578256191*^9, 3.791262580974856*^9}, {
   3.7912626168331327`*^9, 3.7912626667690926`*^9}, {3.7916169186016254`*^9, 
   3.7916169325705643`*^9}, {3.792227913127484*^9, 3.79222791686966*^9}, {
   3.7923871779455523`*^9, 3.792387182993332*^9}, {3.792387239213123*^9, 
   3.792387253128194*^9}, {3.792387426807272*^9, 3.7923874338648186`*^9}, {
   3.793691697232768*^9, 3.793691748463417*^9}, {3.7936919844984818`*^9, 
   3.793691988696374*^9}, {3.794147727766071*^9, 3.7941477432317953`*^9}, {
   3.794361274328226*^9, 3.7943612855648413`*^9}, {3.794664066489558*^9, 
   3.794664107466792*^9}, {3.7946641390114107`*^9, 3.794664155374282*^9}, {
   3.794664187381862*^9, 3.7946642238216667`*^9}, 3.808712535906337*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"2270082c-9e9a-4f2a-b1c8-437fb2166f39"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rc", "[", 
    RowBox[{"a", ",", "\[Tau]", ",", "g"}], "]"}], ",", 
   RowBox[{"Tc", "[", 
    RowBox[{"a", ",", "\[Tau]", ",", "g"}], "]"}]}], "}"}]], "Input",
 CellLabel->"In[90]:=",ExpressionUUID->"1b195be9-c1b0-49ba-bbf5-58d643c4e0be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.09982469291217119`", ",", "0.7590205474491892`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.808713141871586*^9, 3.80871317689069*^9, 3.80871330030589*^9, {
   3.808714536599229*^9, 3.808714552722042*^9}, 3.8087154635654936`*^9, 
   3.8087171260158944`*^9, {3.808717295448809*^9, 3.808717316058941*^9}, 
   3.808717709176824*^9, 3.809056501905057*^9, 3.8090565561735*^9, 
   3.809056938058712*^9, 3.8090574843482833`*^9, 3.809067761945714*^9, 
   3.809068266072589*^9, 3.8090692225678797`*^9, 3.809069363168953*^9, 
   3.809069519392269*^9, 3.809069831630572*^9, 3.8090700151022434`*^9, 
   3.8090720452810125`*^9, 3.809074231440558*^9, 3.809074292535658*^9, 
   3.8090743696894627`*^9, 3.809075342069463*^9, 3.8090766199702744`*^9, 
   3.8090780207876062`*^9, 3.809660750505221*^9, 3.8096624503259478`*^9, 
   3.8096626306581697`*^9, 3.809663089908184*^9, 3.809663856704004*^9, 
   3.8096645475148125`*^9, 3.8096734318742332`*^9, 3.8096737394419775`*^9, 
   3.809673821456503*^9, 3.809675585178749*^9, 3.8096795735849524`*^9, 
   3.809679891807452*^9, 3.8096805491754675`*^9, 3.8096808303529687`*^9, 
   3.809681468702518*^9, 3.809688836288992*^9, 3.809689131858265*^9, 
   3.8096893093626275`*^9, 3.809689824611768*^9, 3.809690145866805*^9, 
   3.809690379548031*^9, 3.8096904997829494`*^9, 3.809693931310033*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"d2da799c-3fad-41f4-9916-450ae992e88b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Nu]", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.808715507592413*^9, 3.808715511567342*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"f819967d-ce5d-4f08-a716-4bb5ccb4581f"],

Cell[BoxData["0.0037089001458636534`"], "Output",
 CellChangeTimes->{
  3.8087155132030587`*^9, 3.8087171261636624`*^9, {3.808717295583609*^9, 
   3.8087173162316713`*^9}, 3.808717709307622*^9, 3.809056502314127*^9, 
   3.8090565564755373`*^9, 3.8090569382693853`*^9, 3.80905748479076*^9, 
   3.809067762514707*^9, 3.809068267094099*^9, 3.80906922305711*^9, 
   3.8090693634366603`*^9, 3.809069519858404*^9, 3.8090698319695854`*^9, 
   3.809070015470662*^9, 3.8090720455256276`*^9, 3.809074231840932*^9, 
   3.8090742928661404`*^9, 3.8090743699230986`*^9, 3.809075342305092*^9, 
   3.8090766200601363`*^9, 3.8090780212418966`*^9, 3.8096607512221923`*^9, 
   3.809662450666479*^9, 3.8096626312931805`*^9, 3.809663090609084*^9, 
   3.8096638573429976`*^9, 3.8096645478522825`*^9, 3.809673432208948*^9, 
   3.809673739768464*^9, 3.809673821761749*^9, 3.8096755854835205`*^9, 
   3.8096795738165855`*^9, 3.8096798922327814`*^9, 3.8096805495768385`*^9, 
   3.8096808306065774`*^9, 3.8096814689839916`*^9, 3.809688836444745*^9, 
   3.8096891320921817`*^9, 3.8096893095852747`*^9, 3.8096898248773565`*^9, 
   3.8096901461154165`*^9, 3.8096903797450438`*^9, 3.809690500001065*^9, 
   3.809693931541669*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"f5a7eaf6-2875-4370-8c9e-f7ef8f83c94c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Rlist", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}], ",", 
     RowBox[{"G_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Rlist", "[", 
     RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
    RowBox[{"2", " ", "\[Nu]", " ", "w", "\[Times]", 
     RowBox[{
      RowBox[{"modifyR30", "[", 
       RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
      RowBox[{"[", "M", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tlist", "[", 
   RowBox[{
    RowBox[{"A_", "?", "NumericQ"}], ",", 
    RowBox[{"T_", "?", "NumericQ"}], ",", 
    RowBox[{"G_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Tlist", "[", 
    RowBox[{"A", ",", "T", ",", "G"}], "]"}], "=", 
   RowBox[{"2", " ", "\[Nu]", " ", "w", "\[Times]", 
    RowBox[{
     RowBox[{"T03", "[", 
      RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
     RowBox[{"[", "M", "]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.809057877256399*^9, 3.8090579523132668`*^9}, {
   3.809058141214574*^9, 3.809058166489264*^9}, 3.809070201253431*^9, {
   3.809073012651719*^9, 3.8090730211457872`*^9}, {3.809073071677699*^9, 
   3.8090731095156927`*^9}, {3.809073411829851*^9, 3.809073426062498*^9}, {
   3.8090739058381233`*^9, 3.8090739282415624`*^9}, {3.8090739854423466`*^9, 
   3.809074014972825*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"e7925f17-487a-4cd2-aea4-10df4a6022b8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Rlist", "[", 
     RowBox[{"a", ",", "\[Tau]", ",", "g"}], "]"}], "[", 
    RowBox[{"[", "i", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.809074021860454*^9, 3.8090741088712463`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"fe4a4cf5-7a89-4954-9ead-995cb1504e41"],

Cell[BoxData["0.041515722781332184`"], "Output",
 CellChangeTimes->{
  3.80907403657038*^9, 3.8090740713084006`*^9, {3.809074103617612*^9, 
   3.809074110617667*^9}, 3.80907423261172*^9, 3.8090742937148123`*^9, 
   3.8090743702336063`*^9, 3.8090753430928583`*^9, 3.809076620213894*^9, 
   3.8090780222553053`*^9, 3.8096607516029854`*^9, 3.809662451640951*^9, 
   3.8096626316351843`*^9, 3.809663090985493*^9, 3.809663857699436*^9, 
   3.8096645486661334`*^9, 3.809673432647805*^9, 3.8096737401300216`*^9, 
   3.8096738222544413`*^9, 3.809675586085575*^9, 3.809679574060131*^9, 
   3.8096798927220163`*^9, 3.8096805501159935`*^9, 3.8096808309511538`*^9, 
   3.8096814692176285`*^9, 3.8096888367687893`*^9, 3.809689132415964*^9, 
   3.809689309985329*^9, 3.8096898252059965`*^9, 3.8096901465033474`*^9, 
   3.8096903800069513`*^9, 3.8096905004032497`*^9, 3.8096939319530287`*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"3a11885b-bb65-4f05-be5b-e87c9526fdd4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"2", " ", "\[Nu]", " ", "w", "\[Times]", 
    RowBox[{
     RowBox[{
      RowBox[{"modifyR30", "[", 
       RowBox[{"a", ",", "\[Tau]", ",", "g"}], "]"}], "[", 
      RowBox[{"[", "M", "]"}], "]"}], "[", 
     RowBox[{"[", "i", "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "M"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8090730344104333`*^9, 3.8090730388595867`*^9}, {
  3.8090732086560793`*^9, 3.8090732487653475`*^9}, {3.8090733442698946`*^9, 
  3.8090733988228693`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"a3647eba-0a15-4941-a3c9-a017d952ac87"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0018536056676804876`", ",", "0.0222233783894402`", ",", 
   "0.08235437800876527`", ",", "0.1963397597801028`", ",", 
   "0.3681837407611368`", ",", "0.5904936107014407`", ",", 
   "0.844916307139051`", ",", "1.1042799949180309`", ",", 
   "1.336151518052195`", ",", "1.507312209735019`", ",", 
   "1.5885170536839892`", ",", "1.5588555252775445`", ",", 
   "1.409083775939772`", ",", "1.1434417811035116`", ",", 
   "0.7797031039184834`", ",", "0.34791416464417174`", ",", 
   "0.16002928871187078`", ",", "0.3702893805138528`", ",", 
   "0.5750419340531097`", ",", "0.7694088823940193`", ",", 
   "0.9473992820443238`", ",", "1.1016623617706267`", ",", 
   "1.2238317974500648`", ",", "1.3052160283233847`", ",", 
   "1.3377401574773384`", ",", "1.3150092261749773`", ",", 
   "1.2333370261005914`", ",", "1.0925813794298247`", ",", 
   "0.8966470163556337`", ",", "0.6535534687768146`", ",", 
   "0.3749404696682659`", ",", "0.061670537963989316`"}], "}"}]], "Output",
 CellChangeTimes->{{3.809073224043486*^9, 3.809073251182059*^9}, 
   3.8090733719092407`*^9, 3.8090734020458345`*^9, 3.809074233023077*^9, 
   3.809074293991371*^9, 3.8090743706988797`*^9, 3.8090753433414693`*^9, 
   3.809076620308747*^9, 3.8090780227045975`*^9, 3.8096607521022043`*^9, 
   3.8096624519394836`*^9, 3.8096626318987713`*^9, 3.809663091451762*^9, 
   3.809663857949044*^9, 3.8096645490255384`*^9, 3.809673432973138*^9, 
   3.80967374046649*^9, 3.809673822572801*^9, 3.8096755865545053`*^9, 
   3.809679574270805*^9, 3.809679893031539*^9, 3.809680550740758*^9, 
   3.809680831138854*^9, 3.809681469504178*^9, 3.8096888369285555`*^9, 
   3.8096891326550846`*^9, 3.809689310221955*^9, 3.809689825452608*^9, 
   3.8096901467629385`*^9, 3.809690380322114*^9, 3.809690500630191*^9, 
   3.809693932190653*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"ce35ed34-6851-4b24-85c9-31a0b343457e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find light cones within border", "Subsubsection",
 CellChangeTimes->{{3.793077336758442*^9, 
  3.7930773527767296`*^9}},ExpressionUUID->"b68e9066-8a91-43ae-8374-\
3da9a8aee4b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"angleBorder", "[", "Z_", "]"}], "=", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"ArcTan", "[", 
      FractionBox["r", "Z"], "]"}], "]"}], "\[Times]", 
    FractionBox["180", "Pi"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"withinBorder", "[", 
    RowBox[{"Z_", ",", "list_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "j", "}"}], ",", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"anglesDeg", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ">", 
         RowBox[{"angleBorder", "[", "Z", "]"}]}], ",", 
        RowBox[{"j", "++"}]}], "]"}], ";", 
      RowBox[{"Drop", "[", 
       RowBox[{"list", ",", 
        RowBox[{"j", "-", "2"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"anglesWB", "[", "Z_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "list", "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Z", "\[Equal]", "0"}], ",", 
        RowBox[{"list", "=", "anglesDeg"}], ",", 
        RowBox[{"list", "=", 
         RowBox[{"withinBorder", "[", 
          RowBox[{"Z", ",", "anglesDeg"}], "]"}]}]}], "]"}], ";", "list"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7934130056838255`*^9, 3.793413017144994*^9}, {
   3.793413127028426*^9, 3.7934131396653624`*^9}, {3.793413191770231*^9, 
   3.793413278753027*^9}, {3.79341350380116*^9, 3.7934135091128063`*^9}, {
   3.7934135401982613`*^9, 3.7934135415201607`*^9}, {3.7934138226083417`*^9, 
   3.79341387545969*^9}, 3.7934142200694714`*^9, {3.7934143287733583`*^9, 
   3.793414334143678*^9}, {3.7934143647860007`*^9, 3.793414400945054*^9}, {
   3.793414672044959*^9, 3.7934147146400394`*^9}, {3.793414805212041*^9, 
   3.7934148347848043`*^9}, {3.793415419288856*^9, 3.793415425993296*^9}, {
   3.7934154957390795`*^9, 3.793415500250386*^9}, 3.7934162270389156`*^9, {
   3.793420704468598*^9, 3.793420784081879*^9}, {3.7934208568108387`*^9, 
   3.7934208723928375`*^9}, {3.8096741954624453`*^9, 3.809674207346843*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"e773c96a-a948-48c0-8465-3e28c146aef5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"zRef", "[", "Z_", "]"}], ":=", 
   RowBox[{"Z", "+", 
    RowBox[{"70", "\[Times]", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angleBorderRef", "[", "Z_", "]"}], ":=", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"ArcTan", "[", 
      FractionBox["r", 
       RowBox[{"zRef", "[", "Z", "]"}]], "]"}], "]"}], "\[Times]", 
    FractionBox["180", "Pi"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"anglesWBRef", "[", "Z_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "list", "}"}], ",", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"anglesDeg", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ">", 
         RowBox[{"angleBorderRef", "[", "Z", "]"}]}], ",", 
        RowBox[{"j", "++"}]}], "]"}], ";", 
      RowBox[{"list", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"anglesDeg", ",", 
         RowBox[{"j", "-", "2"}]}], "]"}]}], ";", "list"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8096742375780864`*^9, 3.8096742944024525`*^9}, {
  3.8096752159643106`*^9, 3.8096753047877455`*^9}, {3.80967544787764*^9, 
  3.8096754505893846`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"8f040356-08ee-4845-86d2-2e875bf4aadd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"anglesWBRef", "[", "0.0", "]"}]], "Input",
 CellChangeTimes->{{3.8096756895205483`*^9, 3.8096757476774273`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"ee5fe271-71af-4bfd-8064-9d1d36502ef9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.304721296761423`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.809675698447011*^9, 3.8096757483609276`*^9}, 
   3.8096795746534348`*^9, 3.8096798937903357`*^9, 3.8096805522238703`*^9, 
   3.809680831441693*^9, 3.8096814699794273`*^9, 3.8096888372036533`*^9, 
   3.8096891331742163`*^9, 3.8096893105744023`*^9, 3.8096898259717884`*^9, 
   3.8096901473020887`*^9, 3.8096903806468854`*^9, 3.809690500979656*^9, 
   3.809693932548088*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"246c8dfd-a1d8-4673-abde-8cfe47f99b4c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sum concerning only angles within border", "Subsubsection",
 CellChangeTimes->{{3.793254599523079*^9, 
  3.793254614012385*^9}},ExpressionUUID->"63bf508f-fe89-4657-86e7-\
dfdbd86af311"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RlastWB", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}], ",", 
     RowBox[{"G_", "?", "NumericQ"}], ",", 
     RowBox[{"Z_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RlastWB", "[", 
     RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "list", "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Z", "\[Equal]", "0"}], ",", 
         RowBox[{"list", "=", 
          RowBox[{
           RowBox[{"R30", "[", 
            RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "M"}], "]"}], "]"}]}], ",", 
         RowBox[{"list", "=", 
          RowBox[{"withinBorder", "[", 
           RowBox[{"Z", ",", 
            RowBox[{
             RowBox[{"R30", "[", 
              RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "M"}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
       ";", "list"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Nu]WB", "[", "Z_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Nu]WB", "[", "Z", "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "list", "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Z", "\[Equal]", "0"}], ",", 
         RowBox[{"list", "=", "\[Nu]"}], ",", 
         RowBox[{"list", "=", 
          RowBox[{"withinBorder", "[", 
           RowBox[{"Z", ",", "\[Nu]"}], "]"}]}]}], "]"}], ";", "list"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wWB", "[", "Z_", "]"}], ":=", 
   RowBox[{
    RowBox[{"wWB", "[", "Z", "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "list", "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Z", "\[Equal]", "0"}], ",", 
         RowBox[{"list", "=", "w"}], ",", 
         RowBox[{"list", "=", 
          RowBox[{"withinBorder", "[", 
           RowBox[{"Z", ",", "w"}], "]"}]}]}], "]"}], ";", "list"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R30WB", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}], ",", 
     RowBox[{"G_", "?", "NumericQ"}], ",", 
     RowBox[{"Z_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"R30WB", "[", 
     RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RlastWB", "[", 
        RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], ",", 
       RowBox[{"\[Nu]WB", "[", "Z", "]"}], ",", 
       RowBox[{"wWB", "[", "Z", "]"}]}], "}"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7934203605008125`*^9, 3.7934205273562417`*^9}, {
  3.7934206237410746`*^9, 3.793420673118851*^9}, {3.7934209453417645`*^9, 
  3.7934209815739045`*^9}, {3.793421105507448*^9, 3.793421254162279*^9}, {
  3.7934213790828857`*^9, 3.7934213815376406`*^9}, {3.793421430435133*^9, 
  3.7934214391139374`*^9}, {3.793421602365526*^9, 3.7934216038189588`*^9}, {
  3.7934217564576883`*^9, 3.7934217717549496`*^9}, {3.8096613999413543`*^9, 
  3.809661456542175*^9}, {3.8096617345233145`*^9, 3.809661788453538*^9}, {
  3.809661818700215*^9, 3.809661877664914*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"2f20a397-bff4-4e5e-a4d3-572ae96a7493"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TlastWB", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}], ",", 
     RowBox[{"G_", "?", "NumericQ"}], ",", 
     RowBox[{"Z_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"TlastWB", "[", 
     RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "list", "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Z", "\[Equal]", "0"}], ",", 
         RowBox[{"list", "=", 
          RowBox[{
           RowBox[{"T03", "[", 
            RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "M"}], "]"}], "]"}]}], ",", 
         RowBox[{"list", "=", 
          RowBox[{"withinBorder", "[", 
           RowBox[{"Z", ",", 
            RowBox[{
             RowBox[{"T03", "[", 
              RowBox[{"A", ",", "T", ",", "G"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "M"}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
       ";", "list"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T03WB", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}], ",", 
     RowBox[{"G_", "?", "NumericQ"}], ",", 
     RowBox[{"Z_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"T03WB", "[", 
     RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TlastWB", "[", 
        RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], ",", 
       RowBox[{"\[Nu]WB", "[", "Z", "]"}], ",", 
       RowBox[{"wWB", "[", "Z", "]"}]}], "}"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7934216281423416`*^9, 3.79342165397176*^9}, {
   3.7934216936318593`*^9, 3.7934216941941757`*^9}, {3.793421776884795*^9, 
   3.7934217848900857`*^9}, 3.809661894804761*^9, {3.8096620579979467`*^9, 
   3.809662068136935*^9}, {3.8096621095688305`*^9, 3.809662163994804*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"5882c80e-636c-406c-8c56-ef573a39454c"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RcWB", "[", 
     RowBox[{
      RowBox[{"A_", "?", "NumericQ"}], ",", 
      RowBox[{"T_", "?", "NumericQ"}], ",", 
      RowBox[{"G_", "?", "NumericQ"}], ",", 
      RowBox[{"Z_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"RcWB", "[", 
      RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"2", "\[Times]", 
         RowBox[{
          RowBox[{"R30WB", "[", 
           RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Times]", 
         RowBox[{
          RowBox[{"R30WB", "[", 
           RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", 
         RowBox[{
          RowBox[{"R30WB", "[", 
           RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"R30WB", "[", 
            RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "]"}], "-", 
          "1"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TcWB", "[", 
     RowBox[{
      RowBox[{"A_", "?", "NumericQ"}], ",", 
      RowBox[{"T_", "?", "NumericQ"}], ",", 
      RowBox[{"G_", "?", "NumericQ"}], ",", 
      RowBox[{"Z_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"TcWB", "[", 
      RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"2", "\[Times]", 
         RowBox[{
          RowBox[{"T03WB", "[", 
           RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Times]", 
         RowBox[{
          RowBox[{"T03WB", "[", 
           RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", 
         RowBox[{
          RowBox[{"T03WB", "[", 
           RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"R30WB", "[", 
           RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "]"}]}], 
        "}"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.7933444265702896`*^9, 3.793344463839075*^9}, {
   3.7933445549294634`*^9, 3.793344691744531*^9}, {3.793422113399655*^9, 
   3.7934221493994455`*^9}, {3.7934222259592752`*^9, 
   3.7934222862797265`*^9}, {3.7934223162846537`*^9, 3.793422389568899*^9}, {
   3.793422681508328*^9, 3.7934227238534374`*^9}, {3.793423235131158*^9, 
   3.793423263465829*^9}, {3.7934234157586126`*^9, 3.79342341666821*^9}, {
   3.7934236411360397`*^9, 3.793423646171985*^9}, 3.7934318152361517`*^9, 
   3.7934318692592974`*^9, {3.793433504345036*^9, 3.7934335045481586`*^9}, {
   3.7934336725854897`*^9, 3.7934336729539213`*^9}, {3.7934337124961863`*^9, 
   3.793433763552388*^9}, {3.8096622121937337`*^9, 3.809662251034421*^9}, {
   3.8096622979510283`*^9, 3.80966234433139*^9}, 3.809674225431704*^9, {
   3.8096754738334084`*^9, 3.8096755220300274`*^9}, {3.809679846080969*^9, 
   3.8096798488758607`*^9}, 3.8096805056601305`*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"7937af4a-5e84-42ac-ae98-606b4c06e163"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RvsZ", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TvsZ", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "10"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"RvsZ", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "\[Times]", "0.004"}], "+", 
       "0.001"}]}], ";", 
     RowBox[{
      RowBox[{"RvsZ", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"RcWB", "[", 
       RowBox[{"a", ",", "\[Tau]", ",", "g", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "\[Times]", "0.004"}]}], 
       "]"}]}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "10"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"TvsZ", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "\[Times]", "0.004"}], "+", 
       "0.001"}]}], ";", 
     RowBox[{
      RowBox[{"TvsZ", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"TcWB", "[", 
       RowBox[{"a", ",", "\[Tau]", ",", "g", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "\[Times]", "0.004"}]}], 
       "]"}]}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7934228315974393`*^9, 3.7934228375560555`*^9}, {
   3.793423033293342*^9, 3.7934230819418283`*^9}, {3.793423165301153*^9, 
   3.7934232280750484`*^9}, {3.793423267311833*^9, 3.793423335411118*^9}, {
   3.793423386126356*^9, 3.79342342066671*^9}, {3.7934234896478987`*^9, 
   3.793423504152485*^9}, {3.793423535024831*^9, 3.793423535365308*^9}, 
   3.7934235843447065`*^9, {3.793423675137063*^9, 3.793423703987175*^9}, {
   3.79342514814142*^9, 3.7934252070239697`*^9}, {3.7934419266757097`*^9, 
   3.793441958055401*^9}, {3.7935100286809187`*^9, 3.7935100379558663`*^9}, {
   3.7935105284713063`*^9, 3.793510621052839*^9}, {3.793510722190442*^9, 
   3.7935107351959233`*^9}, {3.8096623730000057`*^9, 3.809662380892174*^9}, {
   3.8096628076521177`*^9, 3.80966282475165*^9}, {3.8096733743946085`*^9, 
   3.8096733779359093`*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"ac581bc3-6f49-4958-9635-a112b9855ea7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TcWB", "[", 
  RowBox[{"a", ",", "\[Tau]", ",", "g", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.809673546543992*^9, 3.8096736033234386`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"88ec1ebf-4eb7-49f8-9708-5254be44f793"],

Cell[BoxData["0.7590205474491896`"], "Output",
 CellChangeTimes->{{3.8096735593560877`*^9, 3.8096736057296143`*^9}, 
   3.8096737413590593`*^9, 3.80967382351723*^9, 3.8096755895209684`*^9, 
   3.8096795752527275`*^9, 3.8096798955435877`*^9, 3.809680553337118*^9, 
   3.8096808321186314`*^9, 3.809681470403763*^9, 3.809688837775835*^9, 
   3.809689133754201*^9, 3.8096893112094526`*^9, 3.8096898265780196`*^9, 
   3.809690147838249*^9, 3.809690381343872*^9, 3.809690501571798*^9, 
   3.809693933145152*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"ba78bb91-9a02-4a5d-b3b4-5067ae241b01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "RvsZ", "]"}]], "Input",
 CellChangeTimes->{{3.8096625080454597`*^9, 3.809662516108047*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"4f5fc583-9841-43b9-99ad-7d2d19160d7c"],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{0.001, 0.041515722781332205`}, {0.005, 0.0389683098138926}, {
      0.009000000000000001, 0.02373257733766946}, {0.013000000000000001`, 
      0.017847211056618087`}, {0.017, 0.014263612240087169`}, {0.021, 
      0.014263612240087169`}, {0.025, 0.010371911469438284`}, {0.029, 
      0.010371911469438284`}, {0.033, 0.010371911469438284`}, {
      0.037000000000000005`, 0.010371911469438284`}}]}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.037000000000000005`}, {0, 0.041515722781332205`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.809662517943945*^9, 3.809662633323244*^9, 
  3.80966283259988*^9, 3.809663093236961*^9, 3.809663859064937*^9, 
  3.8096645501356554`*^9, 3.8096734354122076`*^9, 3.8096737429140177`*^9, 
  3.8096738248665113`*^9, 3.8096755914020567`*^9, 3.809679575563177*^9, 
  3.809679897722167*^9, 3.8096805541138935`*^9, 3.8096808323822165`*^9, 
  3.809681470659363*^9, 3.8096888389109187`*^9, 3.809689134653553*^9, 
  3.809689311893379*^9, 3.8096898281193047`*^9, 3.8096901487233734`*^9, 
  3.8096903819969187`*^9, 3.8096905022490854`*^9, 3.8096939338462267`*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"2a026012-4fa5-410c-8e69-33a4a7cce143"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "TvsZ", "]"}]], "Input",
 CellChangeTimes->{{3.809662527592892*^9, 3.8096625377444744`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"bc215f32-3644-4058-b687-59c36b324ac9"],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{0.001, 0.7590205474491896}, {0.005, 0.754277022111707}, {
      0.009000000000000001, 0.6964553159658416}, {0.013000000000000001`, 
      0.6489573969387318}, {0.017, 0.6091384247331003}, {0.021, 
      0.6091384247331003}, {0.025, 0.557816232722396}, {0.029, 
      0.557816232722396}, {0.033, 0.557816232722396}, {0.037000000000000005`, 
      0.557816232722396}}]}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.5466382152375744},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.037000000000000005`}, {0.5466382152375744, 
    0.7590205474491896}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.809662539485987*^9, 3.8096626342864485`*^9, 
  3.809662855162986*^9, 3.8096630944944105`*^9, 3.8096638599236374`*^9, 
  3.8096645510520277`*^9, 3.8096734364848447`*^9, 3.8096737450110116`*^9, 
  3.8096738261710634`*^9, 3.8096755922951407`*^9, 3.8096795759209623`*^9, 
  3.8096798989961624`*^9, 3.8096805550224705`*^9, 3.809680832559699*^9, 
  3.8096814708360877`*^9, 3.809688839580715*^9, 3.8096891349244275`*^9, 
  3.809689312653932*^9, 3.80968982908209*^9, 3.809690148999079*^9, 
  3.8096903822761774`*^9, 3.8096905025521736`*^9, 3.809693934668759*^9},
 CellLabel->
  "Out[117]=",ExpressionUUID->"39073df7-53a1-4abd-9587-587b71e0f3d5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Inverse problem function", "Subsubsection",
 CellChangeTimes->{{3.808707535272849*^9, 
  3.808707564793468*^9}},ExpressionUUID->"63d1430e-28e4-4f9c-b363-\
1b5d1d1ed260"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Rm", "=", "0.1485"}], ";", "\[IndentingNewLine]", 
   RowBox[{"Tm", "=", "0.4996"}], ";", "\n", 
   RowBox[{"Clear", "[", "MM", "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MM", "[", 
     RowBox[{
      RowBox[{"A_", "?", "NumericQ"}], ",", 
      RowBox[{"T_", "?", "NumericQ"}], ",", 
      RowBox[{"G_", "?", "NumericQ"}], ",", 
      RowBox[{"Z_", "?", "NumericQ"}], ",", 
      RowBox[{"Rm_", "?", "NumericQ"}], ",", 
      RowBox[{"Tm_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MM", "[", 
      RowBox[{"A", ",", "T", ",", "G", ",", "Z", ",", "Rm", ",", "Tm"}], 
      "]"}], "=", 
     RowBox[{"Re", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"RcWB", "[", 
           RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "-", "Rm"}], 
         "]"}], 
        RowBox[{"Rm", "+", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]]}]], "+", 
       FractionBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"TcWB", "[", 
           RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "-", "Tm"}], 
         "]"}], 
        RowBox[{"Tm", "+", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]]}]]}], "]"}]}]}], ";", "\n", 
   RowBox[{
    StyleBox["Results", "Code"], 
    StyleBox["=", "Code"], 
    RowBox[{
     RowBox[{
      StyleBox[
       RowBox[{"NMinimize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MM", "[", 
            RowBox[{"A", ",", "T", ",", "G", ",", "0.0"}], "]"}], ",", 
           RowBox[{"0.9", "<", "A", "<", "1"}], ",", 
           RowBox[{"0", "<", "T"}], ",", 
           RowBox[{"0.7", "<", "G", "<", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"A", ",", "T", ",", "G"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", "\"\<NelderMead\>\"", "}"}]}]}], "]"}], "Code"], "\n", 
      "finalA"}], "=", 
     RowBox[{"A", "/.", 
      RowBox[{"Last", "[", "Results", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"finalT", "=", 
    RowBox[{"T", "/.", 
     RowBox[{"Last", "[", "Results", "]"}]}]}], ";", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"finalG", "=", 
      RowBox[{"G", "/.", 
       RowBox[{"Last", "[", "Results", "]"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"dTissue", "=", 
    RowBox[{"1.049", "\[Times]", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}]}], ";", "\n", 
   RowBox[{
    RowBox[{"\[Mu]s", "[", 
     RowBox[{
      RowBox[{"A_", "?", "NumericQ"}], ",", 
      RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"\[Mu]s", "[", 
      RowBox[{"A", ",", "T"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["T", "dTissue"], "\[Times]", "A", "\[IndentingNewLine]", 
       RowBox[{"\[Mu]a", "[", 
        RowBox[{
         RowBox[{"A_", "?", "NumericQ"}], ",", 
         RowBox[{"T_", "?", "NumericQ"}]}], "]"}]}], ":=", 
      RowBox[{
       RowBox[{"\[Mu]a", "[", 
        RowBox[{"A", ",", "T"}], "]"}], "=", 
       RowBox[{
        FractionBox["T", "dTissue"], "\[Times]", 
        RowBox[{"(", 
         RowBox[{"1", "-", "A"}], ")"}], "\[IndentingNewLine]", 
        "finalG"}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.794209767481742*^9, 3.7942097741690116`*^9}, 
   3.7942106493056517`*^9, {3.794212841668607*^9, 3.794212886231507*^9}, {
   3.7942139220353403`*^9, 3.7942139338197966`*^9}, {3.7942139992438855`*^9, 
   3.794214004291936*^9}, {3.7942161039675703`*^9, 3.794216117527239*^9}, {
   3.794224094920535*^9, 3.794224098890295*^9}, {3.7942267674149733`*^9, 
   3.794226779760547*^9}, {3.794306914283136*^9, 3.794306929689377*^9}, {
   3.808624777775443*^9, 3.808624801297995*^9}, {3.80862501546024*^9, 
   3.8086250228216133`*^9}, {3.8086277543188915`*^9, 
   3.8086277747365713`*^9}, {3.8086429193509936`*^9, 3.808642931693287*^9}, {
   3.808645955875328*^9, 3.8086459733412395`*^9}, {3.8086463072395077`*^9, 
   3.808646314874437*^9}, {3.809079079605542*^9, 3.809079097596387*^9}, {
   3.8090798117917023`*^9, 3.8090798243907776`*^9}, {3.8090803924405107`*^9, 
   3.8090804063554296`*^9}, {3.809664379561267*^9, 3.8096643974525547`*^9}, {
   3.80967376872058*^9, 3.8096737723149376`*^9}, {3.8096814301757326`*^9, 
   3.8096814397360344`*^9}, {3.809687855071701*^9, 3.8096878960196505`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"94c6538f-a965-4e17-bc81-538db5c7ad75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataR", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\<C:\\\\Users\\\\tatki\\\\Documents\\\\PHOTONICS\\\\Biophotonics\\\\\
Integrating spheres\\\\25.02.20 Milk\\\\PvsLL1.dat\>\"", ",", 
     "\"\<Data\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataT", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\<C:\\\\Users\\\\tatki\\\\Documents\\\\PHOTONICS\\\\Biophotonics\\\\\
Integrating spheres\\\\25.02.20 Milk\\\\PvsLU1.dat\>\"", ",", 
     "\"\<Data\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataR", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"dataR", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[Times]", "0.001"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataT", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"dataT", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[Times]", "0.001"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dTissue", "=", 
   RowBox[{"1.094", "\[Times]", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8090769100133095`*^9, 3.8090769641733603`*^9}, {
  3.8096634045357323`*^9, 3.809663418399186*^9}, {3.809682217881535*^9, 
  3.809682250965076*^9}, {3.809682295944058*^9, 3.8096823045979323`*^9}, {
  3.8096881568920975`*^9, 3.809688168297557*^9}, {3.809689679272921*^9, 
  3.809689734457526*^9}, {3.809690041185046*^9, 3.809690041787422*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"6c80ab73-a5b6-4d5a-8fce-64cda3855a8e"],

Cell[CellGroupData[{

Cell[BoxData["dataR"], "Input",
 CellChangeTimes->{{3.8096897799470277`*^9, 3.809689782465389*^9}, 
   3.8096900441282825`*^9, 3.8096901017634454`*^9},
 CellLabel->
  "In[124]:=",ExpressionUUID->"fae0230b-b662-4e5c-aa04-292651083cb7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.14848953409722138`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.004`", ",", "0.05044644614793796`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.008`", ",", "0.02703375101745186`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.012`", ",", "0.015300219467177585`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.016`", ",", "0.010218374678281043`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.02`", ",", "0.007007511754511711`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.024`", ",", "0.0054416255070807015`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.028`", ",", "0.004189418717953946`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.032`", ",", "0.003584850589842263`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.036000000000000004`", ",", "0.003067884573831858`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8096897847046633`*^9, 3.809689830422988*^9, 
  3.8096901036556664`*^9, 3.8096901501821775`*^9, 3.809690383331485*^9, 
  3.80969050369732*^9, 3.809693935487501*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"d4d6719a-9493-448a-9880-abe35ba40eb0"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ResultsTable", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "dataR", "]"}], ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MM", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}], ",", 
     RowBox[{"G_", "?", "NumericQ"}], ",", 
     RowBox[{"Z_", "?", "NumericQ"}], ",", 
     RowBox[{"Rm_", "?", "NumericQ"}], ",", 
     RowBox[{"Tm_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MM", "[", 
     RowBox[{"A", ",", "T", ",", "G", ",", "Z", ",", "Rm", ",", "Tm"}], "]"}],
     "=", 
    RowBox[{"Re", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"RcWB", "[", 
          RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "-", "Rm"}], 
        "]"}], 
       RowBox[{"Rm", "+", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]], "+", 
      FractionBox[
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"TcWB", "[", 
          RowBox[{"A", ",", "T", ",", "G", ",", "Z"}], "]"}], "-", "Tm"}], 
        "]"}], 
       RowBox[{"Tm", "+", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]s", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Mu]s", "[", 
     RowBox[{"A", ",", "T"}], "]"}], "=", 
    RowBox[{
     FractionBox["T", "dTissue"], "\[Times]", "A"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]a", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Mu]a", "[", 
     RowBox[{"A", ",", "T"}], "]"}], "=", 
    RowBox[{
     FractionBox["T", "dTissue"], "\[Times]", 
     RowBox[{"(", 
      RowBox[{"1", "-", "A"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.80968239314042*^9, 3.8096824321248074`*^9}, {
   3.8096825171522264`*^9, 3.809682551041957*^9}, {3.8096827097452173`*^9, 
   3.8096827479492297`*^9}, {3.809682921825248*^9, 3.8096829254392323`*^9}, {
   3.8096829622019353`*^9, 3.8096830634280415`*^9}, 3.8096836966116257`*^9, {
   3.809687911092988*^9, 3.8096879284082766`*^9}, {3.809688144791342*^9, 
   3.809688150742523*^9}, {3.809688937964937*^9, 3.8096889410214252`*^9}, {
   3.8096889783856173`*^9, 3.809688979219988*^9}, {3.8096900599247584`*^9, 
   3.8096900803864307`*^9}, {3.809690189765196*^9, 3.809690202669586*^9}, {
   3.809690328677703*^9, 3.8096903475143967`*^9}, {3.8096904182206945`*^9, 
   3.8096904287334776`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"997273c5-b199-4b87-834c-c0a987e41608"],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", 
   RowBox[{"NMinimize", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MM", "[", 
        RowBox[{"A", ",", " ", "T", ",", " ", "G", ",", " ", "0.0", ",", " ", 
         RowBox[{"dataR", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
         RowBox[{"dataT", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
       RowBox[{"0.9", " ", "<", " ", "A", " ", "<", " ", "1"}], ",", " ", 
       RowBox[{"0", " ", "<", " ", "T"}], ",", " ", 
       RowBox[{"0.7", " ", "<", " ", "G", " ", "<", " ", "1"}]}], " ", "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"A", ",", " ", "T", ",", " ", "G"}], "}"}], ",", " ", 
     RowBox[{"Method", " ", "\[Rule]", " ", 
      RowBox[{"{", "\"\<NelderMead\>\"", "}"}]}]}], "]"}], "*)"}], 
  "Code"]], "Input",
 CellChangeTimes->{{3.809689363391062*^9, 3.809689417153274*^9}, {
   3.809689464874584*^9, 3.809689502878642*^9}, {3.809689559825635*^9, 
   3.809689645559037*^9}, 3.8096900534475536`*^9},
 CellLabel->
  "In[129]:=",ExpressionUUID->"36572fa2-23fe-48bb-89e3-c106b2277bb0"],

Cell["First row: z = 0", "Text",
 CellChangeTimes->{{3.8096879329551177`*^9, 
  3.8096879474144216`*^9}},ExpressionUUID->"7bb96ac7-6347-4791-a4bc-\
9019220abb49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Results0", "=", 
   StyleBox[
    RowBox[{"NMinimize", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MM", "[", 
         RowBox[{"A", ",", " ", "T", ",", " ", "G", ",", " ", "0.0", ",", " ", 
          RowBox[{"dataR", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
          RowBox[{"dataT", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"0.9", " ", "<", " ", "A", " ", "<", " ", "1"}], ",", " ", 
        RowBox[{"0", " ", "<", " ", "T"}], ",", " ", 
        RowBox[{"0.7", " ", "<", " ", "G", " ", "<", " ", "1"}]}], " ", "}"}],
       ",", " ", 
      RowBox[{"{", 
       RowBox[{"A", ",", " ", "T", ",", " ", "G"}], "}"}], ",", " ", 
      RowBox[{"Method", " ", "\[Rule]", " ", 
       RowBox[{"{", "\"\<NelderMead\>\"", "}"}]}]}], "]"}], "Code"]}], 
  StyleBox[";", "Code"]}]], "Input",
 CellChangeTimes->{{3.809687960953534*^9, 3.809688126759464*^9}, {
   3.809688187913329*^9, 3.8096883122956376`*^9}, {3.809688526343296*^9, 
   3.8096885791005526`*^9}, {3.809689072777338*^9, 3.809689075441758*^9}, 
   3.8096892252136416`*^9, {3.80969023363181*^9, 3.8096902443260098`*^9}, {
   3.809690309528183*^9, 3.80969032154347*^9}, {3.809693601469715*^9, 
   3.809693602357463*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"26c6a0b1-4118-4680-a9fb-9435e0ff8d68"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"ResultsTable", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], "=", 
    RowBox[{"\[Mu]s", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"A", 
        StyleBox[
         RowBox[{"/", "."}]], 
        RowBox[{"Last", "[", "Results0", "]"}]}], ")"}], ",", " ", 
      RowBox[{"(", 
       RowBox[{"T", 
        StyleBox[
         RowBox[{"/", "."}]], 
        RowBox[{"Last", "[", "Results0", "]"}]}], ")"}]}], "]"}]}], "Code"], 
  StyleBox[";", "Code"], 
  RowBox[{
   StyleBox[
    RowBox[{"ResultsTable", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], "Code"], 
   StyleBox["=", "Code"], 
   RowBox[{
    StyleBox["\[Mu]a", "Code"], "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"A", "/.", 
       RowBox[{"Last", "[", "Results0", "]"}]}], ")"}], ",", " ", 
     RowBox[{"(", 
      RowBox[{"T", "/.", 
       RowBox[{"Last", "[", "Results0", "]"}]}], ")"}]}], "]"}]}], ";", " ", 
  RowBox[{
   RowBox[{"ResultsTable", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"NumberForm", "[", 
    RowBox[{
     RowBox[{"G", "/.", 
      RowBox[{"Last", "[", "Results0", "]"}]}], ",", "3"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8096935676264477`*^9, 3.809693690054023*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"47ef7248-39c1-485d-b854-bb71dc089f4b"],

Cell[CellGroupData[{

Cell[BoxData["ResultsTable"], "Input",
 CellChangeTimes->{{3.8096938076439667`*^9, 3.8096938097595835`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"3ac357a3-c05b-40d4-a2ad-b370eff461e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1973.8859484658801`", ",", "119.99734051287756`", ",", 
     TagBox[
      InterpretationBox["\<\"0.702\"\>",
       0.7017231865509843,
       AutoDelete->True],
      NumberForm[#, 3]& ]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8096938103519073`*^9, 3.8096938833772936`*^9, 
  3.809694195494282*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"098a2ccd-eb54-4ff0-a9a7-433427749904"]
}, Open  ]],

Cell["Next rows: z!=0", "Text",
 CellChangeTimes->{{3.8096883174913054`*^9, 
  3.8096883303506517`*^9}},ExpressionUUID->"faed4313-cca7-4246-8bb8-\
40cda7edbce5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MM", "[", 
  RowBox[{"a", ",", "\[Tau]", ",", " ", 
   RowBox[{"G", "/.", 
    RowBox[{"Last", "[", "Results0", "]"}]}], ",", " ", "0.004", ",", " ", 
   RowBox[{"dataR", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
   RowBox[{"dataT", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", " ", "2"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8096943991438675`*^9, 3.809694428322832*^9}, {
  3.8096945263539524`*^9, 3.8096945853967357`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"3d0a0f58-24e3-4dcb-9b1e-68e07d914e33"],

Cell[BoxData["2.2843826471954936`"], "Output",
 CellChangeTimes->{{3.8096944113872595`*^9, 3.809694430244135*^9}, {
  3.8096945283372283`*^9, 3.8096945871271954`*^9}},
 CellLabel->
  "Out[142]=",ExpressionUUID->"bd1f532b-2ed6-4f4c-aca7-ef6834712dbe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "2"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"Results", "=", 
      StyleBox[
       RowBox[{"NMinimize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MM", "[", 
            RowBox[{"A", ",", " ", "T", ",", " ", "G", ",", " ", 
             RowBox[{"0.004", "\[Times]", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], ",", " ", 
             RowBox[{"dataR", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
             RowBox[{"dataT", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{"0.9", " ", "<", " ", "A", " ", "<", " ", "1"}], ",", " ", 
           RowBox[{"0", " ", "<", " ", "T"}], ",", " ", 
           RowBox[{"0.7", " ", "<", " ", "G", " ", "<", " ", "1"}]}], "}"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"A", ",", " ", "T", ",", " ", "G"}], "}"}], ",", " ", 
         RowBox[{"Method", " ", "\[Rule]", " ", 
          RowBox[{"{", "\"\<NelderMead\>\"", "}"}]}]}], "]"}], "Code"]}], 
     StyleBox[";", "Code"], 
     StyleBox[" ", "Code"], 
     StyleBox[
      RowBox[{
       RowBox[{"ResultsTable", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "=", 
       RowBox[{"\[Mu]s", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"A", 
           StyleBox[
            RowBox[{"/", "."}]], 
           RowBox[{"Last", "[", "Results", "]"}]}], ")"}], ",", " ", 
         RowBox[{"(", 
          RowBox[{"T", 
           StyleBox[
            RowBox[{"/", "."}]], 
           RowBox[{"Last", "[", "Results", "]"}]}], ")"}]}], "]"}]}], "Code"], 
     StyleBox[";", "Code"], 
     StyleBox[
      RowBox[{
       RowBox[{"ResultsTable", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "=", 
       RowBox[{"\[Mu]a", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"A", "/.", 
           RowBox[{"Last", "[", "Results", "]"}]}], ")"}], ",", " ", 
         RowBox[{"(", 
          RowBox[{"T", 
           StyleBox[
            RowBox[{"/", "."}]], 
           RowBox[{"Last", "[", "Results", "]"}]}], ")"}]}], "]"}]}], "Code"], 
     StyleBox[";", "Code"], 
     StyleBox[" ", "Code"], 
     StyleBox[
      RowBox[{
       RowBox[{"ResultsTable", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "=", " ", 
       RowBox[{"(", 
        RowBox[{"G", 
         StyleBox[
          RowBox[{"/", "."}]], 
         RowBox[{"Last", "[", "Results", "]"}]}], ")"}]}], "Code"], 
     StyleBox[";", "Code"], 
     StyleBox[
      RowBox[{"ClearAll", "[", "Results", "]"}], "Code"]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.809688340512432*^9, 3.8096884684773283`*^9}, {
   3.8096885874108014`*^9, 3.809688660654626*^9}, {3.8096886914276695`*^9, 
   3.809688770483621*^9}, {3.8096890195916195`*^9, 3.8096890234436054`*^9}, {
   3.809689082630452*^9, 3.8096890859066086`*^9}, {3.8096902504800406`*^9, 
   3.8096902993264623`*^9}, {3.809693712098464*^9, 3.809693742201805*^9}, {
   3.8096942464409904`*^9, 3.8096942498174334`*^9}, 3.80969460400565*^9, {
   3.809700339381767*^9, 3.8097004278594384`*^9}, {3.8097004891988525`*^9, 
   3.809700489686404*^9}, {3.8097009191669464`*^9, 3.8097009254371243`*^9}, 
   3.809701781560547*^9},ExpressionUUID->"070d6128-7432-4bf2-ba12-\
f116dcd2d4de"],

Cell[BoxData[
 TemplateBox[{
  "NMinimize", "cvmit", 
   "\"Failed to converge to the requested accuracy or precision within \\!\\(\
\\*RowBox[{\\\"100\\\"}]\\) iterations.\"", 2, 157, 17, 26756153774950139605, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.809700457088904*^9, 3.8097005160648117`*^9, 
  3.8097009513111067`*^9},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"2b05c717-1e25-44d4-b8e8-b311164ca398"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.809701773822105*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"3d08439d-9171-44f8-ae56-e3329a48f314"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ResultsTable", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.809700472170067*^9, 3.809700480612291*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"ddf02394-1bc8-412c-b88b-02ec2a65a28e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"5835.731480954856`", "502.13442268891924`", "0.8834737587108017`"},
     {"4803.473535325611`", "484.7801857026285`", "0.8315598182763477`"},
     {"5871.629238826486`", "438.7253716613785`", "0.8698168521160475`"},
     {"5173.121094154181`", "414.6889344511782`", "0.8528491995579156`"},
     {"5269.752367707434`", "580.8630503150964`", "0.8563265264503483`"},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8097004815817223`*^9, 3.8097009076095686`*^9},
 CellLabel->
  "Out[156]//MatrixForm=",ExpressionUUID->"105b41b7-3def-45a7-9085-\
234f110aaefb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"NMinimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MM", "[", 
       RowBox[{"A", ",", " ", "T", ",", " ", "G", ",", " ", "0", ",", " ", 
        RowBox[{"dataR", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"dataT", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"0.9", " ", "<", " ", "A", " ", "<", " ", "1"}], ",", " ", 
      RowBox[{"0", " ", "<", " ", "T"}], ",", " ", 
      RowBox[{"0.7", " ", "<", " ", "G", " ", "<", " ", "1"}]}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"A", ",", " ", "T", ",", " ", "G"}], "}"}], ",", " ", 
    RowBox[{"Method", " ", "\[Rule]", " ", 
     RowBox[{"{", "\"\<NelderMead\>\"", "}"}]}]}], "]"}], "Code"]], "Input",
 CellChangeTimes->{{3.809698942493092*^9, 3.809698951207756*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"72221ebd-f7f1-4612-9337-c84abd9a7101"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.7226319632987332`*^-8", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", "0.9426914856503757`"}], ",", 
     RowBox[{"T", "\[Rule]", "2.290708318142761`"}], ",", 
     RowBox[{"G", "\[Rule]", "0.7017231865509843`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8096989694438887`*^9},
 CellLabel->
  "Out[151]=",ExpressionUUID->"f9c6fe99-08be-4660-acc6-d8d60932018b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"NMinimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MM", "[", 
       RowBox[{"A", ",", " ", "T", ",", " ", "G", ",", " ", "0.004", ",", " ", 
        RowBox[{"dataR", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"dataT", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"0.9", " ", "<", " ", "A", " ", "<", " ", "1"}], ",", " ", 
      RowBox[{"0", " ", "<", " ", "T"}], ",", " ", 
      RowBox[{"0.7", " ", "<", " ", "G", " ", "<", " ", "1"}]}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"A", ",", " ", "T", ",", " ", "G"}], "}"}], ",", " ", 
    RowBox[{"Method", " ", "\[Rule]", " ", 
     RowBox[{"{", "\"\<NelderMead\>\"", "}"}]}]}], "]"}], "Code"]], "Input",
 CellChangeTimes->{{3.809696613319457*^9, 3.809696618399587*^9}, {
  3.8096975210543003`*^9, 3.809697527971341*^9}, {3.809697560801257*^9, 
  3.8096975838162937`*^9}, {3.8096979758092074`*^9, 3.809697986084638*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"3e101dd3-97a5-43b7-81fb-24c9ed8831fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.085564908219517`*^-9", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", "0.9207723182656434`"}], ",", 
     RowBox[{"T", "\[Rule]", "6.933625298586291`"}], ",", 
     RowBox[{"G", "\[Rule]", "0.8834737587108017`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.809696632297456*^9, 3.809697545242157*^9, 
  3.8096978095811014`*^9, 3.8096982337345514`*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"aed14998-1466-48fe-8c7f-9bbcd3d4507a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"NMinimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MM", "[", 
       RowBox[{"A", ",", " ", "T", ",", " ", "G", ",", " ", "0.008", ",", " ", 
        RowBox[{"dataR", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"dataT", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", " ", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"0.9", " ", "<", " ", "A", " ", "<", " ", "1"}], ",", " ", 
      RowBox[{"0", " ", "<", " ", "T"}], ",", " ", 
      RowBox[{"0.7", " ", "<", " ", "G", " ", "<", " ", "1"}]}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"A", ",", " ", "T", ",", " ", "G"}], "}"}], ",", " ", 
    RowBox[{"Method", " ", "\[Rule]", " ", 
     RowBox[{"{", "\"\<NelderMead\>\"", "}"}]}]}], "]"}], "Code"]], "Input",
 CellChangeTimes->{
  3.8096974999380245`*^9, {3.809698263612472*^9, 3.809698281200715*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"fc2ef3c8-9890-443a-9e0f-4024aed9f296"],

Cell[BoxData[
 TemplateBox[{
  "NMinimize", "cvmit", 
   "\"Failed to converge to the requested accuracy or precision within \\!\\(\
\\*RowBox[{\\\"100\\\"}]\\) iterations.\"", 2, 148, 14, 26756153774950139605, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8096983218969746`*^9},
 CellLabel->
  "During evaluation of \
In[148]:=",ExpressionUUID->"2d0d560f-b460-413b-af3d-7847bb278cfd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.588735182456216`*^-8", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", "0.9083288716320577`"}], ",", 
     RowBox[{"T", "\[Rule]", "5.785349570804895`"}], ",", 
     RowBox[{"G", "\[Rule]", "0.8315598182763477`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.809698321965269*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"9abb9e84-3025-4a84-8e52-527f7612b6ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"NMinimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MM", "[", 
       RowBox[{"A", ",", " ", "T", ",", " ", "G", ",", " ", "0.012", ",", " ", 
        RowBox[{"dataR", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"dataT", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", " ", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"0.9", " ", "<", " ", "A", " ", "<", " ", "1"}], ",", " ", 
      RowBox[{"0", " ", "<", " ", "T"}], ",", " ", 
      RowBox[{"0.7", " ", "<", " ", "G", " ", "<", " ", "1"}]}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"A", ",", " ", "T", ",", " ", "G"}], "}"}], ",", " ", 
    RowBox[{"Method", " ", "\[Rule]", " ", 
     RowBox[{"{", "\"\<NelderMead\>\"", "}"}]}]}], "]"}], "Code"]], "Input",
 CellChangeTimes->{{3.8096982877564316`*^9, 3.8096982940723753`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"82bc2cb7-509a-49f2-bf70-6fe795b045d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.1127150505857355`*^-8", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", "0.9304753221107078`"}], ",", 
     RowBox[{"T", "\[Rule]", "6.9035279438737245`"}], ",", 
     RowBox[{"G", "\[Rule]", "0.8698168521160475`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.809698648951115*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"ef4aea1e-1556-4c12-b9d4-6b19e4a36ede"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"NMinimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MM", "[", 
       RowBox[{"A", ",", " ", "T", ",", " ", "G", ",", " ", "0.016", ",", " ", 
        RowBox[{"dataR", "[", 
         RowBox[{"[", 
          RowBox[{"5", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"dataT", "[", 
         RowBox[{"[", 
          RowBox[{"5", ",", " ", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"0.9", " ", "<", " ", "A", " ", "<", " ", "1"}], ",", " ", 
      RowBox[{"0", " ", "<", " ", "T"}], ",", " ", 
      RowBox[{"0.7", " ", "<", " ", "G", " ", "<", " ", "1"}]}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"A", ",", " ", "T", ",", " ", "G"}], "}"}], ",", " ", 
    RowBox[{"Method", " ", "\[Rule]", " ", 
     RowBox[{"{", "\"\<NelderMead\>\"", "}"}]}]}], "]"}], "Code"]], "Input",
 CellChangeTimes->{{3.809698299704954*^9, 3.8096983056597214`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"75db64d3-7feb-4332-9ba9-21d7b851eba4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.2860672375591356`*^-9", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", "0.9257868588358794`"}], ",", 
     RowBox[{"T", "\[Rule]", "6.113064171294264`"}], ",", 
     RowBox[{"G", "\[Rule]", "0.8528491995579156`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8096988789881306`*^9},
 CellLabel->
  "Out[150]=",ExpressionUUID->"869c2950-c912-4ec8-9548-2afcfde54d6b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"NMinimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MM", "[", 
       RowBox[{"A", ",", " ", "T", ",", " ", "G", ",", " ", "0.02", ",", " ", 
        RowBox[{"dataR", "[", 
         RowBox[{"[", 
          RowBox[{"6", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"dataT", "[", 
         RowBox[{"[", 
          RowBox[{"6", ",", " ", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"0.9", " ", "<", " ", "A", " ", "<", " ", "1"}], ",", " ", 
      RowBox[{"0", " ", "<", " ", "T"}], ",", " ", 
      RowBox[{"0.7", " ", "<", " ", "G", " ", "<", " ", "1"}]}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"A", ",", " ", "T", ",", " ", "G"}], "}"}], ",", " ", 
    RowBox[{"Method", " ", "\[Rule]", " ", 
     RowBox[{"{", "\"\<NelderMead\>\"", "}"}]}]}], "]"}], "Code"]], "Input",
 CellChangeTimes->{{3.809699006452237*^9, 3.8096990138100147`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"f6c63786-ce5d-4b06-b336-955a40745423"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.8561858636134239`*^-9", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", "0.9007176153596121`"}], ",", 
     RowBox[{"T", "\[Rule]", "6.400573267316648`"}], ",", 
     RowBox[{"G", "\[Rule]", "0.8563265264503483`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.809699243473716*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"fce6c4e8-5f99-41cf-8655-347e737d822d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ResultsTable", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8096887821241007`*^9, 3.8096887902054615`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"c46a1eff-cbde-4e09-88a4-51ab56bbbc6d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]},
     {"1973.8859484658801`", "119.99734051287756`", 
      TagBox[
       InterpretationBox["\<\"0.702\"\>",
        0.7017231865509843,
        AutoDelete->True],
       NumberForm[#, 3]& ]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8096888438679466`*^9, 3.809689139381319*^9, 
  3.8096893164905043`*^9, 3.809689834844446*^9, 3.809690153100606*^9, 
  3.8096941966365213`*^9},
 CellLabel->
  "Out[134]//MatrixForm=",ExpressionUUID->"0fcdecba-a988-435b-9bc0-\
f7319305e257"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"54d68711-d54b-48aa-b612-635fe5721066"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 167, 2, 48, "Input",ExpressionUUID->"20f709a7-7a41-4259-b3c2-467ca2c47923"],
Cell[728, 24, 343, 7, 103, "Input",ExpressionUUID->"d81f1174-77ce-4fe7-b596-1f00bd956dc7"],
Cell[CellGroupData[{
Cell[1096, 35, 285, 4, 45, "Subsubsection",ExpressionUUID->"d519455e-0b36-4280-9190-f215ccc3f881",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[1384, 41, 242, 4, 44, "Subsubsection",ExpressionUUID->"694beab7-4b88-415a-920b-82b7893d9c7c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[1629, 47, 5041, 70, 28, "Input",ExpressionUUID->"6887370b-353b-497e-9c6f-276c7187256e",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[6673, 119, 287, 5, 44, "Subsubsection",ExpressionUUID->"eb9c8c74-393e-4861-b6ca-e62bd5cdde48",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[6963, 126, 697, 11, 28, "Input",ExpressionUUID->"671145ce-ea1d-417e-ac85-f6d9e5c5c13b",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[7663, 139, 250, 4, 44, "Subsubsection",ExpressionUUID->"52bec5da-a39c-49d7-8e97-8193123fbf6e",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[7916, 145, 649, 10, 28, "Input",ExpressionUUID->"b57f65c9-4f1c-4730-a8f6-f08325246818",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[8568, 157, 241, 4, 44, "Subsubsection",ExpressionUUID->"c58a06f3-61f7-46dc-b2ea-83036280b69a",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[8812, 163, 694, 11, 28, "Input",ExpressionUUID->"000d24e0-33fa-469e-885f-d9c1550a993a",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[9509, 176, 247, 4, 44, "Subsubsection",ExpressionUUID->"69f71f7b-9a00-4452-9043-7455380949c3",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[9759, 182, 2195, 32, 48, "Input",ExpressionUUID->"8b5011b4-377b-4e96-ad7d-7202c6962194",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[11991, 219, 331, 5, 53, "Subsection",ExpressionUUID->"0eed2f7b-bbc1-4993-ab8a-2601271871f9",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[12325, 226, 342, 5, 44, "Subsubsection",ExpressionUUID->"1c705d03-6123-43e2-bf7f-07fe5da1da67",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[12670, 233, 2013, 31, 28, "Input",ExpressionUUID->"f8c1d41d-f3f2-4e31-ad2e-16c201f2e87f",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[14686, 266, 316, 5, 44, "Subsubsection",ExpressionUUID->"25bad7e0-f952-4ff3-a214-1f7d9a807834",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[15005, 273, 619, 14, 65, "Input",ExpressionUUID->"72add1d9-dec3-45a2-af8d-f4470ee1a451",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[15661, 292, 206, 3, 45, "Subsubsection",ExpressionUUID->"6eb33064-2449-4e72-9988-7a7c448cfe26"],
Cell[CellGroupData[{
Cell[15892, 299, 312, 5, 39, "Text",ExpressionUUID->"4c76fbee-94ee-4a17-9c50-927af131001a",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[16207, 306, 926, 16, 61, "Input",ExpressionUUID->"781199c4-9943-4ca8-9466-7fbd8374e988",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[17170, 327, 272, 4, 39, "Text",ExpressionUUID->"dd0c4002-330a-44db-9839-bb3573db72f1",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[17445, 333, 600, 11, 45, "Input",ExpressionUUID->"2cd351c7-0ae9-4755-b624-1a682e2507c2",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}]
}, Open  ]],
Cell[18060, 347, 597, 14, 39, "Text",ExpressionUUID->"70bb1b81-275c-4231-83be-efc3b67e834f",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}],
Cell[18660, 363, 842, 21, 119, "Input",ExpressionUUID->"8a85041f-b93e-4184-bac0-1a41abb2717b"],
Cell[19505, 386, 602, 14, 39, "Text",ExpressionUUID->"05729207-cd82-46b3-a584-87d45f92b060",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}],
Cell[20110, 402, 595, 13, 45, "Input",ExpressionUUID->"9afad9d4-89a5-407c-bd46-263b21bf4d22"],
Cell[20708, 417, 701, 19, 53, "Input",ExpressionUUID->"814b11b5-8dea-44a0-9488-87bad1bd3c22"],
Cell[21412, 438, 401, 12, 59, "Input",ExpressionUUID->"d68c6c8f-bc26-49a4-8f5b-1d60ee3bbdcd"],
Cell[21816, 452, 1207, 27, 45, "Input",ExpressionUUID->"68fbd410-2ef5-4111-9dc9-3f7ec8263816"],
Cell[23026, 481, 1158, 27, 62, "Input",ExpressionUUID->"a2b54de5-ac9b-4bb5-9799-af9e3eebd685"],
Cell[24187, 510, 1653, 42, 73, "Input",ExpressionUUID->"ca28fafc-897d-44b7-9ebb-b9a69c1dbf1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25877, 557, 186, 3, 44, "Subsubsection",ExpressionUUID->"a33cf8c2-e500-4e14-96dd-317c1fbd9fd6"],
Cell[26066, 562, 957, 22, 119, "Input",ExpressionUUID->"40bdede1-faf4-452c-872b-7a7ac6797412"],
Cell[CellGroupData[{
Cell[27048, 588, 938, 25, 99, "Input",ExpressionUUID->"6433d9c2-1c81-4a7f-bfa2-1d211e79b7ee"],
Cell[27989, 615, 2515, 38, 52, "Output",ExpressionUUID->"260a8406-1fb1-4358-b7ce-42aa93590eba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30541, 658, 456, 11, 45, "Input",ExpressionUUID->"3a1a97b5-b0bf-4093-80cd-51b1d78e472b"],
Cell[31000, 671, 2498, 39, 52, "Output",ExpressionUUID->"17d68501-2e41-464e-8d40-8d74b7516c9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33535, 715, 451, 11, 45, "Input",ExpressionUUID->"cb78daac-55f5-4654-b657-f6b417545792"],
Cell[33989, 728, 1770, 28, 40, "Message",ExpressionUUID->"29e98c34-07e3-4344-b4b2-4fabf3062753"],
Cell[35762, 758, 2509, 38, 52, "Output",ExpressionUUID->"e1bf17be-03a2-44ce-8d6c-e002ddad8f46"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38320, 802, 215, 4, 52, "Subsection",ExpressionUUID->"747a9117-1392-44e6-8d16-4fe4c1f2ab28"],
Cell[CellGroupData[{
Cell[38560, 810, 170, 3, 44, "Subsubsection",ExpressionUUID->"7c690763-f722-4f32-b816-5bc560e2ed2a"],
Cell[38733, 815, 785, 17, 32, "Input",ExpressionUUID->"6315404c-9194-41c6-abf0-1a30400b8bf6"],
Cell[39521, 834, 925, 21, 50, "Input",ExpressionUUID->"9e7c42a5-f726-4fdf-ad64-8d60624eb8fa"],
Cell[40449, 857, 470, 13, 34, "Text",ExpressionUUID->"ef7b3a00-4652-41cd-940c-370daa86b062"],
Cell[40922, 872, 535, 14, 34, "Text",ExpressionUUID->"a5f32691-2d8e-4b3b-babd-c6772b82d34c"],
Cell[CellGroupData[{
Cell[41482, 890, 2797, 65, 107, "Input",ExpressionUUID->"8fc6817d-1678-4f77-b655-da21929158fe"],
Cell[44282, 957, 4800, 66, 32, "Output",ExpressionUUID->"92cc997c-04d4-4729-a1ce-175e315814b1"]
}, Open  ]],
Cell[49097, 1026, 939, 20, 47, "Input",ExpressionUUID->"d8b7cad3-84ec-4ad6-bc20-54b77245eaf1"],
Cell[50039, 1048, 1001, 21, 48, "Input",ExpressionUUID->"007300fb-96db-49d7-b532-d4e81b2dfdf0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51077, 1074, 212, 4, 39, "Subsubsection",ExpressionUUID->"3a760808-de01-433a-98e4-e006b79c6325"],
Cell[51292, 1080, 827, 21, 50, "Input",ExpressionUUID->"b737892d-deef-4b77-b00a-53ce6047b8f9"],
Cell[52122, 1103, 4162, 96, 215, "Input",ExpressionUUID->"8fe78ed5-06bd-42a1-8a24-6b7e0b299d23"],
Cell[56287, 1201, 1888, 25, 28, "Input",ExpressionUUID->"9d65ffd7-d750-455c-bd1f-1c574032234e"],
Cell[58178, 1228, 5779, 151, 251, "Input",ExpressionUUID->"75999204-7aa5-489c-a8fa-a4f9c43ef698"],
Cell[63960, 1381, 295, 5, 28, "Input",ExpressionUUID->"7407133a-c5c5-4422-a645-b0195f9bbf2c"],
Cell[64258, 1388, 877, 15, 28, "Input",ExpressionUUID->"2432e5b0-d967-4a7e-a285-a8eee7ad5b35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65172, 1408, 172, 3, 44, "Subsubsection",ExpressionUUID->"d4c56b0a-14fb-4a52-9a39-9af9ec80d8c9"],
Cell[65347, 1413, 462, 8, 45, "Input",ExpressionUUID->"01011968-6dd9-4355-9ebf-2de9605891f5"],
Cell[65812, 1423, 2376, 48, 65, "Input",ExpressionUUID->"5dba3e14-6dc9-4ce1-ad58-10cb8aad75ca"],
Cell[68191, 1473, 2435, 55, 65, "Input",ExpressionUUID->"2b9406ab-9037-448f-92f0-0551c8d6f3e5"],
Cell[70629, 1530, 814, 17, 45, "Input",ExpressionUUID->"040b75b7-ab05-490c-bcd0-b1c9bae74112"],
Cell[71446, 1549, 1277, 28, 45, "Input",ExpressionUUID->"d0325f8c-df1f-4454-a1c8-14dff315b870"],
Cell[72726, 1579, 1133, 24, 28, "Input",ExpressionUUID->"0000b52c-6dc8-4fac-9aa0-a12f5af15ef0"],
Cell[73862, 1605, 1054, 22, 28, "Input",ExpressionUUID->"b5c78a7e-1384-4cbe-9e71-3a452a088dcf"],
Cell[74919, 1629, 476, 9, 28, "Input",ExpressionUUID->"6127a884-394f-43a8-9b58-9a9b9eaff7c0"],
Cell[75398, 1640, 188, 4, 28, "Input",ExpressionUUID->"38868958-868b-4ab2-a3ce-90b2d63d2db8"],
Cell[75589, 1646, 2346, 57, 124, "Input",ExpressionUUID->"1e118888-887b-4ce7-bd74-5048584f8eba"],
Cell[77938, 1705, 173, 2, 28, "Input",ExpressionUUID->"289b870e-5fe8-4862-bda9-f71dc03445ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78148, 1712, 196, 3, 44, "Subsubsection",ExpressionUUID->"effe496d-edb8-456a-bc8d-37afa8aa0bb3"],
Cell[78347, 1717, 781, 14, 100, "Input",ExpressionUUID->"b5d440df-9b4a-4795-9d55-c0e8615dc5d8"],
Cell[79131, 1733, 200, 3, 34, "Text",ExpressionUUID->"30928a34-d01c-4a5d-919e-40fd16f02048"],
Cell[79334, 1738, 2669, 63, 156, "Input",ExpressionUUID->"ee8c49fa-cb96-4cdb-933a-b9b4f1d4e54a"],
Cell[82006, 1803, 6552, 166, 437, "Input",ExpressionUUID->"441b383a-7dc1-48df-810f-e11ab1102514"],
Cell[88561, 1971, 1115, 15, 28, "Input",ExpressionUUID->"1dd36ba5-b1d8-4481-9ad8-1e8e0f27bb90"],
Cell[89679, 1988, 178, 3, 34, "Text",ExpressionUUID->"9251dde8-bc9a-462b-a019-5f250299b4cc"],
Cell[89860, 1993, 1831, 43, 48, "Input",ExpressionUUID->"83e7952e-3128-4707-904b-9c095ff4a831"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91728, 2041, 195, 3, 44, "Subsubsection",ExpressionUUID->"1f650fdd-37ad-460d-9b01-b064916c530e"],
Cell[91926, 2046, 6783, 157, 359, "Input",ExpressionUUID->"159a1f10-a3cf-4576-b05f-1dc2fc25149d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98746, 2208, 184, 3, 44, "Subsubsection",ExpressionUUID->"5522287e-0477-4b39-9b46-e869c733d6e6"],
Cell[98933, 2213, 2085, 49, 82, "Input",ExpressionUUID->"8facdea5-d510-4f76-9944-bd401b23037d"],
Cell[101021, 2264, 171, 2, 28, "Input",ExpressionUUID->"e03aa249-b7a8-400d-a15e-709d3d118c1b"],
Cell[101195, 2268, 4280, 106, 196, "Input",ExpressionUUID->"b6d4dd95-2641-4fbf-8ef0-9e0cab63c48e"],
Cell[105478, 2376, 2007, 51, 156, "Input",ExpressionUUID->"2032df68-de17-4f4b-9a63-302b3c01195a"],
Cell[107488, 2429, 755, 23, 40, "Input",ExpressionUUID->"20cc7118-8b28-45b6-bae8-8f092a21bb74"],
Cell[CellGroupData[{
Cell[108268, 2456, 782, 19, 45, "Input",ExpressionUUID->"1728adfb-23b2-476d-8072-ddbeed3cf568"],
Cell[109053, 2477, 1386, 19, 32, "Output",ExpressionUUID->"9d49eeb1-6ae6-4694-aaf6-1cf585c1c04b"]
}, Open  ]],
Cell[110454, 2499, 224, 3, 28, "Input",ExpressionUUID->"530d72ec-e63a-4e2b-b686-e13cb70cc4a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110715, 2507, 173, 3, 44, "Subsubsection",ExpressionUUID->"fee8aaea-da3e-42fc-8ec4-60f9af8295b7"],
Cell[110891, 2512, 2081, 46, 82, "Input",ExpressionUUID->"2270082c-9e9a-4f2a-b1c8-437fb2166f39"],
Cell[CellGroupData[{
Cell[112997, 2562, 291, 7, 28, "Input",ExpressionUUID->"1b195be9-c1b0-49ba-bbf5-58d643c4e0be"],
Cell[113291, 2571, 1439, 22, 32, "Output",ExpressionUUID->"d2da799c-3fad-41f4-9916-450ae992e88b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114767, 2598, 226, 4, 28, "Input",ExpressionUUID->"f819967d-ce5d-4f08-a716-4bb5ccb4581f"],
Cell[114996, 2604, 1277, 18, 32, "Output",ExpressionUUID->"f5a7eaf6-2875-4370-8c9e-f7ef8f83c94c"]
}, Open  ]],
Cell[116288, 2625, 1489, 36, 82, "Input",ExpressionUUID->"e7925f17-487a-4cd2-aea4-10df4a6022b8"],
Cell[CellGroupData[{
Cell[117802, 2665, 430, 11, 45, "Input",ExpressionUUID->"fe4a4cf5-7a89-4954-9ead-995cb1504e41"],
Cell[118235, 2678, 956, 13, 32, "Output",ExpressionUUID->"3a11885b-bb65-4f05-be5b-e87c9526fdd4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119228, 2696, 635, 15, 45, "Input",ExpressionUUID->"a3647eba-0a15-4941-a3c9-a017d952ac87"],
Cell[119866, 2713, 1912, 31, 52, "Output",ExpressionUUID->"ce35ed34-6851-4b24-85c9-31a0b343457e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121827, 2750, 183, 3, 44, "Subsubsection",ExpressionUUID->"b68e9066-8a91-43ae-8374-3da9a8aee4b0"],
Cell[122013, 2755, 2254, 54, 158, "Input",ExpressionUUID->"e773c96a-a948-48c0-8465-3e28c146aef5"],
Cell[124270, 2811, 1407, 40, 217, "Input",ExpressionUUID->"8f040356-08ee-4845-86d2-2e875bf4aadd"],
Cell[CellGroupData[{
Cell[125702, 2855, 219, 4, 28, "Input",ExpressionUUID->"ee5fe271-71af-4bfd-8064-9d1d36502ef9"],
Cell[125924, 2861, 569, 10, 32, "Output",ExpressionUUID->"246c8dfd-a1d8-4673-abde-8cfe47f99b4c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[126542, 2877, 191, 3, 44, "Subsubsection",ExpressionUUID->"63bf508f-fe89-4657-86e7-dfdbd86af311"],
Cell[126736, 2882, 3556, 95, 193, "Input",ExpressionUUID->"2f20a397-bff4-4e5e-a4d3-572ae96a7493"],
Cell[130295, 2979, 2184, 57, 119, "Input",ExpressionUUID->"5882c80e-636c-406c-8c56-ef573a39454c"],
Cell[132482, 3038, 3741, 88, 175, "Input",ExpressionUUID->"7937af4a-5e84-42ac-ae98-606b4c06e163"],
Cell[136226, 3128, 2917, 80, 177, "Input",ExpressionUUID->"ac581bc3-6f49-4958-9635-a112b9855ea7"],
Cell[CellGroupData[{
Cell[139168, 3212, 256, 5, 28, "Input",ExpressionUUID->"88ec1ebf-4eb7-49f8-9708-5254be44f793"],
Cell[139427, 3219, 588, 9, 32, "Output",ExpressionUUID->"ba78bb91-9a02-4a5d-b3b4-5067ae241b01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140052, 3233, 215, 4, 45, "Input",ExpressionUUID->"4f5fc583-9841-43b9-99ad-7d2d19160d7c"],
Cell[140270, 3239, 2441, 53, 241, "Output",ExpressionUUID->"2a026012-4fa5-410c-8e69-33a4a7cce143"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142748, 3297, 215, 4, 45, "Input",ExpressionUUID->"bc215f32-3644-4058-b687-59c36b324ac9"],
Cell[142966, 3303, 2451, 54, 235, "Output",ExpressionUUID->"39073df7-53a1-4abd-9587-587b71e0f3d5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[145466, 3363, 175, 3, 44, "Subsubsection",ExpressionUUID->"63d1430e-28e4-4f9c-b363-1b5d1d1ed260"],
Cell[145644, 3368, 4528, 113, 262, "Input",ExpressionUUID->"94c6538f-a965-4e17-bc81-538db5c7ad75"],
Cell[150175, 3483, 1723, 46, 177, "Input",ExpressionUUID->"6c80ab73-a5b6-4d5a-8fce-64cda3855a8e"],
Cell[CellGroupData[{
Cell[151923, 3533, 234, 4, 28, "Input",ExpressionUUID->"fae0230b-b662-4e5c-aa04-292651083cb7"],
Cell[152160, 3539, 1173, 28, 52, "Output",ExpressionUUID->"d4d6719a-9493-448a-9880-abe35ba40eb0"]
}, Open  ]],
Cell[153348, 3570, 2877, 79, 209, "Input",ExpressionUUID->"997273c5-b199-4b87-834c-c0a987e41608"],
Cell[156228, 3651, 1195, 28, 28, "Input",ExpressionUUID->"36572fa2-23fe-48bb-89e3-c106b2277bb0"],
Cell[157426, 3681, 162, 3, 34, "Text",ExpressionUUID->"7bb96ac7-6347-4791-a4bc-9019220abb49"],
Cell[157591, 3686, 1457, 32, 45, "Input",ExpressionUUID->"26c6a0b1-4118-4680-a9fb-9435e0ff8d68"],
Cell[159051, 3720, 1433, 46, 119, "Input",ExpressionUUID->"47ef7248-39c1-485d-b854-bb71dc089f4b"],
Cell[CellGroupData[{
Cell[160509, 3770, 191, 3, 28, "Input",ExpressionUUID->"3ac357a3-c05b-40d4-a2ad-b370eff461e5"],
Cell[160703, 3775, 1085, 31, 32, "Output",ExpressionUUID->"098a2ccd-eb54-4ff0-a9a7-433427749904"]
}, Open  ]],
Cell[161803, 3809, 161, 3, 34, "Text",ExpressionUUID->"faed4313-cca7-4246-8bb8-40cda7edbce5"],
Cell[CellGroupData[{
Cell[161989, 3816, 594, 14, 45, "Input",ExpressionUUID->"3d0a0f58-24e3-4dcb-9b1e-68e07d914e33"],
Cell[162586, 3832, 250, 4, 32, "Output",ExpressionUUID->"bd1f532b-2ed6-4f4c-aca7-ef6834712dbe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162873, 3841, 3612, 93, 156, "Input",ExpressionUUID->"070d6128-7432-4bf2-ba12-f116dcd2d4de"],
Cell[166488, 3936, 464, 11, 21, "Message",ExpressionUUID->"2b05c717-1e25-44d4-b8e8-b311164ca398"],
Cell[166955, 3949, 160, 3, 32, "Output",ExpressionUUID->"3d08439d-9171-44f8-ae56-e3329a48f314"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167152, 3957, 219, 4, 45, "Input",ExpressionUUID->"ddf02394-1bc8-412c-b88b-02ec2a65a28e"],
Cell[167374, 3963, 1949, 52, 198, "Output",ExpressionUUID->"105b41b7-3def-45a7-9085-234f110aaefb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169360, 4020, 1016, 24, 45, "Input",ExpressionUUID->"72221ebd-f7f1-4612-9337-c84abd9a7101"],
Cell[170379, 4046, 433, 11, 36, "Output",ExpressionUUID->"f9c6fe99-08be-4660-acc6-d8d60932018b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170849, 4062, 1170, 26, 45, "Input",ExpressionUUID->"3e101dd3-97a5-43b7-81fb-24c9ed8831fb"],
Cell[172022, 4090, 503, 12, 36, "Output",ExpressionUUID->"aed14998-1466-48fe-8c7f-9bbcd3d4507a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172562, 4107, 1047, 25, 45, "Input",ExpressionUUID->"fc2ef3c8-9890-443a-9e0f-4024aed9f296"],
Cell[173612, 4134, 415, 10, 21, "Message",ExpressionUUID->"2d0d560f-b460-413b-af3d-7847bb278cfd"],
Cell[174030, 4146, 430, 11, 36, "Output",ExpressionUUID->"9abb9e84-3025-4a84-8e52-527f7612b6ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174497, 4162, 1024, 24, 45, "Input",ExpressionUUID->"82bc2cb7-509a-49f2-bf70-6fe795b045d1"],
Cell[175524, 4188, 432, 11, 36, "Output",ExpressionUUID->"ef4aea1e-1556-4c12-b9d4-6b19e4a36ede"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175993, 4204, 1022, 24, 45, "Input",ExpressionUUID->"75db64d3-7feb-4332-9ba9-21d7b851eba4"],
Cell[177018, 4230, 433, 11, 36, "Output",ExpressionUUID->"869c2950-c912-4ec8-9548-2afcfde54d6b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177488, 4246, 1021, 24, 45, "Input",ExpressionUUID->"f6c63786-ce5d-4b06-b336-955a40745423"],
Cell[178512, 4272, 431, 11, 36, "Output",ExpressionUUID->"fce6c4e8-5f99-41cf-8655-347e737d822d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178980, 4288, 223, 4, 45, "Input",ExpressionUUID->"c46a1eff-cbde-4e09-88a4-51ab56bbbc6d"],
Cell[179206, 4294, 2639, 79, 198, "Output",ExpressionUUID->"0fcdecba-a988-435b-9bc0-f7319305e257"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

